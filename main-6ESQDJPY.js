import{$ as Fl,$a as L,A as Fe,Aa as kp,Ab as Rt,B as Ep,Ba as xp,Bb as bn,C as kl,Ca as Hl,Cb as be,D as wp,Da as yi,Db as Xt,E as Cp,Ea as Lp,Eb as Xp,F as Gt,Fa as J,Fb as Qp,G as tr,Ga as Ei,Gb as go,H as yn,Ha as Fp,Hb as Zp,I as Ip,Ia as zl,Ib as _o,J as xl,Ja as W,Jb as or,K as nr,Ka as Up,L as bp,La as Vp,Lb as qe,M as rr,Ma as Gl,Mb as vo,N as qt,Na as Ie,Nb as em,O as Ll,Oa as In,Ob as Zl,P as Sp,Pa as Ve,Pb as yo,Q as Tp,Qa as Jt,R as Rp,Ra as je,S as Ue,Sa as ql,T as Ap,Ta as po,U as ae,Ua as mo,V as O,Va as wi,W as mi,Wa as jp,X as b,Xa as Bp,Y as En,Ya as ee,Z as Pp,Za as Kl,_ as M,_a as R,a as v,aa as N,ab as fe,b as B,ba as E,c as fp,ca as ir,d as jE,da as Dp,db as Ci,e as vn,ea as Kt,eb as we,f as h,fa as Ee,fb as Be,g as pp,ga as Ul,gb as Wp,h as mp,ha as wn,hb as $p,i as zt,ia as gi,ib as Hp,j as Pl,ja as _i,k as Dl,ka as sr,kb as X,l as st,la as Yt,lb as Yl,m as pe,ma as Vl,mb as Jl,n as gp,na as ho,nb as Ii,o as _p,oa as fo,ob as zp,p as Tt,pa as ie,q as uo,qa as Oe,r as Ol,ra as jl,s as Nl,sa as Op,t as me,ta as Bl,tb as Gp,u as C,ua as Cn,ub as qp,v as pi,va as Np,vb as Xl,w as vp,wa as Wl,wb as Ql,x as yp,xa as Mp,xb as Kp,y as x,ya as vi,yb as Yp,z as Ml,za as $l,zb as Jp}from"./chunk-24TJHYS6.js";var Co=new M(""),ru=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i,s){return this._findPluginFor(r).addEventListener(t,r,i,s)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new O(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(N(Co),N(Oe))};static \u0275prov=b({token:n,factory:n.\u0275fac})}return n})(),bi=class{_doc;constructor(e){this._doc=e}manager},Eo="ng-app-id";function tm(n){for(let e of n)e.remove()}function nm(n,e){let t=e.createElement("style");return t.textContent=n,t}function BE(n,e,t,r){let i=n.head?.querySelectorAll(`style[${Eo}="${e}"],link[${Eo}="${e}"]`);if(i)for(let s of i)s.removeAttribute(Eo),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&t.set(s.textContent,{usage:0,elements:[s]})}function tu(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var iu=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.isServer=Zl(s),BE(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,nm);r?.forEach(i=>this.addUsage(i,this.external,tu))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let s=r.get(t);s?s.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(tm(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])tm(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,nm(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,tu(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(Eo,this.appId),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(N(be),N(Wl),N($l,8),N(vi))};static \u0275prov=b({token:n,factory:n.\u0275fac})}return n})(),eu={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},su=/%COMP%/g;var im="%COMP%",WE=`_nghost-${im}`,$E=`_ngcontent-${im}`,HE=!0,zE=new M("",{providedIn:"root",factory:()=>HE});function GE(n){return $E.replace(su,n)}function qE(n){return WE.replace(su,n)}function sm(n,e){return e.map(t=>t.replace(su,n))}var ou=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,s,o,a,c,l=null,u=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=c,this.nonce=l,this.tracingService=u,this.platformIsServer=Zl(a),this.defaultRenderer=new Si(t,o,c,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===yi.ShadowDom&&(r=B(v({},r),{encapsulation:yi.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof wo?i.applyToHost(t):i instanceof Ti&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer,f=this.tracingService;switch(r.encapsulation){case yi.Emulated:s=new wo(c,l,r,this.appId,u,o,a,d,f);break;case yi.ShadowDom:return new nu(c,l,t,r,o,a,this.nonce,d,f);default:s=new Ti(c,l,r,u,o,a,d,f);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(N(ru),N(iu),N(Wl),N(zE),N(be),N(vi),N(Oe),N($l),N(xp,8))};static \u0275prov=b({token:n,factory:n.\u0275fac})}return n})(),Si=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,s){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=s}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(eu[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(rm(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(rm(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new O(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=eu[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=eu[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Ei.DashCase|Ei.Important)?e.style.setProperty(t,r,i&Ei.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Ei.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=Xt().getGlobalEventTarget(this.doc,e),!e))throw new O(5102,!1);let s=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,t,s)),this.eventManager.addEventListener(e,t,s,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function rm(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var nu=class extends Si{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,s,o,a,c,l){super(e,s,o,c,l),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=i.styles;u=sm(i.id,u);for(let f of u){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=f,this.shadowRoot.appendChild(p)}let d=i.getExternalStyles?.();if(d)for(let f of d){let p=tu(f,s);a&&p.setAttribute("nonce",a),this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ti=class extends Si{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,s,o,a,c,l){super(e,s,o,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let u=r.styles;this.styles=l?sm(l,u):u,this.styleUrls=r.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},wo=class extends Ti{contentAttr;hostAttr;constructor(e,t,r,i,s,o,a,c,l){let u=i+"-"+r.id;super(e,t,r,s,o,a,c,l,u),this.contentAttr=GE(u),this.hostAttr=qE(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var Io=class n extends Qp{supportsDOMEvents=!0;static makeCurrent(){Xp(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=YE();return t==null?null:JE(t)}resetBaseElement(){Ri=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return vo(document.cookie,e)}},Ri=null;function YE(){return Ri=Ri||document.querySelector("base"),Ri?Ri.getAttribute("href"):null}function JE(n){return new URL(n,document.baseURI).pathname}var XE=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=b({token:n,factory:n.\u0275fac})}return n})(),am=(()=>{class n extends bi{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,s){return t.addEventListener(r,i,s),()=>this.removeEventListener(t,r,i,s)}removeEventListener(t,r,i,s){return t.removeEventListener(r,i,s)}static \u0275fac=function(r){return new(r||n)(N(be))};static \u0275prov=b({token:n,factory:n.\u0275fac})}return n})(),om=["alt","control","meta","shift"],QE={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ZE={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},cm=(()=>{class n extends bi{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,s){let o=n.parseEventName(r),a=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Xt().onAndCancel(t,o.domEventName,a,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),om.forEach(l=>{let u=r.indexOf(l);u>-1&&(r.splice(u,1),o+=l+".")}),o+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=i,c.fullKey=o,c}static matchEventFullKeyCode(t,r){let i=QE[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),om.forEach(o=>{if(o!==i){let a=ZE[o];a(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(N(be))};static \u0275prov=b({token:n,factory:n.\u0275fac})}return n})();function au(n,e){return Kp(v({rootComponent:n},ew(e)))}function ew(n){return{appProviders:[...sw,...n?.providers??[]],platformProviders:iw}}function tw(){Io.makeCurrent()}function nw(){return new jl}function rw(){return Np(document),document}var iw=[{provide:vi,useValue:em},{provide:Mp,useValue:tw,multi:!0},{provide:be,useFactory:rw}];var sw=[{provide:Dp,useValue:"root"},{provide:jl,useFactory:nw},{provide:Co,useClass:am,multi:!0,deps:[be]},{provide:Co,useClass:cm,multi:!0,deps:[be]},ou,iu,ru,{provide:Fp,useExisting:ou},{provide:yo,useClass:XE},[]];var cr=class{},lr=class{},Ke=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=t.slice(r+1).trim();this.addHeaderEntry(i,s)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.addHeaderEntry(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}addHeaderEntry(e,t){let r=e.toLowerCase();this.maybeSetNormalizedName(e,r),this.headers.has(r)?this.headers.get(r).push(t):this.headers.set(r,[t])}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var To=class{encodeKey(e){return lm(e)}encodeValue(e){return lm(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function ow(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,a]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=t.get(o)||[];c.push(a),t.set(o,c)}),t}var aw=/%(\d[a-f0-9])/gi,cw={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function lm(n){return encodeURIComponent(n).replace(aw,(e,t)=>cw[t]??e)}function bo(n){return`${n}`}var Pt=class n{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new To,e.fromString){if(e.fromObject)throw new O(2805,!1);this.map=ow(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],i=Array.isArray(r)?r.map(bo):[bo(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(bo(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(bo(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var Ro=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function lw(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function um(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function dm(n){return typeof Blob<"u"&&n instanceof Blob}function hm(n){return typeof FormData<"u"&&n instanceof FormData}function uw(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var Ai="Content-Type",Ao="Accept",hu="X-Request-URL",pm="text/plain",mm="application/json",gm=`${mm}, ${pm}, */*`,ar=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(e,t,r,i){this.url=t,this.method=e.toUpperCase();let s;if(lw(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new Ke,this.context??=new Ro,!this.params)this.params=new Pt,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let a=t.indexOf("?"),c=a===-1?"?":a<t.length-1?"&":"";this.urlWithParams=t+c+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||um(this.body)||dm(this.body)||hm(this.body)||uw(this.body)?this.body:this.body instanceof Pt?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||hm(this.body)?null:dm(this.body)?this.body.type||null:um(this.body)?null:typeof this.body=="string"?pm:this.body instanceof Pt?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?mm:null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=e.body!==void 0?e.body:this.body,a=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress,l=e.headers||this.headers,u=e.params||this.params,d=e.context??this.context;return e.setHeaders!==void 0&&(l=Object.keys(e.setHeaders).reduce((f,p)=>f.set(p,e.setHeaders[p]),l)),e.setParams&&(u=Object.keys(e.setParams).reduce((f,p)=>f.set(p,e.setParams[p]),u)),new n(t,r,o,{params:u,headers:l,context:d,reportProgress:c,responseType:i,withCredentials:a,transferCache:s})}},Dt=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Dt||{}),ur=class{headers;status;statusText;url;ok;type;constructor(e,t=200,r="OK"){this.headers=e.headers||new Ke,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},Pi=class n extends ur{constructor(e={}){super(e)}type=Dt.ResponseHeader;clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Qt=class n extends ur{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=Dt.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},At=class extends ur{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},_m=200,dw=204;function cu(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var vm=(()=>{class n{handler;constructor(t){this.handler=t}request(t,r,i={}){let s;if(t instanceof ar)s=t;else{let c;i.headers instanceof Ke?c=i.headers:c=new Ke(i.headers);let l;i.params&&(i.params instanceof Pt?l=i.params:l=new Pt({fromObject:i.params})),s=new ar(t,r,i.body!==void 0?i.body:null,{headers:c,context:i.context,params:l,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}let o=C(s).pipe(yn(c=>this.handler.handle(c)));if(t instanceof ar||i.observe==="events")return o;let a=o.pipe(Gt(c=>c instanceof Qt));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(x(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new O(2806,!1);return c.body}));case"blob":return a.pipe(x(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new O(2807,!1);return c.body}));case"text":return a.pipe(x(c=>{if(c.body!==null&&typeof c.body!="string")throw new O(2808,!1);return c.body}));case"json":default:return a.pipe(x(c=>c.body))}case"response":return a;default:throw new O(2809,!1)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:new Pt().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,cu(i,r))}post(t,r,i={}){return this.request("POST",t,cu(i,r))}put(t,r,i={}){return this.request("PUT",t,cu(i,r))}static \u0275fac=function(r){return new(r||n)(N(cr))};static \u0275prov=b({token:n,factory:n.\u0275fac})}return n})(),hw=/^\)\]\}',?\n/;function fm(n){if(n.url)return n.url;let e=hu.toLocaleLowerCase();return n.headers.get(e)}var ym=new M(""),So=(()=>{class n{fetchImpl=E(lu,{optional:!0})?.fetch??((...t)=>globalThis.fetch(...t));ngZone=E(Oe);handle(t){return new zt(r=>{let i=new AbortController;return this.doRequest(t,i.signal,r).then(uu,s=>r.error(new At({error:s}))),()=>i.abort()})}doRequest(t,r,i){return h(this,null,function*(){let s=this.createRequestInit(t),o;try{let p=this.ngZone.runOutsideAngular(()=>this.fetchImpl(t.urlWithParams,v({signal:r},s)));fw(p),i.next({type:Dt.Sent}),o=yield p}catch(p){i.error(new At({error:p,status:p.status??0,statusText:p.statusText,url:t.urlWithParams,headers:p.headers}));return}let a=new Ke(o.headers),c=o.statusText,l=fm(o)??t.urlWithParams,u=o.status,d=null;if(t.reportProgress&&i.next(new Pi({headers:a,status:u,statusText:c,url:l})),o.body){let p=o.headers.get("content-length"),_=[],y=o.body.getReader(),w=0,G,oe,k=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>h(this,null,function*(){for(;;){let{done:it,value:St}=yield y.read();if(it)break;if(_.push(St),w+=St.length,t.reportProgress){oe=t.responseType==="text"?(oe??"")+(G??=new TextDecoder).decode(St,{stream:!0}):void 0;let fi=()=>i.next({type:Dt.DownloadProgress,total:p?+p:void 0,loaded:w,partialText:oe});k?k.run(fi):fi()}}}));let Le=this.concatChunks(_,w);try{let it=o.headers.get(Ai)??"";d=this.parseBody(t,Le,it)}catch(it){i.error(new At({error:it,headers:new Ke(o.headers),status:o.status,statusText:o.statusText,url:fm(o)??t.urlWithParams}));return}}u===0&&(u=d?_m:0),u>=200&&u<300?(i.next(new Qt({body:d,headers:a,status:u,statusText:c,url:l})),i.complete()):i.error(new At({error:d,headers:a,status:u,statusText:c,url:l}))})}parseBody(t,r,i){switch(t.responseType){case"json":let s=new TextDecoder().decode(r).replace(hw,"");return s===""?null:JSON.parse(s);case"text":return new TextDecoder().decode(r);case"blob":return new Blob([r],{type:i});case"arraybuffer":return r.buffer}}createRequestInit(t){let r={},i=t.withCredentials?"include":void 0;if(t.headers.forEach((s,o)=>r[s]=o.join(",")),t.headers.has(Ao)||(r[Ao]=gm),!t.headers.has(Ai)){let s=t.detectContentTypeHeader();s!==null&&(r[Ai]=s)}return{body:t.serializeBody(),method:t.method,headers:r,credentials:i}}concatChunks(t,r){let i=new Uint8Array(r),s=0;for(let o of t)i.set(o,s),s+=o.length;return i}static \u0275fac=function(r){return new(r||n)};static \u0275prov=b({token:n,factory:n.\u0275fac})}return n})(),lu=class{};function uu(){}function fw(n){n.then(uu,uu)}function pw(n,e){return e(n)}function mw(n,e,t){return(r,i)=>Ee(t,()=>e(r,s=>n(s,i)))}var Em=new M(""),fu=new M(""),wm=new M("",{providedIn:"root",factory:()=>!0});var Po=(()=>{class n extends cr{backend;injector;chain=null;pendingTasks=E(ho);contributeToStability=E(wm);constructor(t,r){super(),this.backend=t,this.injector=r}handle(t){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(Em),...this.injector.get(fu,[])]));this.chain=r.reduceRight((i,s)=>mw(i,s,this.injector),pw)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(rr(()=>this.pendingTasks.remove(r)))}else return this.chain(t,r=>this.backend.handle(r))}static \u0275fac=function(r){return new(r||n)(N(lr),N(Kt))};static \u0275prov=b({token:n,factory:n.\u0275fac})}return n})();var gw=/^\)\]\}',?\n/,_w=RegExp(`^${hu}:`,"m");function vw(n){return"responseURL"in n&&n.responseURL?n.responseURL:_w.test(n.getAllResponseHeaders())?n.getResponseHeader(hu):null}var du=(()=>{class n{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new O(-2800,!1);let r=this.xhrFactory;return(r.\u0275loadImpl?me(r.\u0275loadImpl()):C(null)).pipe(Ue(()=>new zt(s=>{let o=r.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((y,w)=>o.setRequestHeader(y,w.join(","))),t.headers.has(Ao)||o.setRequestHeader(Ao,gm),!t.headers.has(Ai)){let y=t.detectContentTypeHeader();y!==null&&o.setRequestHeader(Ai,y)}if(t.responseType){let y=t.responseType.toLowerCase();o.responseType=y!=="json"?y:"text"}let a=t.serializeBody(),c=null,l=()=>{if(c!==null)return c;let y=o.statusText||"OK",w=new Ke(o.getAllResponseHeaders()),G=vw(o)||t.url;return c=new Pi({headers:w,status:o.status,statusText:y,url:G}),c},u=()=>{let{headers:y,status:w,statusText:G,url:oe}=l(),k=null;w!==dw&&(k=typeof o.response>"u"?o.responseText:o.response),w===0&&(w=k?_m:0);let Le=w>=200&&w<300;if(t.responseType==="json"&&typeof k=="string"){let it=k;k=k.replace(gw,"");try{k=k!==""?JSON.parse(k):null}catch(St){k=it,Le&&(Le=!1,k={error:St,text:k})}}Le?(s.next(new Qt({body:k,headers:y,status:w,statusText:G,url:oe||void 0})),s.complete()):s.error(new At({error:k,headers:y,status:w,statusText:G,url:oe||void 0}))},d=y=>{let{url:w}=l(),G=new At({error:y,status:o.status||0,statusText:o.statusText||"Unknown Error",url:w||void 0});s.error(G)},f=!1,p=y=>{f||(s.next(l()),f=!0);let w={type:Dt.DownloadProgress,loaded:y.loaded};y.lengthComputable&&(w.total=y.total),t.responseType==="text"&&o.responseText&&(w.partialText=o.responseText),s.next(w)},_=y=>{let w={type:Dt.UploadProgress,loaded:y.loaded};y.lengthComputable&&(w.total=y.total),s.next(w)};return o.addEventListener("load",u),o.addEventListener("error",d),o.addEventListener("timeout",d),o.addEventListener("abort",d),t.reportProgress&&(o.addEventListener("progress",p),a!==null&&o.upload&&o.upload.addEventListener("progress",_)),o.send(a),s.next({type:Dt.Sent}),()=>{o.removeEventListener("error",d),o.removeEventListener("abort",d),o.removeEventListener("load",u),o.removeEventListener("timeout",d),t.reportProgress&&(o.removeEventListener("progress",p),a!==null&&o.upload&&o.upload.removeEventListener("progress",_)),o.readyState!==o.DONE&&o.abort()}})))}static \u0275fac=function(r){return new(r||n)(N(yo))};static \u0275prov=b({token:n,factory:n.\u0275fac})}return n})(),Cm=new M(""),yw="XSRF-TOKEN",Ew=new M("",{providedIn:"root",factory:()=>yw}),ww="X-XSRF-TOKEN",Cw=new M("",{providedIn:"root",factory:()=>ww}),Di=class{},Iw=(()=>{class n{doc;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,r){this.doc=t,this.cookieName=r}getToken(){let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=vo(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(r){return new(r||n)(N(be),N(Ew))};static \u0275prov=b({token:n,factory:n.\u0275fac})}return n})();function bw(n,e){let t=n.url.toLowerCase();if(!E(Cm)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let r=E(Di).getToken(),i=E(Cw);return r!=null&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,r)})),e(n)}var pu=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(pu||{});function Sw(n,e){return{\u0275kind:n,\u0275providers:e}}function mu(...n){let e=[vm,du,Po,{provide:cr,useExisting:Po},{provide:lr,useFactory:()=>E(ym,{optional:!0})??E(du)},{provide:Em,useValue:bw,multi:!0},{provide:Cm,useValue:!0},{provide:Di,useClass:Iw}];for(let t of n)e.push(...t.\u0275providers);return ir(e)}function gu(){return Sw(pu.Fetch,[So,{provide:ym,useExisting:So},{provide:lr,useExisting:So}])}var Rw=new M(""),Aw="b",Pw="h",Dw="s",Ow="st",Nw="u",Mw="rt",_u=new M(""),kw=["GET","HEAD"];function xw(n,e){let f=E(_u),{isCacheActive:t}=f,r=fp(f,["isCacheActive"]),{transferCache:i,method:s}=n;if(!t||i===!1||s==="POST"&&!r.includePostRequests&&!i||s!=="POST"&&!kw.includes(s)||!r.includeRequestsWithAuthHeaders&&Lw(n)||r.filter?.(n)===!1)return e(n);let o=E(kp);if(E(Rw,{optional:!0}))throw new O(2803,!1);let c=n.url,l=Fw(n,c),u=o.get(l,null),d=r.includeHeaders;if(typeof i=="object"&&i.includeHeaders&&(d=i.includeHeaders),u){let{[Aw]:p,[Mw]:_,[Pw]:y,[Dw]:w,[Ow]:G,[Nw]:oe}=u,k=p;switch(_){case"arraybuffer":k=new TextEncoder().encode(p).buffer;break;case"blob":k=new Blob([p]);break}let Le=new Ke(y);return C(new Qt({body:k,headers:Le,status:w,statusText:G,url:oe}))}return e(n).pipe(ae(p=>{p instanceof Qt}))}function Lw(n){return n.headers.has("authorization")||n.headers.has("proxy-authorization")}function Im(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function Fw(n,e){let{params:t,method:r,responseType:i}=n,s=Im(t),o=n.serializeBody();o instanceof URLSearchParams?o=Im(o):typeof o!="string"&&(o="");let a=[r,i,e,o,s].join("|"),c=Uw(a);return c}function Uw(n){let e=0;for(let t of n)e=Math.imul(31,e)+t.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function bm(n){return[{provide:_u,useFactory:()=>(Hl("NgHttpTransferCache"),v({isCacheActive:!0},n))},{provide:fu,useValue:xw,multi:!0},{provide:mo,multi:!0,useFactory:()=>{let e=E(wi),t=E(_u);return()=>{e.whenStable().then(()=>{t.isCacheActive=!1})}}}]}var Tm=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(N(be))};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Do=function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n[n.I18nSupport=2]="I18nSupport",n[n.EventReplay=3]="EventReplay",n[n.IncrementalHydration=4]="IncrementalHydration",n}(Do||{});function jw(n,e=[],t={}){return{\u0275kind:n,\u0275providers:e}}function Rm(){return jw(Do.EventReplay,Yp())}function Am(...n){let e=[],t=new Set;for(let{\u0275providers:i,\u0275kind:s}of n)t.add(s),i.length&&e.push(i);let r=t.has(Do.HttpTransferCacheOptions);return ir([[],Jp(),t.has(Do.NoHttpTransferCache)||r?[]:bm({}),e])}var S="primary",Hi=Symbol("RouteTitle"),Cu=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Rn(n){return new Cu(n)}function Lm(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o[0]===":")i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Ww(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!ot(n[t],e[t]))return!1;return!0}function ot(n,e){let t=n?Iu(n):void 0,r=e?Iu(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!Fm(n[i],e[i]))return!1;return!0}function Iu(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Fm(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function Um(n){return n.length>0?n[n.length-1]:null}function tn(n){return vp(n)?n:po(n)?me(Promise.resolve(n)):C(n)}var $w={exact:jm,subset:Bm},Vm={exact:Hw,subset:zw,ignored:()=>!0};function Pm(n,e,t){return $w[t.paths](n.root,e.root,t.matrixParams)&&Vm[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function Hw(n,e){return ot(n,e)}function jm(n,e,t){if(!Sn(n.segments,e.segments)||!Mo(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!jm(n.children[r],e.children[r],t))return!1;return!0}function zw(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Fm(n[t],e[t]))}function Bm(n,e,t){return Wm(n,e,e.segments,t)}function Wm(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Sn(i,t)||e.hasChildren()||!Mo(i,t,r))}else if(n.segments.length===t.length){if(!Sn(n.segments,t)||!Mo(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!Bm(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Sn(n.segments,i)||!Mo(n.segments,i,r)||!n.children[S]?!1:Wm(n.children[S],e,s,r)}}function Mo(n,e,t){return e.every((r,i)=>Vm[t](n[i].parameters,r.parameters))}var ct=class{root;queryParams;fragment;_queryParamMap;constructor(e=new U([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Rn(this.queryParams),this._queryParamMap}toString(){return Kw.serialize(this)}},U=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ko(this)}},Zt=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Rn(this.parameters),this._parameterMap}toString(){return Hm(this)}};function Gw(n,e){return Sn(n,e)&&n.every((t,r)=>ot(t.parameters,e[r].parameters))}function Sn(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function qw(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===S&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==S&&(t=t.concat(e(i,r)))}),t}var zi=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=b({token:n,factory:()=>new An,providedIn:"root"})}return n})(),An=class{parse(e){let t=new Su(e);return new ct(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Oi(e.root,!0)}`,r=Xw(e.queryParams),i=typeof e.fragment=="string"?`#${Yw(e.fragment)}`:"";return`${t}${r}${i}`}},Kw=new An;function ko(n){return n.segments.map(e=>Hm(e)).join("/")}function Oi(n,e){if(!n.hasChildren())return ko(n);if(e){let t=n.children[S]?Oi(n.children[S],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==S&&r.push(`${i}:${Oi(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=qw(n,(r,i)=>i===S?[Oi(n.children[S],!1)]:[`${i}:${Oi(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[S]!=null?`${ko(n)}/${t[0]}`:`${ko(n)}/(${t.join("//")})`}}function $m(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Oo(n){return $m(n).replace(/%3B/gi,";")}function Yw(n){return encodeURI(n)}function bu(n){return $m(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function xo(n){return decodeURIComponent(n)}function Dm(n){return xo(n.replace(/\+/g,"%20"))}function Hm(n){return`${bu(n.path)}${Jw(n.parameters)}`}function Jw(n){return Object.entries(n).map(([e,t])=>`;${bu(e)}=${bu(t)}`).join("")}function Xw(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Oo(t)}=${Oo(i)}`).join("&"):`${Oo(t)}=${Oo(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var Qw=/^[^\/()?;#]+/;function vu(n){let e=n.match(Qw);return e?e[0]:""}var Zw=/^[^\/()?;=#]+/;function eC(n){let e=n.match(Zw);return e?e[0]:""}var tC=/^[^=?&#]+/;function nC(n){let e=n.match(tC);return e?e[0]:""}var rC=/^[^&#]+/;function iC(n){let e=n.match(rC);return e?e[0]:""}var Su=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new U([],{}):new U([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[S]=new U(e,t)),r}parseSegment(){let e=vu(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new O(4009,!1);return this.capture(e),new Zt(xo(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=eC(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=vu(this.remaining);i&&(r=i,this.capture(r))}e[xo(t)]=xo(r)}parseQueryParam(e){let t=nC(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=iC(this.remaining);o&&(r=o,this.capture(r))}let i=Dm(t),s=Dm(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=vu(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new O(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=S);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[S]:new U([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new O(4011,!1)}};function zm(n){return n.segments.length>0?new U([],{[S]:n}):n}function Gm(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=Gm(i);if(r===S&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new U(n.segments,e);return sC(t)}function sC(n){if(n.numberOfChildren===1&&n.children[S]){let e=n.children[S];return new U(n.segments.concat(e.segments),e.children)}return n}function mr(n){return n instanceof ct}function qm(n,e,t=null,r=null){let i=Km(n);return Ym(i,e,t,r)}function Km(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new U(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=zm(r);return e??i}function Ym(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return yu(i,i,i,t,r);let s=oC(e);if(s.toRoot())return yu(i,i,new U([],{}),t,r);let o=aC(s,i,n),a=o.processChildren?Mi(o.segmentGroup,o.index,s.commands):Xm(o.segmentGroup,o.index,s.commands);return yu(i,o.segmentGroup,a,t,r)}function Fo(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function xi(n){return typeof n=="object"&&n!=null&&n.outlets}function yu(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`});let o;n===e?o=t:o=Jm(n,e,t);let a=zm(Gm(o));return new ct(a,s,i)}function Jm(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=Jm(s,e,t)}),new U(n.segments,r)}var Uo=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Fo(r[0]))throw new O(4003,!1);let i=r.find(xi);if(i&&i!==Um(r))throw new O(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function oC(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Uo(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Uo(t,e,r)}var fr=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function aC(n,e,t){if(n.isAbsolute)return new fr(e,!0,0);if(!t)return new fr(e,!1,NaN);if(t.parent===null)return new fr(t,!0,0);let r=Fo(n.commands[0])?0:1,i=t.segments.length-1+r;return cC(t,i,n.numberOfDoubleDots)}function cC(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new O(4005,!1);i=r.segments.length}return new fr(r,!1,i-s)}function lC(n){return xi(n[0])?n[0].outlets:{[S]:n}}function Xm(n,e,t){if(n??=new U([],{}),n.segments.length===0&&n.hasChildren())return Mi(n,e,t);let r=uC(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new U(n.segments.slice(0,r.pathIndex),{});return s.children[S]=new U(n.segments.slice(r.pathIndex),n.children),Mi(s,0,i)}else return r.match&&i.length===0?new U(n.segments,{}):r.match&&!n.hasChildren()?Tu(n,e,t):r.match?Mi(n,0,i):Tu(n,e,t)}function Mi(n,e,t){if(t.length===0)return new U(n.segments,{});{let r=lC(t),i={};if(Object.keys(r).some(s=>s!==S)&&n.children[S]&&n.numberOfChildren===1&&n.children[S].segments.length===0){let s=Mi(n.children[S],e,t);return new U(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=Xm(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new U(n.segments,i)}}function uC(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(xi(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!Nm(c,l,o))return s;r+=2}else{if(!Nm(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Tu(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(xi(s)){let c=dC(s.outlets);return new U(r,c)}if(i===0&&Fo(t[0])){let c=n.segments[e];r.push(new Zt(c.path,Om(t[0]))),i++;continue}let o=xi(s)?s.outlets[S]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Fo(a)?(r.push(new Zt(o,Om(a))),i+=2):(r.push(new Zt(o,{})),i++)}return new U(r,{})}function dC(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=Tu(new U([],{}),0,r))}),e}function Om(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function Nm(n,e,t){return n==t.path&&ot(e,t.parameters)}var Lo="imperative",ce=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(ce||{}),Me=class{id;url;constructor(e,t){this.id=e,this.url=t}},Pn=class extends Me{type=ce.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ot=class extends Me{urlAfterRedirects;type=ce.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Se=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Se||{}),Li=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Li||{}),at=class extends Me{reason;code;type=ce.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Nt=class extends Me{reason;code;type=ce.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},gr=class extends Me{error;target;type=ce.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Fi=class extends Me{urlAfterRedirects;state;type=ce.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Vo=class extends Me{urlAfterRedirects;state;type=ce.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},jo=class extends Me{urlAfterRedirects;state;shouldActivate;type=ce.GuardsCheckEnd;constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Bo=class extends Me{urlAfterRedirects;state;type=ce.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Wo=class extends Me{urlAfterRedirects;state;type=ce.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},$o=class{route;type=ce.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ho=class{route;type=ce.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},zo=class{snapshot;type=ce.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Go=class{snapshot;type=ce.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},qo=class{snapshot;type=ce.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ko=class{snapshot;type=ce.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Ui=class{},_r=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function hC(n,e){return n.providers&&!n._injector&&(n._injector=Gl(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Ye(n){return n.outlet||S}function fC(n,e){let t=n.filter(r=>Ye(r)===e);return t.push(...n.filter(r=>Ye(r)!==e)),t}function Gi(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Yo=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Gi(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Er(this.rootInjector)}},Er=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Yo(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(N(Kt))};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Jo=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Ru(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Ru(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Au(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Au(e,this._root).map(t=>t.value)}};function Ru(n,e){if(n===e.value)return e;for(let t of e.children){let r=Ru(n,t);if(r)return r}return null}function Au(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Au(n,t);if(r.length)return r.unshift(e),r}return[]}var Ne=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function hr(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Vi=class extends Jo{snapshot;constructor(e,t){super(e),this.snapshot=t,Lu(this,e)}toString(){return this.snapshot.toString()}};function Qm(n){let e=pC(n),t=new pe([new Zt("",{})]),r=new pe({}),i=new pe({}),s=new pe({}),o=new pe(""),a=new en(t,r,s,o,i,S,n,e.root);return a.snapshot=e.root,new Vi(new Ne(a,[]),e)}function pC(n){let e={},t={},r={},i="",s=new Tn([],e,r,i,t,S,n,null,{});return new ji("",new Ne(s,[]))}var en=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(x(l=>l[Hi]))??C(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(x(e=>Rn(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(x(e=>Rn(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Xo(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:v(v({},e.params),n.params),data:v(v({},e.data),n.data),resolve:v(v(v(v({},n.data),e.data),i?.data),n._resolvedData)}:r={params:v({},n.params),data:v({},n.data),resolve:v(v({},n.data),n._resolvedData??{})},i&&eg(i)&&(r.resolve[Hi]=i.title),r}var Tn=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Hi]}constructor(e,t,r,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Rn(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Rn(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},ji=class extends Jo{url;constructor(e,t){super(t),this.url=e,Lu(this,t)}toString(){return Zm(this._root)}};function Lu(n,e){e.value._routerState=n,e.children.forEach(t=>Lu(n,t))}function Zm(n){let e=n.children.length>0?` { ${n.children.map(Zm).join(", ")} } `:"";return`${n.value}${e}`}function Eu(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,ot(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),ot(e.params,t.params)||n.paramsSubject.next(t.params),Ww(e.url,t.url)||n.urlSubject.next(t.url),ot(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Pu(n,e){let t=ot(n.params,e.params)&&Gw(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Pu(n.parent,e.parent))}function eg(n){return typeof n.title=="string"||n.title===null}var tg=new M(""),qi=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=S;activateEvents=new ie;deactivateEvents=new ie;attachEvents=new ie;detachEvents=new ie;routerOutletData=Op(void 0);parentContexts=E(Er);location=E(Up);changeDetector=E(Ql);inputBinder=E(ta,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new O(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new O(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new O(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new O(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new Du(t,a,i.injector,this.routerOutletData);this.activated=i.createComponent(o,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=Ve({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[wn]})}return n})(),Du=class{route;childContexts;parent;outletData;constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===en?this.route:e===Er?this.childContexts:e===tg?this.outletData:this.parent.get(e,t)}},ta=new M("");function mC(n,e,t){let r=Bi(n,e._root,t?t._root:void 0);return new Vi(r,e)}function Bi(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=gC(n,e,t);return new Ne(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Bi(n,a)),o}}let r=_C(e.value),i=e.children.map(s=>Bi(n,s));return new Ne(r,i)}}function gC(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Bi(n,r,i);return Bi(n,r)})}function _C(n){return new en(new pe(n.url),new pe(n.params),new pe(n.queryParams),new pe(n.fragment),new pe(n.data),n.outlet,n.component,n)}var vr=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},ng="ngNavigationCancelingError";function Qo(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=mr(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=rg(!1,Se.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function rg(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[ng]=!0,t.cancellationCode=e,t}function vC(n){return ig(n)&&mr(n.url)}function ig(n){return!!n&&n[ng]}var yC=(n,e,t,r)=>x(i=>(new Ou(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Ou=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Eu(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=hr(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=hr(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=hr(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=hr(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Ko(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Go(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(Eu(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Eu(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},Zo=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},pr=class{component;route;constructor(e,t){this.component=e,this.route=t}};function EC(n,e,t){let r=n._root,i=e?e._root:null;return Ni(r,i,t,[r.value])}function wC(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function wr(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!Pp(n)?n:e.get(n):r}function Ni(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=hr(e);return n.children.forEach(o=>{CC(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>ki(a,t.getContext(o),i)),i}function CC(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=IC(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Zo(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Ni(n,e,a?a.children:null,r,i):Ni(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new pr(a.outlet.component,o))}else o&&ki(e,a,i),i.canActivateChecks.push(new Zo(r)),s.component?Ni(n,null,a?a.children:null,r,i):Ni(n,null,t,r,i);return i}function IC(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Sn(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Sn(n.url,e.url)||!ot(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Pu(n,e)||!ot(n.queryParams,e.queryParams);case"paramsChange":default:return!Pu(n,e)}}function ki(n,e,t){let r=hr(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?ki(o,e.children.getContext(s),t):ki(o,null,t):ki(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new pr(e.outlet.component,i)):t.canDeactivateChecks.push(new pr(null,i)):t.canDeactivateChecks.push(new pr(null,i))}function Ki(n){return typeof n=="function"}function bC(n){return typeof n=="boolean"}function SC(n){return n&&Ki(n.canLoad)}function TC(n){return n&&Ki(n.canActivate)}function RC(n){return n&&Ki(n.canActivateChild)}function AC(n){return n&&Ki(n.canDeactivate)}function PC(n){return n&&Ki(n.canMatch)}function sg(n){return n instanceof yp||n?.name==="EmptyError"}var No=Symbol("INITIAL_VALUE");function yr(){return Ue(n=>Ml(n.map(e=>e.pipe(nr(1),Rp(No)))).pipe(x(e=>{for(let t of e)if(t!==!0){if(t===No)return No;if(t===!1||DC(t))return t}return!0}),Gt(e=>e!==No),nr(1)))}function DC(n){return mr(n)||n instanceof vr}function OC(n,e){return Fe(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?C(B(v({},t),{guardsResult:!0})):NC(o,r,i,n).pipe(Fe(a=>a&&bC(a)?MC(r,s,n,e):C(a)),x(a=>B(v({},t),{guardsResult:a})))})}function NC(n,e,t,r){return me(n).pipe(Fe(i=>UC(i.component,i.route,t,e,r)),qt(i=>i!==!0,!0))}function MC(n,e,t,r){return me(e).pipe(yn(i=>Ep(xC(i.route.parent,r),kC(i.route,r),FC(n,i.path,t),LC(n,i.route,t))),qt(i=>i!==!0,!0))}function kC(n,e){return n!==null&&e&&e(new qo(n)),C(!0)}function xC(n,e){return n!==null&&e&&e(new zo(n)),C(!0)}function LC(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return C(!0);let i=r.map(s=>kl(()=>{let o=Gi(e)??t,a=wr(s,o),c=TC(a)?a.canActivate(e,n):Ee(o,()=>a(e,n));return tn(c).pipe(qt())}));return C(i).pipe(yr())}function FC(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>wC(o)).filter(o=>o!==null).map(o=>kl(()=>{let a=o.guards.map(c=>{let l=Gi(o.node)??t,u=wr(c,l),d=RC(u)?u.canActivateChild(r,n):Ee(l,()=>u(r,n));return tn(d).pipe(qt())});return C(a).pipe(yr())}));return C(s).pipe(yr())}function UC(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return C(!0);let o=s.map(a=>{let c=Gi(e)??i,l=wr(a,c),u=AC(l)?l.canDeactivate(n,e,t,r):Ee(c,()=>l(n,e,t,r));return tn(u).pipe(qt())});return C(o).pipe(yr())}function VC(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return C(!0);let s=i.map(o=>{let a=wr(o,n),c=SC(a)?a.canLoad(e,t):Ee(n,()=>a(e,t));return tn(c)});return C(s).pipe(yr(),og(r))}function og(n){return mp(ae(e=>{if(typeof e!="boolean")throw Qo(n,e)}),x(e=>e===!0))}function jC(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return C(!0);let s=i.map(o=>{let a=wr(o,n),c=PC(a)?a.canMatch(e,t):Ee(n,()=>a(e,t));return tn(c)});return C(s).pipe(yr(),og(r))}var Wi=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},$i=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function dr(n){return pi(new Wi(n))}function BC(n){return pi(new O(4e3,!1))}function WC(n){return pi(rg(!1,Se.GuardRejected))}var Nu=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return C(r);if(i.numberOfChildren>1||!i.children[S])return BC(`${e.redirectTo}`);i=i.children[S]}}applyRedirectCommands(e,t,r,i,s){if(typeof t!="string"){let a=t,{queryParams:c,fragment:l,routeConfig:u,url:d,outlet:f,params:p,data:_,title:y}=i,w=Ee(s,()=>a({params:p,data:_,queryParams:c,fragment:l,routeConfig:u,url:d,outlet:f,title:y}));if(w instanceof ct)throw new $i(w);t=w}let o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new $i(o);return o}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new ct(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new U(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new O(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Mu={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function $C(n,e,t,r,i){let s=ag(n,e,t);return s.matched?(r=hC(e,r),jC(r,e,t,i).pipe(x(o=>o===!0?s:v({},Mu)))):C(s)}function ag(n,e,t){if(e.path==="**")return HC(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?v({},Mu):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||Lm)(t,n,e);if(!i)return v({},Mu);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?v(v({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function HC(n){return{matched:!0,parameters:n.length>0?Um(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function Mm(n,e,t,r){return t.length>0&&qC(n,t,r)?{segmentGroup:new U(e,GC(r,new U(t,n.children))),slicedSegments:[]}:t.length===0&&KC(n,t,r)?{segmentGroup:new U(n.segments,zC(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new U(n.segments,n.children),slicedSegments:t}}function zC(n,e,t,r){let i={};for(let s of t)if(na(n,e,s)&&!r[Ye(s)]){let o=new U([],{});i[Ye(s)]=o}return v(v({},r),i)}function GC(n,e){let t={};t[S]=e;for(let r of n)if(r.path===""&&Ye(r)!==S){let i=new U([],{});t[Ye(r)]=i}return t}function qC(n,e,t){return t.some(r=>na(n,e,r)&&Ye(r)!==S)}function KC(n,e,t){return t.some(r=>na(n,e,r))}function na(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function YC(n,e,t){return e.length===0&&!n.children[t]}var ku=class{};function JC(n,e,t,r,i,s,o="emptyOnly"){return new xu(n,e,t,r,i,o,s).recognize()}var XC=31,xu=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Nu(this.urlSerializer,this.urlTree)}noMatchError(e){return new O(4002,`'${e.segmentGroup}'`)}recognize(){let e=Mm(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(x(({children:t,rootSnapshot:r})=>{let i=new Ne(r,t),s=new ji("",i),o=qm(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let t=new Tn([],Object.freeze({}),Object.freeze(v({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),S,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,S,t).pipe(x(r=>({children:r,rootSnapshot:t})),tr(r=>{if(r instanceof $i)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Wi?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,s):this.processSegment(e,t,r,r.segments,i,!0,s).pipe(x(o=>o instanceof Ne?[o]:[]))}processChildren(e,t,r,i){let s=[];for(let o of Object.keys(r.children))o==="primary"?s.unshift(o):s.push(o);return me(s).pipe(yn(o=>{let a=r.children[o],c=fC(t,o);return this.processSegmentGroup(e,c,a,o,i)}),Tp((o,a)=>(o.push(...a),o)),xl(null),Sp(),Fe(o=>{if(o===null)return dr(r);let a=cg(o);return QC(a),C(a)}))}processSegment(e,t,r,i,s,o,a){return me(t).pipe(yn(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,s,o,a).pipe(tr(l=>{if(l instanceof Wi)return C(null);throw l}))),qt(c=>!!c),tr(c=>{if(sg(c))return YC(r,i,s)?C(new ku):dr(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,s,o,a,c){return Ye(r)!==o&&(o===S||!na(i,s,r))?dr(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o,c):dr(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o,a){let{matched:c,parameters:l,consumedSegments:u,positionalParamSegments:d,remainingSegments:f}=ag(t,i,s);if(!c)return dr(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>XC&&(this.allowRedirects=!1));let p=new Tn(s,l,Object.freeze(v({},this.urlTree.queryParams)),this.urlTree.fragment,km(i),Ye(i),i.component??i._loadedComponent??null,i,xm(i)),_=Xo(p,a,this.paramsInheritanceStrategy);p.params=Object.freeze(_.params),p.data=Object.freeze(_.data);let y=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,d,p,e);return this.applyRedirects.lineralizeSegments(i,y).pipe(Fe(w=>this.processSegment(e,r,t,w.concat(f),o,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,s,o){let a=$C(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(Ue(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Ue(({routes:l})=>{let u=r._loadedInjector??e,{parameters:d,consumedSegments:f,remainingSegments:p}=c,_=new Tn(f,d,Object.freeze(v({},this.urlTree.queryParams)),this.urlTree.fragment,km(r),Ye(r),r.component??r._loadedComponent??null,r,xm(r)),y=Xo(_,o,this.paramsInheritanceStrategy);_.params=Object.freeze(y.params),_.data=Object.freeze(y.data);let{segmentGroup:w,slicedSegments:G}=Mm(t,f,p,l);if(G.length===0&&w.hasChildren())return this.processChildren(u,l,w,_).pipe(x(k=>new Ne(_,k)));if(l.length===0&&G.length===0)return C(new Ne(_,[]));let oe=Ye(r)===s;return this.processSegment(u,l,w,G,oe?S:s,!0,_).pipe(x(k=>new Ne(_,k instanceof Ne?[k]:[])))}))):dr(t)))}getChildConfig(e,t,r){return t.children?C({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?C({routes:t._loadedRoutes,injector:t._loadedInjector}):VC(e,t,r,this.urlSerializer).pipe(Fe(i=>i?this.configLoader.loadChildren(e,t).pipe(ae(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):WC(t))):C({routes:[],injector:e})}};function QC(n){n.sort((e,t)=>e.value.outlet===S?-1:t.value.outlet===S?1:e.value.outlet.localeCompare(t.value.outlet))}function ZC(n){let e=n.value.routeConfig;return e&&e.path===""}function cg(n){let e=[],t=new Set;for(let r of n){if(!ZC(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=cg(r.children);e.push(new Ne(r.value,i))}return e.filter(r=>!t.has(r))}function km(n){return n.data||{}}function xm(n){return n.resolve||{}}function eI(n,e,t,r,i,s){return Fe(o=>JC(n,e,t,r,o.extractedUrl,i,s).pipe(x(({state:a,tree:c})=>B(v({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function tI(n,e){return Fe(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return C(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of lg(c))o.add(l);let a=0;return me(o).pipe(yn(c=>s.has(c)?nI(c,r,n,e):(c.data=Xo(c,c.parent,n).resolve,C(void 0))),ae(()=>a++),Ll(1),Fe(c=>a===o.size?C(t):Tt))})}function lg(n){let e=n.children.map(t=>lg(t)).flat();return[n,...e]}function nI(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!eg(i)&&(s[Hi]=i.title),rI(s,n,e,r).pipe(x(o=>(n._resolvedData=o,n.data=Xo(n,n.parent,t).resolve,null)))}function rI(n,e,t,r){let i=Iu(n);if(i.length===0)return C({});let s={};return me(i).pipe(Fe(o=>iI(n[o],e,t,r).pipe(qt(),ae(a=>{if(a instanceof vr)throw Qo(new An,a);s[o]=a}))),Ll(1),x(()=>s),tr(o=>sg(o)?Tt:pi(o)))}function iI(n,e,t,r){let i=Gi(e)??r,s=wr(n,i),o=s.resolve?s.resolve(e,t):Ee(i,()=>s(e,t));return tn(o)}function wu(n){return Ue(e=>{let t=n(e);return t?me(t).pipe(x(()=>e)):C(e)})}var Fu=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===S);return r}getResolvedTitleForRoute(t){return t.data[Hi]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=b({token:n,factory:()=>E(ug),providedIn:"root"})}return n})(),ug=(()=>{class n extends Fu{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(N(Tm))};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Yi=new M("",{providedIn:"root",factory:()=>({})}),Uu=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Ie({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&fe(0,"router-outlet")},dependencies:[qi],encapsulation:2})}return n})();function Vu(n){let e=n.children&&n.children.map(Vu),t=e?B(v({},n),{children:e}):v({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==S&&(t.component=Uu),t}var Ji=new M(""),dg=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=E(Gp);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return C(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=tn(t.loadComponent()).pipe(x(fg),ae(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),rr(()=>{this.componentLoaders.delete(t)})),i=new Dl(r,()=>new st).pipe(Pl());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return C({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=hg(r,this.compiler,t,this.onLoadEndListener).pipe(rr(()=>{this.childrenLoaders.delete(r)})),o=new Dl(s,()=>new st).pipe(Pl());return this.childrenLoaders.set(r,o),o}static \u0275fac=function(r){return new(r||n)};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function hg(n,e,t,r){return tn(n.loadChildren()).pipe(x(fg),Fe(i=>i instanceof Vp||Array.isArray(i)?C(i):me(e.compileModuleAsync(i))),x(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(Ji,[],{optional:!0,self:!0}).flat()),{routes:o.map(Vu),injector:s}}))}function sI(n){return n&&typeof n=="object"&&"default"in n}function fg(n){return sI(n)?n.default:n}var ra=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=b({token:n,factory:()=>E(oI),providedIn:"root"})}return n})(),oI=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),pg=new M("");var mg=new M(""),gg=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new st;transitionAbortSubject=new st;configLoader=E(dg);environmentInjector=E(Kt);destroyRef=E(Vl);urlSerializer=E(zi);rootContexts=E(Er);location=E(go);inputBindingEnabled=E(ta,{optional:!0})!==null;titleStrategy=E(Fu);options=E(Yi,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=E(ra);createViewTransition=E(pg,{optional:!0});navigationErrorHandler=E(mg,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>C(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new $o(i)),r=i=>this.events.next(new Ho(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(B(v({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))}setupNavigations(t){return this.transitions=new pe(null),this.transitions.pipe(Gt(r=>r!==null),Ue(r=>{let i=!1,s=!1;return C(r).pipe(Ue(o=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",Se.SupersededByNewNavigation),Tt;this.currentTransition=r,this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?B(v({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let a=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),c=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!a&&c!=="reload"){let l="";return this.events.next(new Nt(o.id,this.urlSerializer.serialize(o.rawUrl),l,Li.IgnoredSameUrlNavigation)),o.resolve(!1),Tt}if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return C(o).pipe(Ue(l=>(this.events.next(new Pn(l.id,this.urlSerializer.serialize(l.extractedUrl),l.source,l.restoredState)),l.id!==this.navigationId?Tt:Promise.resolve(l))),eI(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),ae(l=>{r.targetSnapshot=l.targetSnapshot,r.urlAfterRedirects=l.urlAfterRedirects,this.currentNavigation=B(v({},this.currentNavigation),{finalUrl:l.urlAfterRedirects});let u=new Fi(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}));if(a&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:l,extractedUrl:u,source:d,restoredState:f,extras:p}=o,_=new Pn(l,this.urlSerializer.serialize(u),d,f);this.events.next(_);let y=Qm(this.rootComponentType).snapshot;return this.currentTransition=r=B(v({},o),{targetSnapshot:y,urlAfterRedirects:u,extras:B(v({},p),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=u,C(r)}else{let l="";return this.events.next(new Nt(o.id,this.urlSerializer.serialize(o.extractedUrl),l,Li.IgnoredByUrlHandlingStrategy)),o.resolve(!1),Tt}}),ae(o=>{let a=new Vo(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),x(o=>(this.currentTransition=r=B(v({},o),{guards:EC(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),r)),OC(this.environmentInjector,o=>this.events.next(o)),ae(o=>{if(r.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw Qo(this.urlSerializer,o.guardsResult);let a=new jo(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),Gt(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",Se.GuardRejected),!1)),wu(o=>{if(o.guards.canActivateChecks.length!==0)return C(o).pipe(ae(a=>{let c=new Bo(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),Ue(a=>{let c=!1;return C(a).pipe(tI(this.paramsInheritanceStrategy,this.environmentInjector),ae({next:()=>c=!0,complete:()=>{c||this.cancelNavigationTransition(a,"",Se.NoDataFromResolver)}}))}),ae(a=>{let c=new Wo(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}))}),wu(o=>{let a=c=>{let l=[];c.routeConfig?.loadComponent&&!c.routeConfig._loadedComponent&&l.push(this.configLoader.loadComponent(c.routeConfig).pipe(ae(u=>{c.component=u}),x(()=>{})));for(let u of c.children)l.push(...a(u));return l};return Ml(a(o.targetSnapshot.root)).pipe(xl(null),nr(1))}),wu(()=>this.afterPreactivation()),Ue(()=>{let{currentSnapshot:o,targetSnapshot:a}=r,c=this.createViewTransition?.(this.environmentInjector,o.root,a.root);return c?me(c).pipe(x(()=>r)):C(r)}),x(o=>{let a=mC(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=r=B(v({},o),{targetRouterState:a}),this.currentNavigation.targetRouterState=a,r}),ae(()=>{this.events.next(new Ui)}),yC(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),nr(1),ae({next:o=>{i=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ot(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{i=!0}}),Ap(this.transitionAbortSubject.pipe(ae(o=>{throw o}))),rr(()=>{!i&&!s&&this.cancelNavigationTransition(r,"",Se.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation=null,this.currentTransition=null)}),tr(o=>{if(this.destroyed)return r.resolve(!1),Tt;if(s=!0,ig(o))this.events.next(new at(r.id,this.urlSerializer.serialize(r.extractedUrl),o.message,o.cancellationCode)),vC(o)?this.events.next(new _r(o.url,o.navigationBehaviorOptions)):r.resolve(!1);else{let a=new gr(r.id,this.urlSerializer.serialize(r.extractedUrl),o,r.targetSnapshot??void 0);try{let c=Ee(this.environmentInjector,()=>this.navigationErrorHandler?.(a));if(c instanceof vr){let{message:l,cancellationCode:u}=Qo(this.urlSerializer,c);this.events.next(new at(r.id,this.urlSerializer.serialize(r.extractedUrl),l,u)),this.events.next(new _r(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(a),o}catch(c){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(c)}}return Tt}))}))}cancelNavigationTransition(t,r,i){let s=new at(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function aI(n){return n!==Lo}var _g=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=b({token:n,factory:()=>E(cI),providedIn:"root"})}return n})(),ea=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},cI=(()=>{class n extends ea{static \u0275fac=(()=>{let t;return function(i){return(t||(t=sr(n)))(i||n)}})();static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),vg=(()=>{class n{urlSerializer=E(zi);options=E(Yi,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=E(go);urlHandlingStrategy=E(ra);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new ct;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:i}){let s=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,o=i??s;return o instanceof ct?this.urlSerializer.serialize(o):o}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:i}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=t):this.rawUrlTree=i}routerState=Qm(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=b({token:n,factory:()=>E(lI),providedIn:"root"})}return n})(),lI=(()=>{class n extends vg{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof Pn?this.updateStateMemento():t instanceof Nt?this.commitTransition(r):t instanceof Fi?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof Ui?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof at&&(t.code===Se.GuardRejected||t.code===Se.NoDataFromResolver)?this.restoreHistory(r):t instanceof gr?this.restoreHistory(r,!0):t instanceof Ot&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:i}){let{replaceUrl:s,state:o}=r;if(this.location.isCurrentPathEqualTo(t)||s){let a=this.browserPageId,c=v(v({},o),this.generateNgRouterState(i,a));this.location.replaceState(t,"",c)}else{let a=v(v({},o),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.getCurrentUrlTree()===t.finalUrl&&s===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=sr(n)))(i||n)}})();static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ju(n,e){n.events.pipe(Gt(t=>t instanceof Ot||t instanceof at||t instanceof gr||t instanceof Nt),x(t=>t instanceof Ot||t instanceof Nt?0:(t instanceof at?t.code===Se.Redirect||t.code===Se.SupersededByNewNavigation:!1)?2:1),Gt(t=>t!==2),nr(1)).subscribe(()=>{e()})}var uI={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},dI={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},lt=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=E(ql);stateManager=E(vg);options=E(Yi,{optional:!0})||{};pendingTasks=E(ho);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=E(gg);urlSerializer=E(zi);location=E(go);urlHandlingStrategy=E(ra);_events=new st;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=E(_g);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=E(Ji,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!E(ta,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new pp;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof at&&r.code!==Se.Redirect&&r.code!==Se.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Ot)this.navigated=!0;else if(r instanceof _r){let o=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=v({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||aI(i.source)},o);this.scheduleNavigation(a,Lo,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}fI(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Lo,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,i)=>{this.navigateToSyncWithBrowser(t,i,r)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let c=v({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Vu),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=r,l=c?this.currentUrlTree.fragment:o,u=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":u=v(v({},this.currentUrlTree.queryParams),s);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}u!==null&&(u=this.removeEmptyProps(u));let d;try{let f=i?i.snapshot:this.routerState.snapshot.root;d=Km(f)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),d=this.currentUrlTree.root}return Ym(d,t,u,l??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=mr(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Lo,null,r)}navigate(t,r={skipLocationChange:!1}){return hI(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=v({},uI):r===!1?i=v({},dI):i=r,mr(t))return Pm(this.currentUrlTree,t,i);let s=this.parseUrl(t);return Pm(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,l;o?(a=o.resolve,c=o.reject,l=o.promise):l=new Promise((d,f)=>{a=d,c=f});let u=this.pendingTasks.add();return ju(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(d=>Promise.reject(d))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function hI(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new O(4008,!1)}function fI(n){return!(n instanceof Ui)&&!(n instanceof _r)}var gI=new M("");function Bu(n,...e){return ir([{provide:Ji,multi:!0,useValue:n},[],{provide:en,useFactory:_I,deps:[lt]},{provide:mo,multi:!0,useFactory:vI},e.map(t=>t.\u0275providers)])}function _I(n){return n.routerState.root}function vI(){let n=E(Yt);return e=>{let t=n.get(wi);if(e!==t.components[0])return;let r=n.get(lt),i=n.get(yI);n.get(EI)===1&&r.initialNavigation(),n.get(wI,null,Fl.Optional)?.setUpPreloading(),n.get(gI,null,Fl.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var yI=new M("",{factory:()=>new st}),EI=new M("",{providedIn:"root",factory:()=>1});var wI=new M("");var Rg=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(W(zl),W(Bl))};static \u0275dir=Ve({type:n})}return n})(),Ag=(()=>{class n extends Rg{static \u0275fac=(()=>{let t;return function(i){return(t||(t=sr(n)))(i||n)}})();static \u0275dir=Ve({type:n,features:[Jt]})}return n})(),Ku=new M(""),II={provide:Ku,useExisting:mi(()=>Yu),multi:!0},Yu=(()=>{class n extends Ag{writeValue(t){this.setProperty("checked",t)}static \u0275fac=(()=>{let t;return function(i){return(t||(t=sr(n)))(i||n)}})();static \u0275dir=Ve({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(r,i){r&1&&we("change",function(o){return i.onChange(o.target.checked)})("blur",function(){return i.onTouched()})},standalone:!1,features:[Ii([II]),Jt]})}return n})(),bI={provide:Ku,useExisting:mi(()=>Ar),multi:!0};function SI(){let n=Xt()?Xt().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var TI=new M(""),Ar=(()=>{class n extends Rg{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!SI())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(W(zl),W(Bl),W(TI,8))};static \u0275dir=Ve({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&we("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},standalone:!1,features:[Ii([bI]),Jt]})}return n})();function Ju(n){return n==null||Xu(n)===0}function Xu(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var Pg=new M(""),Dg=new M(""),RI=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Mt=class{static min(e){return AI(e)}static max(e){return PI(e)}static required(e){return DI(e)}static requiredTrue(e){return OI(e)}static email(e){return NI(e)}static minLength(e){return MI(e)}static maxLength(e){return kI(e)}static pattern(e){return xI(e)}static nullValidator(e){return Og()}static compose(e){return Fg(e)}static composeAsync(e){return Vg(e)}};function AI(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function PI(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function DI(n){return Ju(n.value)?{required:!0}:null}function OI(n){return n.value===!0?null:{required:!0}}function NI(n){return Ju(n.value)||RI.test(n.value)?null:{email:!0}}function MI(n){return e=>{let t=e.value?.length??Xu(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function kI(n){return e=>{let t=e.value?.length??Xu(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function xI(n){if(!n)return Og;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(Ju(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function Og(n){return null}function Ng(n){return n!=null}function Mg(n){return po(n)?me(n):n}function kg(n){let e={};return n.forEach(t=>{e=t!=null?v(v({},e),t):e}),Object.keys(e).length===0?null:e}function xg(n,e){return e.map(t=>t(n))}function LI(n){return!n.validate}function Lg(n){return n.map(e=>LI(e)?e:t=>e.validate(t))}function Fg(n){if(!n)return null;let e=n.filter(Ng);return e.length==0?null:function(t){return kg(xg(t,e))}}function Ug(n){return n!=null?Fg(Lg(n)):null}function Vg(n){if(!n)return null;let e=n.filter(Ng);return e.length==0?null:function(t){let r=xg(t,e).map(Mg);return wp(r).pipe(x(kg))}}function jg(n){return n!=null?Vg(Lg(n)):null}function yg(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Bg(n){return n._rawValidators}function Wg(n){return n._rawAsyncValidators}function $u(n){return n?Array.isArray(n)?n:[n]:[]}function sa(n,e){return Array.isArray(n)?n.includes(e):n===e}function Eg(n,e){let t=$u(e);return $u(n).forEach(i=>{sa(t,i)||t.push(i)}),t}function wg(n,e){return $u(e).filter(t=>!sa(n,t))}var oa=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Ug(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=jg(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Sr=class extends oa{name;get formDirective(){return null}get path(){return null}},ts=class extends oa{_parent=null;name=null;valueAccessor=null},aa=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},FI={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},DM=B(v({},FI),{"[class.ng-submitted]":"isSubmitted"}),da=(()=>{class n extends aa{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(W(ts,2))};static \u0275dir=Ve({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Kl("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[Jt]})}return n})(),ha=(()=>{class n extends aa{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(W(Sr,10))};static \u0275dir=Ve({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&Kl("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[Jt]})}return n})();var Xi="VALID",ia="INVALID",Cr="PENDING",Qi="DISABLED",nn=class{},ca=class extends nn{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Zi=class extends nn{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},es=class extends nn{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Ir=class extends nn{status;source;constructor(e,t){super(),this.status=e,this.source=t}},Hu=class extends nn{source;constructor(e){super(),this.source=e}},zu=class extends nn{source;constructor(e){super(),this.source=e}};function Qu(n){return(fa(n)?n.validators:n)||null}function UI(n){return Array.isArray(n)?Ug(n):n||null}function Zu(n,e){return(fa(e)?e.asyncValidators:n)||null}function VI(n){return Array.isArray(n)?jg(n):n||null}function fa(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function $g(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new O(1e3,"");if(!r[t])throw new O(1001,"")}function Hg(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new O(1002,"")})}var Tr=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Rt(this.statusReactive)}set status(e){Rt(()=>this.statusReactive.set(e))}_status=bn(()=>this.statusReactive());statusReactive=Cn(void 0);get valid(){return this.status===Xi}get invalid(){return this.status===ia}get pending(){return this.status==Cr}get disabled(){return this.status===Qi}get enabled(){return this.status!==Qi}errors;get pristine(){return Rt(this.pristineReactive)}set pristine(e){Rt(()=>this.pristineReactive.set(e))}_pristine=bn(()=>this.pristineReactive());pristineReactive=Cn(!0);get dirty(){return!this.pristine}get touched(){return Rt(this.touchedReactive)}set touched(e){Rt(()=>this.touchedReactive.set(e))}_touched=bn(()=>this.touchedReactive());touchedReactive=Cn(!1);get untouched(){return!this.touched}_events=new st;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Eg(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Eg(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(wg(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(wg(e,this._rawAsyncValidators))}hasValidator(e){return sa(this._rawValidators,e)}hasAsyncValidator(e){return sa(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(B(v({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new es(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new es(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(B(v({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Zi(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new Zi(!0,r))}markAsPending(e={}){this.status=Cr;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ir(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(B(v({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Qi,this.errors=null,this._forEachChild(i=>{i.disable(B(v({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ca(this.value,r)),this._events.next(new Ir(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(B(v({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Xi,this._forEachChild(r=>{r.enable(B(v({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(B(v({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Xi||this.status===Cr)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ca(this.value,t)),this._events.next(new Ir(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(B(v({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Qi:Xi}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Cr,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=Mg(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Ir(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new ie,this.statusChanges=new ie}_calculateStatus(){return this._allControlsDisabled()?Qi:this.errors?ia:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Cr)?Cr:this._anyControlsHaveStatus(ia)?ia:Xi}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new Zi(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new es(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){fa(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=UI(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=VI(this._rawAsyncValidators)}},Rr=class extends Tr{constructor(e,t,r){super(Qu(t),Zu(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){Hg(this,!0,e),Object.keys(e).forEach(r=>{$g(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Gu=class extends Rr{};var ed=new M("",{providedIn:"root",factory:()=>pa}),pa="always";function jI(n,e){return[...e.path,n]}function Cg(n,e,t=pa){td(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),WI(n,e),HI(n,e),$I(n,e),BI(n,e)}function Ig(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),ua(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function la(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function BI(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function td(n,e){let t=Bg(n);e.validator!==null?n.setValidators(yg(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=Wg(n);e.asyncValidator!==null?n.setAsyncValidators(yg(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();la(e._rawValidators,i),la(e._rawAsyncValidators,i)}function ua(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=Bg(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,n.setValidators(s))}}if(e.asyncValidator!==null){let i=Wg(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,n.setAsyncValidators(s))}}}let r=()=>{};return la(e._rawValidators,r),la(e._rawAsyncValidators,r),t}function WI(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&zg(n,e)})}function $I(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&zg(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function zg(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function HI(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function zI(n,e){n==null,td(n,e)}function GI(n,e){return ua(n,e)}function qI(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function KI(n){return Object.getPrototypeOf(n.constructor)===Ag}function YI(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function JI(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===Ar?t=s:KI(s)?r=s:i=s}),i||r||t||null}function XI(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function bg(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Sg(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var br=class extends Tr{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(Qu(t),Zu(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),fa(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Sg(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){bg(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){bg(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Sg(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var QI=n=>n instanceof br;var ma=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=Ve({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var Gg=new M("");var ZI={provide:Sr,useExisting:mi(()=>ns)},ns=(()=>{class n extends Sr{callSetDisabledState;get submitted(){return Rt(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=bn(()=>this._submittedReactive());_submittedReactive=Cn(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new ie;constructor(t,r,i){super(),this.callSetDisabledState=i,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(ua(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let r=this.form.get(t.path);return Cg(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){Ig(t.control||null,t,!1),XI(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this._submittedReactive.set(!0),YI(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new Hu(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this._submittedReactive.set(!1),this.form._events.next(new zu(this.form))}_updateDomValue(){this.directives.forEach(t=>{let r=t.control,i=this.form.get(t.path);r!==i&&(Ig(r||null,t),QI(i)&&(Cg(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let r=this.form.get(t.path);zI(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let r=this.form.get(t.path);r&&GI(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){td(this.form,this),this._oldForm&&ua(this._oldForm,this)}static \u0275fac=function(r){return new(r||n)(W(Pg,10),W(Dg,10),W(ed,8))};static \u0275dir=Ve({type:n,selectors:[["","formGroup",""]],hostBindings:function(r,i){r&1&&we("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Ii([ZI]),Jt,wn]})}return n})();var eb={provide:ts,useExisting:mi(()=>rs)},rs=(()=>{class n extends ts{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new ie;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,r,i,s,o){super(),this._ngModelWarningConfig=o,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=JI(this,s)}ngOnChanges(t){this._added||this._setUpControl(),qI(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return jI(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(r){return new(r||n)(W(Sr,13),W(Pg,10),W(Dg,10),W(Ku,10),W(Gg,8))};static \u0275dir=Ve({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Ii([eb]),Jt,wn]})}return n})();var qg=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=In({type:n});static \u0275inj=En({})}return n})(),qu=class extends Tr{constructor(e,t,r){super(Qu(t),Zu(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){Hg(this,!1,e),e.forEach((r,i)=>{$g(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>r._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function Tg(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var ga=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,r=null){let i=this._reduceControls(t),s={};return Tg(r)?s=r:r!==null&&(s.validators=r.validator,s.asyncValidators=r.asyncValidator),new Rr(i,s)}record(t,r=null){let i=this._reduceControls(t);return new Gu(i,r)}control(t,r,i){let s={};return this.useNonNullable?(Tg(r)?s=r:(s.validators=r,s.asyncValidators=i),new br(t,B(v({},s),{nonNullable:!0}))):new br(t,r,i)}array(t,r,i){let s=t.map(o=>this._createControl(o));return new qu(s,r,i)}_reduceControls(t){let r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){if(t instanceof br)return t;if(t instanceof Tr)return t;if(Array.isArray(t)){let r=t[0],i=t.length>1?t[1]:null,s=t.length>2?t[2]:null;return this.control(r,i,s)}else return this.control(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Kg=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:ed,useValue:t.callSetDisabledState??pa}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=In({type:n});static \u0275inj=En({imports:[qg]})}return n})(),Pr=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Gg,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:ed,useValue:t.callSetDisabledState??pa}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=In({type:n});static \u0275inj=En({imports:[qg]})}return n})();var Pd={};jE(Pd,{FirebaseError:()=>le,SDK_VERSION:()=>Xe,_DEFAULT_ENTRY_NAME:()=>pt,_addComponent:()=>Ur,_addOrOverwriteComponent:()=>Td,_apps:()=>on,_clearComponents:()=>eS,_components:()=>Fr,_getProvider:()=>xn,_isFirebaseApp:()=>C_,_isFirebaseServerApp:()=>$,_registerComponent:()=>Je,_removeServiceInstance:()=>Zb,_serverApps:()=>Lr,deleteApp:()=>Da,getApp:()=>us,getApps:()=>I_,initializeApp:()=>Pa,initializeServerApp:()=>nS,onLog:()=>Rd,registerVersion:()=>ue,setLogLevel:()=>Ad});var Yg=()=>{};var id={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var g=function(n,e){if(!n)throw On(e)},On=function(n){return new Error("Firebase Database ("+id.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var Xg=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},tb=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},va={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,l=c?n[i+2]:0,u=s>>2,d=(s&3)<<4|a>>4,f=(a&15)<<2|l>>6,p=l&63;c||(p=64,o||(f=64)),r.push(t[u],t[d],t[f],t[p])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Xg(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):tb(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let d=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||l==null||d==null)throw new sd;let f=s<<2|a>>4;if(r.push(f),l!==64){let p=a<<4&240|l>>2;if(r.push(p),d!==64){let _=l<<6&192|d;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},sd=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},ad=function(n){let e=Xg(n);return va.encodeByteArray(e,!0)},is=function(n){return ad(n).replace(/\./g,"")},Dn=function(n){try{return va.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Qg(n){return Or(void 0,n)}function Or(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!nb(t)||(n[t]=Or(n[t],e[t]));return n}function nb(n){return n!=="__proto__"}function cd(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var rb=()=>cd().__FIREBASE_DEFAULTS__,ib=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},sb=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Dn(n[1]);return e&&JSON.parse(e)},ya=()=>{try{return Yg()||rb()||ib()||sb()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ld=n=>{var e,t;return(t=(e=ya())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Zg=n=>{let e=ld(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},ud=()=>{var n;return(n=ya())===null||n===void 0?void 0:n.config},dd=n=>{var e;return(e=ya())===null||e===void 0?void 0:e[`_${n}`]};var rn=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function e_(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[is(JSON.stringify(t)),is(JSON.stringify(o)),""].join(".")}function Q(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ss(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Q())}function hd(){var n;let e=(n=ya())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function t_(){return typeof window<"u"||fd()}function fd(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function n_(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Ea(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Nn(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function wa(){let n=Q();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function ut(){return id.NODE_CLIENT===!0||id.NODE_ADMIN===!0}function Nr(){try{return typeof indexedDB=="object"}catch{return!1}}function r_(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var ob="FirebaseError",le=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=ob,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,We.prototype.create)}},We=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?ab(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new le(i,a,r)}};function ab(n,e){return n.replace(cb,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var cb=/\{\$([^}]+)}/g;function Dr(n){return JSON.parse(n)}function te(n){return JSON.stringify(n)}var i_=function(n){let e={},t={},r={},i="";try{let s=n.split(".");e=Dr(Dn(s[0])||""),t=Dr(Dn(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}};var s_=function(n){let e=i_(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},o_=function(n){let e=i_(n).claims;return typeof e=="object"&&e.admin===!0};function ke(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Mn(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function os(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function as(n,e,t){let r={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function dt(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(Jg(s)&&Jg(o)){if(!dt(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Jg(n){return n!==null&&typeof n=="object"}function kt(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function sn(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Mr(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var _a=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let r=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)r[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)r[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){let f=r[d-3]^r[d-8]^r[d-14]^r[d-16];r[d]=(f<<1|f>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,u;for(let d=0;d<80;d++){d<40?d<20?(l=a^s&(o^a),u=1518500249):(l=s^o^a,u=1859775393):d<60?(l=s&o|a&(s|o),u=2400959708):(l=s^o^a,u=3395469782);let f=(i<<5|i>>>27)+l+c+u+r[d]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=f}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function Ca(n,e){let t=new od(n,e);return t.subscribe.bind(t)}var od=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");lb(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=rd),i.error===void 0&&(i.error=rd),i.complete===void 0&&(i.complete=rd);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function lb(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function rd(){}function Ia(n,e){return`${n} failed: ${e} argument `}var a_=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,g(r<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},cs=function(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};var xM=4*60*60*1e3;function I(n){return n&&n._delegate?n._delegate:n}function kr(n){return n.endsWith(".cloudworkstations.dev")}function ba(n){return h(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}var _e=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var kn="[DEFAULT]";var Sa=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new rn;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(db(e))try{this.getOrInitializeService({instanceIdentifier:kn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=kn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return h(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=kn){return this.instances.has(e)}getOptions(e=kn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:ub(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=kn){return this.component?this.component.multipleInstances?e:kn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function ub(n){return n===kn?void 0:n}function db(n){return n.instantiationMode==="EAGER"}var xr=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Sa(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var pd=[],V=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(V||{}),c_={debug:V.DEBUG,verbose:V.VERBOSE,info:V.INFO,warn:V.WARN,error:V.ERROR,silent:V.SILENT},hb=V.INFO,fb={[V.DEBUG]:"log",[V.VERBOSE]:"log",[V.INFO]:"info",[V.WARN]:"warn",[V.ERROR]:"error"},pb=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=fb[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},ht=class{constructor(e){this.name=e,this._logLevel=hb,this._logHandler=pb,this._userLogHandler=null,pd.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in V))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?c_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,V.DEBUG,...e),this._logHandler(this,V.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,V.VERBOSE,...e),this._logHandler(this,V.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,V.INFO,...e),this._logHandler(this,V.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,V.WARN,...e),this._logHandler(this,V.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,V.ERROR,...e),this._logHandler(this,V.ERROR,...e)}};function l_(n){pd.forEach(e=>{e.setLogLevel(n)})}function u_(n,e){for(let t of pd){let r=null;e&&e.level&&(r=c_[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{let a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&n({level:V[s].toLowerCase(),message:a,args:o,type:i.name})}}}var mb=(n,e)=>e.some(t=>n instanceof t),d_,h_;function gb(){return d_||(d_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _b(){return h_||(h_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var f_=new WeakMap,gd=new WeakMap,p_=new WeakMap,md=new WeakMap,vd=new WeakMap;function vb(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(ft(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&f_.set(t,n)}).catch(()=>{}),vd.set(e,n),e}function yb(n){if(gd.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});gd.set(n,e)}var _d={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return gd.get(n);if(e==="objectStoreNames")return n.objectStoreNames||p_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ft(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function m_(n){_d=n(_d)}function Eb(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Ta(this),e,...t);return p_.set(r,e.sort?e.sort():[e]),ft(r)}:_b().includes(n)?function(...e){return n.apply(Ta(this),e),ft(f_.get(this))}:function(...e){return ft(n.apply(Ta(this),e))}}function wb(n){return typeof n=="function"?Eb(n):(n instanceof IDBTransaction&&yb(n),mb(n,gb())?new Proxy(n,_d):n)}function ft(n){if(n instanceof IDBRequest)return vb(n);if(md.has(n))return md.get(n);let e=wb(n);return e!==n&&(md.set(n,e),vd.set(e,n)),e}var Ta=n=>vd.get(n);function __(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=ft(o);return r&&o.addEventListener("upgradeneeded",c=>{r(ft(o.result),c.oldVersion,c.newVersion,ft(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var Cb=["get","getKey","getAll","getAllKeys","count"],Ib=["put","add","delete","clear"],yd=new Map;function g_(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(yd.get(e))return yd.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=Ib.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Cb.includes(t)))return;let s=function(o,...a){return h(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[t](...a),i&&c.done]))[0]})};return yd.set(e,s),s}m_(n=>B(v({},n),{get:(e,t,r)=>g_(e,t)||n.get(e,t,r),has:(e,t)=>!!g_(e,t)||n.has(e,t)}));var wd=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(bb(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function bb(n){let e=n.getComponent();return e?.type==="VERSION"}var Ra="@firebase/app",Cd="0.12.1";var xt=new ht("@firebase/app"),Sb="@firebase/app-compat",Tb="@firebase/analytics-compat",Rb="@firebase/analytics",Ab="@firebase/app-check-compat",Pb="@firebase/app-check",Db="@firebase/auth",Ob="@firebase/auth-compat",Nb="@firebase/database",Mb="@firebase/data-connect",kb="@firebase/database-compat",xb="@firebase/functions",Lb="@firebase/functions-compat",Fb="@firebase/installations",Ub="@firebase/installations-compat",Vb="@firebase/messaging",jb="@firebase/messaging-compat",Bb="@firebase/performance",Wb="@firebase/performance-compat",$b="@firebase/remote-config",Hb="@firebase/remote-config-compat",zb="@firebase/storage",Gb="@firebase/storage-compat",qb="@firebase/firestore",Kb="@firebase/vertexai",Yb="@firebase/firestore-compat",Jb="firebase",Xb="11.7.1";var pt="[DEFAULT]",Qb={[Ra]:"fire-core",[Sb]:"fire-core-compat",[Rb]:"fire-analytics",[Tb]:"fire-analytics-compat",[Pb]:"fire-app-check",[Ab]:"fire-app-check-compat",[Db]:"fire-auth",[Ob]:"fire-auth-compat",[Nb]:"fire-rtdb",[Mb]:"fire-data-connect",[kb]:"fire-rtdb-compat",[xb]:"fire-fn",[Lb]:"fire-fn-compat",[Fb]:"fire-iid",[Ub]:"fire-iid-compat",[Vb]:"fire-fcm",[jb]:"fire-fcm-compat",[Bb]:"fire-perf",[Wb]:"fire-perf-compat",[$b]:"fire-rc",[Hb]:"fire-rc-compat",[zb]:"fire-gcs",[Gb]:"fire-gcs-compat",[qb]:"fire-fst",[Yb]:"fire-fst-compat",[Kb]:"fire-vertex","fire-js":"fire-js",[Jb]:"fire-js-all"};var on=new Map,Lr=new Map,Fr=new Map;function Ur(n,e){try{n.container.addComponent(e)}catch(t){xt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Td(n,e){n.container.addOrOverwriteComponent(e)}function Je(n){let e=n.name;if(Fr.has(e))return xt.debug(`There were multiple attempts to register component ${e}.`),!1;Fr.set(e,n);for(let t of on.values())Ur(t,n);for(let t of Lr.values())Ur(t,n);return!0}function xn(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Zb(n,e,t=pt){xn(n,e).clearInstance(t)}function C_(n){return n.options!==void 0}function $(n){return n==null?!1:n.settings!==void 0}function eS(){Fr.clear()}var tS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},$e=new We("app","Firebase",tS);var Aa=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new _e("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw $e.create("app-deleted",{appName:this._name})}};function v_(n,e){let t=Dn(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}let i=JSON.parse(t).exp*1e3,s=new Date().getTime();i-s<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}var Id=class extends Aa{constructor(e,t,r,i){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{let a=e;super(a.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._serverConfig.authIdToken&&v_(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&v_(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,ue(Ra,Cd,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Da(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw $e.create("server-app-deleted")}};var Xe=Xb;function Pa(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:pt,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw $e.create("bad-app-name",{appName:String(i)});if(t||(t=ud()),!t)throw $e.create("no-options");let s=on.get(i);if(s){if(dt(t,s.options)&&dt(r,s.config))return s;throw $e.create("duplicate-app",{appName:i})}let o=new xr(i);for(let c of Fr.values())o.addComponent(c);let a=new Aa(t,r,o);return on.set(i,a),a}function nS(n,e){if(t_()&&!fd())throw $e.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;C_(n)?t=n.options:t=n;let r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;let i=l=>[...l].reduce((u,d)=>Math.imul(31,u)+d.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw $e.create("finalization-registry-not-supported",{});let s=""+i(JSON.stringify(r)),o=Lr.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;let a=new xr(s);for(let l of Fr.values())a.addComponent(l);let c=new Id(t,e,s,a);return Lr.set(s,c),c}function us(n=pt){let e=on.get(n);if(!e&&n===pt&&ud())return Pa();if(!e)throw $e.create("no-app",{appName:n});return e}function I_(){return Array.from(on.values())}function Da(n){return h(this,null,function*(){let e=!1,t=n.name;on.has(t)?(e=!0,on.delete(t)):Lr.has(t)&&n.decRefCount()<=0&&(Lr.delete(t),e=!0),e&&(yield Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)})}function ue(n,e,t){var r;let i=(r=Qb[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),xt.warn(a.join(" "));return}Je(new _e(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function Rd(n,e){if(n!==null&&typeof n!="function")throw $e.create("invalid-log-argument");u_(n,e)}function Ad(n){l_(n)}var rS="firebase-heartbeat-database",iS=1,ls="firebase-heartbeat-store",Ed=null;function b_(){return Ed||(Ed=__(rS,iS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ls)}catch(t){console.warn(t)}}}}).catch(n=>{throw $e.create("idb-open",{originalErrorMessage:n.message})})),Ed}function sS(n){return h(this,null,function*(){try{let t=(yield b_()).transaction(ls),r=yield t.objectStore(ls).get(S_(n));return yield t.done,r}catch(e){if(e instanceof le)xt.warn(e.message);else{let t=$e.create("idb-get",{originalErrorMessage:e?.message});xt.warn(t.message)}}})}function y_(n,e){return h(this,null,function*(){try{let r=(yield b_()).transaction(ls,"readwrite");yield r.objectStore(ls).put(e,S_(n)),yield r.done}catch(t){if(t instanceof le)xt.warn(t.message);else{let r=$e.create("idb-set",{originalErrorMessage:t?.message});xt.warn(r.message)}}})}function S_(n){return`${n.name}!${n.options.appId}`}var oS=1024,aS=30,bd=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Sd(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return h(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=E_();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>aS){let o=lS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){xt.warn(r)}})}getHeartbeatsHeader(){return h(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=E_(),{heartbeatsToSend:r,unsentEntries:i}=cS(this._heartbeatsCache.heartbeats),s=is(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return xt.warn(t),""}})}};function E_(){return new Date().toISOString().substring(0,10)}function cS(n,e=oS){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),w_(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),w_(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Sd=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return h(this,null,function*(){return Nr()?r_().then(()=>!0).catch(()=>!1):!1})}read(){return h(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield sS(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return h(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return y_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return h(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return y_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function w_(n){return is(JSON.stringify({version:2,heartbeats:n})).length}function lS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function uS(n){Je(new _e("platform-logger",e=>new wd(e),"PRIVATE")),Je(new _e("heartbeat",e=>new bd(e),"PRIVATE")),ue(Ra,Cd,n),ue(Ra,Cd,"esm2017"),ue("fire-js","")}uS("");var dn={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};var jt={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function dS(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function H_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Ka=dS,ah=H_,z_=new We("auth","Firebase",H_());var ka=new ht("@firebase/auth");function hS(n,...e){ka.logLevel<=V.WARN&&ka.warn(`Auth (${Xe}): ${n}`,...e)}function Na(n,...e){ka.logLevel<=V.ERROR&&ka.error(`Auth (${Xe}): ${n}`,...e)}function Z(n,...e){throw lh(n,...e)}function re(n,...e){return lh(n,...e)}function ch(n,e,t){let r=Object.assign(Object.assign({},ah()),{[e]:t});return new We("auth","Firebase",r).create(e,{appName:n.name})}function de(n){return ch(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $r(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Z(n,"argument-error"),ch(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function lh(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return z_.create(n,...e)}function m(n,e,...t){if(!n)throw lh(e,...t)}function mt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Na(e),new Error(e)}function He(n,e){n||mt(e)}function vs(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function uh(){return T_()==="http:"||T_()==="https:"}function T_(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function fS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(uh()||Ea()||"connection"in navigator)?navigator.onLine:!0}function pS(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Ln=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,He(t>e,"Short delay should be less than long delay!"),this.isMobile=ss()||Nn()}get(){return fS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function dh(n,e){He(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var ys=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;mt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;mt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;mt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var mS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var gS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],_S=new Ln(3e4,6e4);function q(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function K(s,o,a,c){return h(this,arguments,function*(n,e,t,r,i={}){return G_(n,i,()=>h(null,null,function*(){let l={},u={};r&&(e==="GET"?u=r:l={body:JSON.stringify(r)});let d=kt(Object.assign({key:n.config.apiKey},u)).slice(1),f=yield n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);let p=Object.assign({method:e,headers:f},l);return n_()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&kr(n.emulatorConfig.host)&&(p.credentials="include"),ys.fetch()(yield q_(n,n.config.apiHost,t,d),p)}))})}function G_(n,e,t){return h(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},mS),e);try{let i=new xd(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw hs(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw hs(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw hs(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw hs(n,"user-disabled",o);let u=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw ch(n,u,l);Z(n,u)}}catch(i){if(i instanceof le)throw i;Z(n,"network-request-failed",{message:String(i)})}})}function Bt(s,o,a,c){return h(this,arguments,function*(n,e,t,r,i={}){let l=yield K(n,e,t,r,i);return"mfaPendingCredential"in l&&Z(n,"multi-factor-auth-required",{_serverResponse:l}),l})}function q_(n,e,t,r){return h(this,null,function*(){let i=`${e}${t}?${r}`,s=n,o=s.config.emulator?dh(n.config,i):`${n.config.apiScheme}://${i}`;return gS.includes(t)&&(yield s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o})}function vS(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var xd=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(re(this.auth,"network-request-failed")),_S.get())})}};function hs(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=re(n,e,r);return i.customData._tokenResponse=t,i}function R_(n){return n!==void 0&&n.getResponse!==void 0}function A_(n){return n!==void 0&&n.enterprise!==void 0}var xa=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return vS(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};function yS(n){return h(this,null,function*(){return(yield K(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})}function K_(n,e){return h(this,null,function*(){return K(n,"GET","/v2/recaptchaConfig",q(n,e))})}function ES(n,e){return h(this,null,function*(){return K(n,"POST","/v1/accounts:delete",e)})}function wS(n,e){return h(this,null,function*(){return K(n,"POST","/v1/accounts:update",e)})}function La(n,e){return h(this,null,function*(){return K(n,"POST","/v1/accounts:lookup",e)})}function fs(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function hh(n,e=!1){return h(this,null,function*(){let t=I(n),r=yield t.getIdToken(e),i=Ya(r);m(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:fs(Dd(i.auth_time)),issuedAtTime:fs(Dd(i.iat)),expirationTime:fs(Dd(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Dd(n){return Number(n)*1e3}function Ya(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Na("JWT malformed, contained fewer than 3 sections"),null;try{let i=Dn(t);return i?JSON.parse(i):(Na("Failed to decode base64 JWT payload"),null)}catch(i){return Na("Caught error parsing JWT payload as JSON",i?.toString()),null}}function P_(n){let e=Ya(n);return m(e,"internal-error"),m(typeof e.exp<"u","internal-error"),m(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Ut(n,e,t=!1){return h(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof le&&CS(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function CS({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Ld=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>h(this,null,function*(){yield this.iteration()}),t)}iteration(){return h(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Es=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=fs(this.lastLoginAt),this.creationTime=fs(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function ws(n){return h(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Ut(n,La(t,{idToken:r}));m(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Y_(s.providerUserInfo):[],a=IS(n.providerData,o),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,u=c?l:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Es(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(n,d)})}function fh(n){return h(this,null,function*(){let e=I(n);yield ws(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function IS(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Y_(n){return n.map(e=>{var{providerId:t}=e,r=uo(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function bS(n,e){return h(this,null,function*(){let t=yield G_(n,{},()=>h(null,null,function*(){let r=kt({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=yield q_(n,i,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",ys.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function SS(n,e){return h(this,null,function*(){return K(n,"POST","/v2/accounts:revokeToken",q(n,e))})}var ps=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){m(e.idToken,"internal-error"),m(typeof e.idToken<"u","internal-error"),m(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):P_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){m(e.length!==0,"internal-error");let t=P_(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return h(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(m(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return h(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield bS(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(m(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(m(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(m(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return mt("not implemented")}};function an(n,e){m(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Lt=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=uo(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ld(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Es(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return h(this,null,function*(){let t=yield Ut(this,this.stsTokenManager.getToken(this.auth,e));return m(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return hh(this,e)}reload(){return fh(this)}_assign(e){this!==e&&(m(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){m(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return h(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield ws(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return h(this,null,function*(){if($(this.auth.app))return Promise.reject(de(this.auth));let e=yield this.getIdToken();return yield Ut(this,ES(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,l,u;let d=(r=t.displayName)!==null&&r!==void 0?r:void 0,f=(i=t.email)!==null&&i!==void 0?i:void 0,p=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,_=(o=t.photoURL)!==null&&o!==void 0?o:void 0,y=(a=t.tenantId)!==null&&a!==void 0?a:void 0,w=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,G=(l=t.createdAt)!==null&&l!==void 0?l:void 0,oe=(u=t.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:k,emailVerified:Le,isAnonymous:it,providerData:St,stsTokenManager:fi}=t;m(k&&fi,e,"internal-error");let UE=ps.fromJSON(this.name,fi);m(typeof k=="string",e,"internal-error"),an(d,e.name),an(f,e.name),m(typeof Le=="boolean",e,"internal-error"),m(typeof it=="boolean",e,"internal-error"),an(p,e.name),an(_,e.name),an(y,e.name),an(w,e.name),an(G,e.name),an(oe,e.name);let Al=new n({uid:k,auth:e,email:f,emailVerified:Le,displayName:d,isAnonymous:it,photoURL:_,phoneNumber:p,tenantId:y,stsTokenManager:UE,createdAt:G,lastLoginAt:oe});return St&&Array.isArray(St)&&(Al.providerData=St.map(VE=>Object.assign({},VE))),w&&(Al._redirectEventId=w),Al}static _fromIdTokenResponse(e,t,r=!1){return h(this,null,function*(){let i=new ps;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield ws(s),s})}static _fromGetAccountInfoResponse(e,t,r){return h(this,null,function*(){let i=t.users[0];m(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?Y_(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new ps;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Es(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var D_=new Map;function ve(n){He(n instanceof Function,"Expected a class definition");let e=D_.get(n);return e?(He(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,D_.set(n,e),e)}var TS=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return h(this,null,function*(){return!0})}_set(t,r){return h(this,null,function*(){this.storage[t]=r})}_get(t){return h(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return h(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Vt=TS;function gt(n,e,t){return`firebase:${n}:${e}:${t}`}var Fa=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=gt(this.userKey,i.apiKey,s),this.fullPersistenceKey=gt("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return h(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=yield La(this.auth,{idToken:e}).catch(()=>{});return t?Lt._fromGetAccountInfoResponse(this.auth,t,e):null}return Lt._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return h(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return h(this,null,function*(){if(!t.length)return new n(ve(Vt),e,r);let i=(yield Promise.all(t.map(l=>h(null,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||ve(Vt),o=gt(r,e.config.apiKey,e.name),a=null;for(let l of t)try{let u=yield l._get(o);if(u){let d;if(typeof u=="string"){let f=yield La(e,{idToken:u}).catch(()=>{});if(!f)break;d=yield Lt._fromGetAccountInfoResponse(e,f,u)}else d=Lt._fromJSON(e,u);l!==s&&(a=d),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(l=>h(null,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new n(s,e,r))})}};function O_(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Z_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(J_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ev(e))return"Blackberry";if(tv(e))return"Webos";if(X_(e))return"Safari";if((e.includes("chrome/")||Q_(e))&&!e.includes("edge/"))return"Chrome";if(Hr(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function J_(n=Q()){return/firefox\//i.test(n)}function X_(n=Q()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Q_(n=Q()){return/crios\//i.test(n)}function Z_(n=Q()){return/iemobile/i.test(n)}function Hr(n=Q()){return/android/i.test(n)}function ev(n=Q()){return/blackberry/i.test(n)}function tv(n=Q()){return/webos/i.test(n)}function zr(n=Q()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function nv(n=Q()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function RS(n=Q()){var e;return zr(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function AS(){return wa()&&document.documentMode===10}function rv(n=Q()){return zr(n)||Hr(n)||tv(n)||ev(n)||/windows phone/i.test(n)||Z_(n)}function ph(n,e=[]){let t;switch(n){case"Browser":t=O_(Q());break;case"Worker":t=`${O_(Q())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Xe}/${r}`}var Fd=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return h(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function PS(t){return h(this,arguments,function*(n,e={}){return K(n,"GET","/v2/passwordPolicy",q(n,e))})}var DS=6,Ud=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:DS,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Ua=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Va(this),this.idTokenSubscription=new Va(this),this.beforeStateQueue=new Fd(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=z_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ve(t)),this._initializationPromise=this.queue(()=>h(this,null,function*(){var r,i,s;if(!this._deleted&&(this.persistenceManager=yield Fa.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return h(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return h(this,null,function*(){try{let t=yield La(this,{idToken:e}),r=yield Lt._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return h(this,null,function*(){var t;if($(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return m(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return h(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return h(this,null,function*(){try{yield ws(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=pS()}_delete(){return h(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return h(this,null,function*(){if($(this.app))return Promise.reject(de(this));let t=e?I(e):null;return t&&m(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return h(this,null,function*(){if(!this._deleted)return e&&m(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>h(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return h(this,null,function*(){return $(this.app)?Promise.reject(de(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return $(this.app)?Promise.reject(de(this)):this.queue(()=>h(this,null,function*(){yield this.assertedPersistence.setPersistence(ve(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return h(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return h(this,null,function*(){let e=yield PS(this),t=new Ud(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new We("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return h(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield SS(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return h(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return h(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&ve(e)||this._popupRedirectResolver;m(t,this,"argument-error"),this.redirectPersistenceManager=yield Fa.create(this,[ve(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return h(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>h(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return h(this,null,function*(){if(e===this.currentUser)return this.queue(()=>h(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(m(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return h(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return m(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ph(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return h(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return h(this,null,function*(){var e;if($(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&hS(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function H(n){return I(n)}var Va=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Ca(t=>this.observer=t)}get next(){return m(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Ts={loadJS(){return h(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function OS(n){Ts=n}function mh(n){return Ts.loadJS(n)}function NS(){return Ts.recaptchaV2Script}function MS(){return Ts.recaptchaEnterpriseScript}function kS(){return Ts.gapiScript}function iv(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var xS=500,LS=6e4,Oa=1e12,Vd=class{constructor(e){this.auth=e,this.counter=Oa,this._widgets=new Map}render(e,t){let r=this.counter;return this._widgets.set(r,new Wd(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;let r=e||Oa;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;let r=e||Oa;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}execute(e){return h(this,null,function*(){var t;let r=e||Oa;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""})}},jd=class{constructor(){this.enterprise=new Bd}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},Bd=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},Wd=class{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};let i=typeof e=="string"?document.getElementById(e):e;m(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=FS(50);let{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},LS)},xS))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}};function FS(n){let e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}var US="recaptcha-enterprise",ms="NO_RECAPTCHA",ja=class{constructor(e){this.type=US,this.auth=H(e)}verify(e="verify",t=!1){return h(this,null,function*(){function r(s){return h(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,a)=>h(null,null,function*(){K_(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let l=new xa(c);return s.tenantId==null?s._agentRecaptchaConfig=l:s._tenantRecaptchaConfigs[s.tenantId]=l,o(l.siteKey)}}).catch(c=>{a(c)})}))})}function i(s,o,a){let c=window.grecaptcha;A_(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(l=>{o(l)}).catch(()=>{o(ms)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new jd().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&A_(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=MS();c.length!==0&&(c+=a),mh(c).then(()=>{i(a,s,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})})}};function ds(n,e,t,r=!1,i=!1){return h(this,null,function*(){let s=new ja(n),o;if(i)o=ms;else try{o=yield s.verify(t)}catch{o=yield s.verify(t,!0)}let a=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){let c=a.phoneEnrollmentInfo.phoneNumber,l=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){let c=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a})}function cn(n,e,t,r,i){return h(this,null,function*(){var s,o;if(i==="EMAIL_PASSWORD_PROVIDER")if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let a=yield ds(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(a=>h(null,null,function*(){if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let c=yield ds(n,e,t,t==="getOobCode");return r(n,c)}else return Promise.reject(a)}));else if(i==="PHONE_PROVIDER")if(!((o=n._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("PHONE_PROVIDER")){let a=yield ds(n,e,t);return r(n,a).catch(c=>h(null,null,function*(){var l;if(((l=n._getRecaptchaConfig())===null||l===void 0?void 0:l.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(c.code==="auth/missing-recaptcha-token"||c.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let u=yield ds(n,e,t,!1,!0);return r(n,u)}return Promise.reject(c)}))}else{let a=yield ds(n,e,t,!1,!0);return r(n,a)}else return Promise.reject(i+" provider is not supported.")})}function VS(n){return h(this,null,function*(){let e=H(n),t=yield K_(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new xa(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new ja(e).verify()})}function gh(n,e){let t=xn(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(dt(s,e??{}))return i;Z(i,"already-initialized")}return t.initialize({options:e})}function jS(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(ve);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Rs(n,e,t){let r=H(n);m(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=sv(e),{host:o,port:a}=BS(e),c=a===null?"":`:${a}`,l={url:`${s}//${o}${c}/`},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){m(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),m(dt(l,r.config.emulator)&&dt(u,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=l,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,i||WS(),kr(o)&&ba(`${s}//${o}${c}`)}function sv(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function BS(n){let e=sv(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:N_(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:N_(o)}}}function N_(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function WS(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Qe=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return mt("not implemented")}_getIdTokenResponse(e){return mt("not implemented")}_linkToIdToken(e,t){return mt("not implemented")}_getReauthenticationResolver(e){return mt("not implemented")}};function ov(n,e){return h(this,null,function*(){return K(n,"POST","/v1/accounts:resetPassword",q(n,e))})}function $S(n,e){return h(this,null,function*(){return K(n,"POST","/v1/accounts:update",e)})}function HS(n,e){return h(this,null,function*(){return K(n,"POST","/v1/accounts:signUp",e)})}function zS(n,e){return h(this,null,function*(){return K(n,"POST","/v1/accounts:update",q(n,e))})}function GS(n,e){return h(this,null,function*(){return Bt(n,"POST","/v1/accounts:signInWithPassword",q(n,e))})}function Ja(n,e){return h(this,null,function*(){return K(n,"POST","/v1/accounts:sendOobCode",q(n,e))})}function qS(n,e){return h(this,null,function*(){return Ja(n,e)})}function KS(n,e){return h(this,null,function*(){return Ja(n,e)})}function YS(n,e){return h(this,null,function*(){return Ja(n,e)})}function JS(n,e){return h(this,null,function*(){return Ja(n,e)})}function XS(n,e){return h(this,null,function*(){return Bt(n,"POST","/v1/accounts:signInWithEmailLink",q(n,e))})}function QS(n,e){return h(this,null,function*(){return Bt(n,"POST","/v1/accounts:signInWithEmailLink",q(n,e))})}var Vr=class n extends Qe{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return h(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return cn(e,t,"signInWithPassword",GS,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return XS(e,{email:this._email,oobCode:this._password});default:Z(e,"internal-error")}})}_linkToIdToken(e,t){return h(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return cn(e,r,"signUpPassword",HS,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return QS(e,{idToken:t,email:this._email,oobCode:this._password});default:Z(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Ft(n,e){return h(this,null,function*(){return Bt(n,"POST","/v1/accounts:signInWithIdp",q(n,e))})}var ZS="http://localhost",ze=class n extends Qe{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Z("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=uo(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return Ft(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Ft(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Ft(e,t)}buildRequest(){let e={requestUri:ZS,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=kt(t)}return e}};function M_(n,e){return h(this,null,function*(){return K(n,"POST","/v1/accounts:sendVerificationCode",q(n,e))})}function eT(n,e){return h(this,null,function*(){return Bt(n,"POST","/v1/accounts:signInWithPhoneNumber",q(n,e))})}function tT(n,e){return h(this,null,function*(){let t=yield Bt(n,"POST","/v1/accounts:signInWithPhoneNumber",q(n,e));if(t.temporaryProof)throw hs(n,"account-exists-with-different-credential",t);return t})}var nT={USER_NOT_FOUND:"user-not-found"};function rT(n,e){return h(this,null,function*(){let t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Bt(n,"POST","/v1/accounts:signInWithPhoneNumber",q(n,t),nT)})}var Fn=class n extends Qe{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new n({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new n({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return eT(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return tT(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return rT(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new n({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function iT(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function sT(n){let e=sn(Mr(n)).link,t=e?sn(Mr(e)).deep_link_id:null,r=sn(Mr(n)).deep_link_id;return(r?sn(Mr(r)).link:null)||r||t||e||n}var jr=class n{constructor(e){var t,r,i,s,o,a;let c=sn(Mr(e)),l=(t=c.apiKey)!==null&&t!==void 0?t:null,u=(r=c.oobCode)!==null&&r!==void 0?r:null,d=iT((i=c.mode)!==null&&i!==void 0?i:null);m(l&&u&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=u,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.lang)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=sT(e);try{return new n(t)}catch{return null}}};var Gr=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Vr._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=jr.parseLink(r);return m(i,"argument-error"),Vr._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Ze=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var un=class extends Ze{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}},Un=class n extends un{static credentialFromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;return m("providerId"in t&&"signInMethod"in t,"argument-error"),ze._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return m(e.idToken||e.accessToken,"argument-error"),ze._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return n.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!t&&!s||!a)return null;try{return new n(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}};var As=(()=>{class n extends un{constructor(){super("facebook.com")}static credential(t){return ze._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.FACEBOOK_SIGN_IN_METHOD="facebook.com",n.PROVIDER_ID="facebook.com";return n})(),Ps=(()=>{class n extends un{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return ze._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})(),Ds=(()=>{class n extends un{constructor(){super("github.com")}static credential(t){return ze._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch{return null}}}n.GITHUB_SIGN_IN_METHOD="github.com",n.PROVIDER_ID="github.com";return n})(),oT="http://localhost",Vn=class n extends Qe{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){let t=this.buildRequest();return Ft(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Ft(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Ft(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new n(r,s)}static _create(e,t){return new n(e,t)}buildRequest(){return{requestUri:oT,returnSecureToken:!0,pendingToken:this.pendingToken}}};var aT="saml.",Br=class n extends Ze{constructor(e){m(e.startsWith(aT),"argument-error"),super(e)}static credentialFromResult(e){return n.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return n.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=Vn.fromJSON(e);return m(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Vn._create(r,t)}catch{return null}}};var Os=(()=>{class n extends un{constructor(){super("twitter.com")}static credential(t,r){return ze._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthAccessToken:r,oauthTokenSecret:i}=t;if(!r||!i)return null;try{return n.credential(r,i)}catch{return null}}}n.TWITTER_SIGN_IN_METHOD="twitter.com",n.PROVIDER_ID="twitter.com";return n})();function av(n,e){return h(this,null,function*(){return Bt(n,"POST","/v1/accounts:signUp",q(n,e))})}var et=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return h(this,null,function*(){let s=yield Lt._fromIdTokenResponse(e,r,i),o=k_(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return h(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=k_(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function k_(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}function Xa(n){return h(this,null,function*(){var e;if($(n.app))return Promise.reject(de(n));let t=H(n);if(yield t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new et({user:t.currentUser,providerId:null,operationType:"signIn"});let r=yield av(t,{returnSecureToken:!0}),i=yield et._fromIdTokenResponse(t,"signIn",r,!0);return yield t._updateCurrentUser(i.user),i})}var $d=class n extends le{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function cv(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?$d._fromErrorAndOperation(n,s,e,r):s})}function lv(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}function Qa(n,e){return h(this,null,function*(){let t=I(n);yield Za(!0,t,e);let{providerUserInfo:r}=yield wS(t.auth,{idToken:yield t.getIdToken(),deleteProvider:[e]}),i=lv(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),yield t.auth._persistUserIfCurrent(t),t})}function _h(n,e,t=!1){return h(this,null,function*(){let r=yield Ut(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return et._forOperation(n,"link",r)})}function Za(n,e,t){return h(this,null,function*(){yield ws(e);let r=lv(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";m(r.has(t)===n,e.auth,i)})}function uv(n,e,t=!1){return h(this,null,function*(){let{auth:r}=n;if($(r.app))return Promise.reject(de(r));let i="reauthenticate";try{let s=yield Ut(n,cv(r,i,e,n),t);m(s.idToken,r,"internal-error");let o=Ya(s.idToken);m(o,r,"internal-error");let{sub:a}=o;return m(n.uid===a,r,"user-mismatch"),et._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Z(r,"user-mismatch"),s}})}function dv(n,e,t=!1){return h(this,null,function*(){if($(n.app))return Promise.reject(de(n));let r="signIn",i=yield cv(n,r,e),s=yield et._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function Wn(n,e){return h(this,null,function*(){return dv(H(n),e)})}function Ns(n,e){return h(this,null,function*(){let t=I(n);return yield Za(!1,t,e.providerId),_h(t,e)})}function Ms(n,e){return h(this,null,function*(){return uv(I(n),e)})}function cT(n,e){return h(this,null,function*(){return Bt(n,"POST","/v1/accounts:signInWithCustomToken",q(n,e))})}function ec(n,e){return h(this,null,function*(){if($(n.app))return Promise.reject(de(n));let t=H(n),r=yield cT(t,{token:e,returnSecureToken:!0}),i=yield et._fromIdTokenResponse(t,"signIn",r);return yield t._updateCurrentUser(i.user),i})}var jn=class{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Hd._fromServerResponse(e,t):"totpInfo"in t?zd._fromServerResponse(e,t):Z(e,"internal-error")}},Hd=class n extends jn{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new n(t)}},zd=class n extends jn{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new n(t)}};function tc(n,e,t){var r;m(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),m(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),m(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(m(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(m(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function vh(n){return h(this,null,function*(){let e=H(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function nc(n,e,t){return h(this,null,function*(){let r=H(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&tc(r,i,t),yield cn(r,i,"getOobCode",KS,"EMAIL_PASSWORD_PROVIDER")})}function rc(n,e,t){return h(this,null,function*(){yield ov(I(n),{oobCode:e,newPassword:t}).catch(r=>h(null,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&vh(n),r}))})}function ic(n,e){return h(this,null,function*(){yield zS(I(n),{oobCode:e})})}function ks(n,e){return h(this,null,function*(){let t=I(n),r=yield ov(t,{oobCode:e}),i=r.requestType;switch(m(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":m(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":m(r.mfaInfo,t,"internal-error");default:m(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=jn._fromServerResponse(H(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}})}function sc(n,e){return h(this,null,function*(){let{data:t}=yield ks(I(n),e);return t.email})}function oc(n,e,t){return h(this,null,function*(){if($(n.app))return Promise.reject(de(n));let r=H(n),o=yield cn(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",av,"EMAIL_PASSWORD_PROVIDER").catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&vh(n),c}),a=yield et._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(a.user),a})}function qr(n,e,t){return $(n.app)?Promise.reject(de(n)):Wn(I(n),Gr.credential(e,t)).catch(r=>h(null,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&vh(n),r}))}function ac(n,e,t){return h(this,null,function*(){let r=H(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,a){m(a.handleCodeInApp,r,"argument-error"),a&&tc(r,o,a)}s(i,t),yield cn(r,i,"getOobCode",YS,"EMAIL_PASSWORD_PROVIDER")})}function cc(n,e){let t=jr.parseLink(e);return t?.operation==="EMAIL_SIGNIN"}function lc(n,e,t){return h(this,null,function*(){if($(n.app))return Promise.reject(de(n));let r=I(n),i=Gr.credentialWithLink(e,t||vs());return m(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Wn(r,i)})}function lT(n,e){return h(this,null,function*(){return K(n,"POST","/v1/accounts:createAuthUri",q(n,e))})}function uc(n,e){return h(this,null,function*(){let t=uh()?vs():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=yield lT(I(n),r);return i||[]})}function dc(n,e){return h(this,null,function*(){let t=I(n),i={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};e&&tc(t.auth,i,e);let{email:s}=yield qS(t.auth,i);s!==n.email&&(yield n.reload())})}function hc(n,e,t){return h(this,null,function*(){let r=I(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield n.getIdToken(),newEmail:e};t&&tc(r.auth,s,t);let{email:o}=yield JS(r.auth,s);o!==n.email&&(yield n.reload())})}function uT(n,e){return h(this,null,function*(){return K(n,"POST","/v1/accounts:update",e)})}function fc(r,i){return h(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=I(n),a={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=yield Ut(s,uT(s.auth,a));s.displayName=c.displayName||null,s.photoURL=c.photoUrl||null;let l=s.providerData.find(({providerId:u})=>u==="password");l&&(l.displayName=s.displayName,l.photoURL=s.photoURL),yield s._updateTokensIfNecessary(c)})}function pc(n,e){let t=I(n);return $(t.auth.app)?Promise.reject(de(t.auth)):hv(t,e,null)}function mc(n,e){return hv(I(n),null,e)}function hv(n,e,t){return h(this,null,function*(){let{auth:r}=n,s={idToken:yield n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);let o=yield Ut(n,$S(r,s));yield n._updateTokensIfNecessary(o,!0)})}function dT(n){var e,t;if(!n)return null;let{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&n?.idToken){let o=(t=(e=Ya(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){let a=o!=="anonymous"&&o!=="custom"?o:null;return new ln(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new Gd(s,i);case"github.com":return new qd(s,i);case"google.com":return new Kd(s,i);case"twitter.com":return new Yd(s,i,n.screenName||null);case"custom":case"anonymous":return new ln(s,null);default:return new ln(s,r,i)}}var ln=class{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}},Ba=class extends ln{constructor(e,t,r,i){super(e,t,r),this.username=i}},Gd=class extends ln{constructor(e,t){super(e,"facebook.com",t)}},qd=class extends Ba{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}},Kd=class extends ln{constructor(e,t){super(e,"google.com",t)}},Yd=class extends Ba{constructor(e,t,r){super(e,"twitter.com",t,r)}};function gc(n){let{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:dT(t)}function _c(n,e){return I(n).setPersistence(e)}function yh(n,e,t,r){return I(n).onIdTokenChanged(e,t,r)}function Eh(n,e,t){return I(n).beforeAuthStateChanged(e,t)}function Kr(n,e,t,r){return I(n).onAuthStateChanged(e,t,r)}function vc(n){return I(n).signOut()}var Wa=class n{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new n("enroll",e,t)}static _fromMfaPendingCredential(e){return new n("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e?.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return n._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return n._fromIdtoken(e.multiFactorSession.idToken)}return null}};var Jd=class n{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){let r=H(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>jn._fromServerResponse(r,a));m(i.mfaPendingCredential,r,"internal-error");let o=Wa._fromMfaPendingCredential(i.mfaPendingCredential);return new n(o,s,a=>h(null,null,function*(){let c=yield a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;let l=Object.assign(Object.assign({},i),{idToken:c.idToken,refreshToken:c.refreshToken});switch(t.operationType){case"signIn":let u=yield et._fromIdTokenResponse(r,t.operationType,l);return yield r._updateCurrentUser(u.user),u;case"reauthenticate":return m(t.user,r,"internal-error"),et._forOperation(t.user,t.operationType,l);default:Z(r,"internal-error")}}))}resolveSignIn(e){return h(this,null,function*(){let t=e;return this.signInResolver(t)})}};function yc(n,e){var t;let r=I(n),i=e;return m(e.customData.operationType,r,"argument-error"),m((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),Jd._fromError(r,i)}function x_(n,e){return K(n,"POST","/v2/accounts/mfaEnrollment:start",q(n,e))}function hT(n,e){return K(n,"POST","/v2/accounts/mfaEnrollment:finalize",q(n,e))}function fT(n,e){return K(n,"POST","/v2/accounts/mfaEnrollment:withdraw",q(n,e))}var Xd=class n{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>jn._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new n(e)}getSession(){return h(this,null,function*(){return Wa._fromIdtoken(yield this.user.getIdToken(),this.user)})}enroll(e,t){return h(this,null,function*(){let r=e,i=yield this.getSession(),s=yield Ut(this.user,r._process(this.user.auth,i,t));return yield this.user._updateTokensIfNecessary(s),this.user.reload()})}unenroll(e){return h(this,null,function*(){let t=typeof e=="string"?e:e.uid,r=yield this.user.getIdToken();try{let i=yield Ut(this.user,fT(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),yield this.user._updateTokensIfNecessary(i),yield this.user.reload()}catch(i){throw i}})}},Od=new WeakMap;function Ec(n){let e=I(n);return Od.has(e)||Od.set(e,Xd._fromUser(e)),Od.get(e)}var $a="__sak";var Ha=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem($a,"1"),this.storage.removeItem($a),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var pT=1e3,mT=10,gT=(()=>{class n extends Ha{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rv(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);AS()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,mT):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},pT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return h(this,null,function*(){yield vn(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return h(this,null,function*(){let r=yield vn(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return h(this,null,function*(){yield vn(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),_t=gT;var _T=(()=>{class n extends Ha{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Te=_T;function vT(n){return Promise.all(n.map(e=>h(null,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var yT=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return h(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(u=>h(this,null,function*(){return u(r.origin,o)})),l=yield vT(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function $n(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Qd=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return h(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=$n("",20);i.port1.start();let u=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(d){let f=d;if(f.data.eventId===l)switch(f.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(f.data.response);break;default:clearTimeout(u),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function ne(){return window}function ET(n){ne().location.href=n}function wh(){return typeof ne().WorkerGlobalScope<"u"&&typeof ne().importScripts=="function"}function wT(){return h(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function CT(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function IT(){return wh()?self:null}var fv="firebaseLocalStorageDb",bT=1,za="firebaseLocalStorage",pv="fbase_key",Bn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function wc(n,e){return n.transaction([za],e?"readwrite":"readonly").objectStore(za)}function ST(){let n=indexedDB.deleteDatabase(fv);return new Bn(n).toPromise()}function Zd(){let n=indexedDB.open(fv,bT);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(za,{keyPath:pv})}catch(i){t(i)}}),n.addEventListener("success",()=>h(null,null,function*(){let r=n.result;r.objectStoreNames.contains(za)?e(r):(r.close(),yield ST(),e(yield Zd()))}))})}function L_(n,e,t){return h(this,null,function*(){let r=wc(n,!0).put({[pv]:e,value:t});return new Bn(r).toPromise()})}function TT(n,e){return h(this,null,function*(){let t=wc(n,!1).get(e),r=yield new Bn(t).toPromise();return r===void 0?null:r.value})}function F_(n,e){let t=wc(n,!0).delete(e);return new Bn(t).toPromise()}var RT=800,AT=3,PT=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return h(this,null,function*(){return this.db?this.db:(this.db=yield Zd(),this.db)})}_withRetries(t){return h(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>AT)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return h(this,null,function*(){return wh()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return h(this,null,function*(){this.receiver=yT._getInstance(IT()),this.receiver._subscribe("keyChanged",(t,r)=>h(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>h(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return h(this,null,function*(){var t,r;if(this.activeServiceWorker=yield wT(),!this.activeServiceWorker)return;this.sender=new Qd(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return h(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||CT()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return h(this,null,function*(){try{if(!indexedDB)return!1;let t=yield Zd();return yield L_(t,$a,"1"),yield F_(t,$a),!0}catch{}return!1})}_withPendingWrite(t){return h(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return h(this,null,function*(){return this._withPendingWrite(()=>h(this,null,function*(){return yield this._withRetries(i=>L_(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return h(this,null,function*(){let r=yield this._withRetries(i=>TT(i,t));return this.localCache[t]=r,r})}_remove(t){return h(this,null,function*(){return this._withPendingWrite(()=>h(this,null,function*(){return yield this._withRetries(r=>F_(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return h(this,null,function*(){let t=yield this._withRetries(s=>{let o=wc(s,!1).getAll();return new Bn(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>h(this,null,function*(){return this._poll()}),RT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Wt=PT;function U_(n,e){return K(n,"POST","/v2/accounts/mfaSignIn:start",q(n,e))}function DT(n,e){return K(n,"POST","/v2/accounts/mfaSignIn:finalize",q(n,e))}var Nd=iv("rcb"),OT=new Ln(3e4,6e4),eh=class{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=ne().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return m(NT(t),e,"argument-error"),this.shouldResolveImmediately(t)&&R_(ne().grecaptcha)?Promise.resolve(ne().grecaptcha):new Promise((r,i)=>{let s=ne().setTimeout(()=>{i(re(e,"network-request-failed"))},OT.get());ne()[Nd]=()=>{ne().clearTimeout(s),delete ne()[Nd];let a=ne().grecaptcha;if(!a||!R_(a)){i(re(e,"internal-error"));return}let c=a.render;a.render=(l,u)=>{let d=c(l,u);return this.counter++,d},this.hostLanguage=t,r(a)};let o=`${NS()}?${kt({onload:Nd,render:"explicit",hl:t})}`;mh(o).catch(()=>{clearTimeout(s),i(re(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=ne().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}};function NT(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}var th=class{load(e){return h(this,null,function*(){return new Vd(e)})}clearedOneInstance(){}};var gs="recaptcha",MT={theme:"light",type:"image"},Wr=class{constructor(e,t,r=Object.assign({},MT)){this.parameters=r,this.type=gs,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=H(e),this.isInvisible=this.parameters.size==="invisible",m(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");let i=typeof t=="string"?document.getElementById(t):t;m(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new th:new eh,this.validateStartingState()}verify(){return h(this,null,function*(){this.assertNotDestroyed();let e=yield this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{let s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){m(!this.parameters.sitekey,this.auth,"argument-error"),m(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),m(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){let r=ne()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){m(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){return h(this,null,function*(){if(yield this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){let t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId})}init(){return h(this,null,function*(){m(uh()&&!wh(),this.auth,"internal-error"),yield kT(),this.recaptcha=yield this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);let e=yield yS(this.auth);m(e,this.auth,"internal-error"),this.parameters.sitekey=e})}getAssertedRecaptcha(){return m(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function kT(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}var Cs=class{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){let t=Fn._fromVerification(this.verificationId,e);return this.onConfirmation(t)}};function Cc(n,e,t){return h(this,null,function*(){if($(n.app))return Promise.reject(de(n));let r=H(n),i=yield Sc(r,e,I(t));return new Cs(i,s=>Wn(r,s))})}function Ic(n,e,t){return h(this,null,function*(){let r=I(n);yield Za(!1,r,"phone");let i=yield Sc(r.auth,e,I(t));return new Cs(i,s=>Ns(r,s))})}function bc(n,e,t){return h(this,null,function*(){let r=I(n);if($(r.auth.app))return Promise.reject(de(r.auth));let i=yield Sc(r.auth,e,I(t));return new Cs(i,s=>Ms(r,s))})}function Sc(n,e,t){return h(this,null,function*(){var r;if(!n._getRecaptchaConfig())try{yield VS(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){let s=i.session;if("phoneNumber"in i){m(s.type==="enroll",n,"internal-error");let o={idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(yield cn(n,o,"mfaSmsEnrollment",(u,d)=>h(null,null,function*(){if(d.phoneEnrollmentInfo.captchaResponse===ms){m(t?.type===gs,u,"argument-error");let f=yield Md(u,d,t);return x_(u,f)}return x_(u,d)}),"PHONE_PROVIDER").catch(u=>Promise.reject(u))).phoneSessionInfo.sessionInfo}else{m(s.type==="signin",n,"internal-error");let o=((r=i.multiFactorHint)===null||r===void 0?void 0:r.uid)||i.multiFactorUid;m(o,n,"missing-multi-factor-info");let a={mfaPendingCredential:s.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(yield cn(n,a,"mfaSmsSignIn",(d,f)=>h(null,null,function*(){if(f.phoneSignInInfo.captchaResponse===ms){m(t?.type===gs,d,"argument-error");let p=yield Md(d,f,t);return U_(d,p)}return U_(d,f)}),"PHONE_PROVIDER").catch(d=>Promise.reject(d))).phoneResponseInfo.sessionInfo}}else{let s={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(yield cn(n,s,"sendVerificationCode",(l,u)=>h(null,null,function*(){if(u.captchaResponse===ms){m(t?.type===gs,l,"argument-error");let d=yield Md(l,u,t);return M_(l,d)}return M_(l,u)}),"PHONE_PROVIDER").catch(l=>Promise.reject(l))).sessionInfo}}finally{t?._reset()}})}function Tc(n,e){return h(this,null,function*(){let t=I(n);if($(t.auth.app))return Promise.reject(de(t.auth));yield _h(t,e)})}function Md(n,e,t){return h(this,null,function*(){m(t.type===gs,n,"argument-error");let r=yield t.verify();m(typeof r=="string",n,"argument-error");let i=Object.assign({},e);if("phoneEnrollmentInfo"in i){let s=i.phoneEnrollmentInfo.phoneNumber,o=i.phoneEnrollmentInfo.captchaResponse,a=i.phoneEnrollmentInfo.clientType,c=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:s,recaptchaToken:r,captchaResponse:o,clientType:a,recaptchaVersion:c}}),i}else if("phoneSignInInfo"in i){let s=i.phoneSignInInfo.captchaResponse,o=i.phoneSignInInfo.clientType,a=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:s,clientType:o,recaptchaVersion:a}}),i}else return Object.assign(i,{recaptchaToken:r}),i})}var hn=(()=>{class n{constructor(t){this.providerId=n.PROVIDER_ID,this.auth=H(t)}verifyPhoneNumber(t,r){return Sc(this.auth,t,I(r))}static credential(t,r){return Fn._fromVerification(t,r)}static credentialFromResult(t){let r=t;return n.credentialFromTaggedObject(r)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{phoneNumber:r,temporaryProof:i}=t;return r&&i?Fn._fromTokenResponse(r,i):null}}n.PROVIDER_ID="phone",n.PHONE_SIGN_IN_METHOD="phone";return n})();function Hn(n,e){return e?ve(e):(m(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Is=class extends Qe{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ft(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ft(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ft(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function xT(n){return dv(n.auth,new Is(n),n.bypassAuthState)}function LT(n){let{auth:e,user:t}=n;return m(t,e,"internal-error"),uv(t,new Is(n),n.bypassAuthState)}function FT(n){return h(this,null,function*(){let{auth:e,user:t}=n;return m(t,e,"internal-error"),_h(t,new Is(n),n.bypassAuthState)})}var Ga=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>h(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return h(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return xT;case"linkViaPopup":case"linkViaRedirect":return FT;case"reauthViaPopup":case"reauthViaRedirect":return LT;default:Z(this.auth,"internal-error")}}resolve(e){He(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){He(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var UT=new Ln(2e3,1e4);function Rc(n,e,t){return h(this,null,function*(){if($(n.app))return Promise.reject(re(n,"operation-not-supported-in-this-environment"));let r=H(n);$r(n,e,Ze);let i=Hn(r,t);return new Ch(r,"signInViaPopup",e,i).executeNotNull()})}function Ac(n,e,t){return h(this,null,function*(){let r=I(n);if($(r.auth.app))return Promise.reject(re(r.auth,"operation-not-supported-in-this-environment"));$r(r.auth,e,Ze);let i=Hn(r.auth,t);return new Ch(r.auth,"reauthViaPopup",e,i,r).executeNotNull()})}function Pc(n,e,t){return h(this,null,function*(){let r=I(n);$r(r.auth,e,Ze);let i=Hn(r.auth,t);return new Ch(r.auth,"linkViaPopup",e,i,r).executeNotNull()})}var Ch=(()=>{class n extends Ga{constructor(t,r,i,s,o){super(t,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return h(this,null,function*(){let t=yield this.execute();return m(t,this.auth,"internal-error"),t})}onExecution(){return h(this,null,function*(){He(this.filter.length===1,"Popup operations only handle one event");let t=$n();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(re(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(re(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(re(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,UT.get())};t()}}n.currentPopupAction=null;return n})(),VT="pendingRedirect",_s=new Map,nh=class n extends Ga{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return h(this,null,function*(){let e=_s.get(this.auth._key());if(!e){try{let r=(yield jT(this.resolver,this.auth))?yield vn(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}_s.set(this.auth._key(),e)}return this.bypassAuthState||_s.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return h(this,null,function*(){if(e.type==="signInViaRedirect")return vn(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,vn(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return h(this,null,function*(){})}cleanUp(){}};function jT(n,e){return h(this,null,function*(){let t=_v(e),r=gv(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function Ih(n,e){return h(this,null,function*(){return gv(n)._set(_v(e),"true")})}function mv(){_s.clear()}function Yr(n,e){_s.set(n._key(),e)}function gv(n){return ve(n._redirectPersistence)}function _v(n){return gt(VT,n.config.apiKey,n.name)}function Dc(n,e,t){return BT(n,e,t)}function BT(n,e,t){return h(this,null,function*(){if($(n.app))return Promise.reject(de(n));let r=H(n);$r(n,e,Ze),yield r._initializationPromise;let i=Hn(r,t);return yield Ih(i,r),i._openRedirect(r,e,"signInViaRedirect")})}function Oc(n,e,t){return WT(n,e,t)}function WT(n,e,t){return h(this,null,function*(){let r=I(n);if($r(r.auth,e,Ze),$(r.auth.app))return Promise.reject(de(r.auth));yield r.auth._initializationPromise;let i=Hn(r.auth,t);yield Ih(i,r.auth);let s=yield vv(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)})}function Nc(n,e,t){return $T(n,e,t)}function $T(n,e,t){return h(this,null,function*(){let r=I(n);$r(r.auth,e,Ze),yield r.auth._initializationPromise;let i=Hn(r.auth,t);yield Za(!1,r,e.providerId),yield Ih(i,r.auth);let s=yield vv(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)})}function Mc(n,e){return h(this,null,function*(){return yield H(n)._initializationPromise,zn(n,e,!1)})}function zn(n,e,t=!1){return h(this,null,function*(){if($(n.app))return Promise.reject(de(n));let r=H(n),i=Hn(r,e),o=yield new nh(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}function vv(n){return h(this,null,function*(){let e=$n(`${n.uid}:::`);return n._redirectEventId=e,yield n.auth._setRedirectUser(n),yield n.auth._persistUserIfCurrent(n),e})}var HT=10*60*1e3,bs=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!zT(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!yv(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(re(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=HT&&this.cachedEventUids.clear(),this.cachedEventUids.has(V_(e))}saveEventToCache(e){this.cachedEventUids.add(V_(e)),this.lastProcessedEventTime=Date.now()}};function V_(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function yv({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function zT(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yv(n);default:return!1}}function bh(t){return h(this,arguments,function*(n,e={}){return K(n,"GET","/v1/projects",e)})}var GT=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,qT=/^https?/;function KT(n){return h(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield bh(n);for(let t of e)try{if(YT(t))return}catch{}Z(n,"unauthorized-domain")})}function YT(n){let e=vs(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!qT.test(t))return!1;if(GT.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var JT=new Ln(3e4,6e4);function j_(){let n=ne().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function XT(n){return new Promise((e,t)=>{var r,i,s;function o(){j_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{j_(),t(re(n,"network-request-failed"))},timeout:JT.get()})}if(!((i=(r=ne().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ne().gapi)===null||s===void 0)&&s.load)o();else{let a=iv("iframefcb");return ne()[a]=()=>{gapi.load?o():t(re(n,"network-request-failed"))},mh(`${kS()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Ma=null,e})}var Ma=null;function QT(n){return Ma=Ma||XT(n),Ma}var ZT=new Ln(5e3,15e3),eR="__/auth/iframe",tR="emulator/auth/iframe",nR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},rR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function iR(n){let e=n.config;m(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?dh(e,tR):`https://${n.config.authDomain}/${eR}`,r={apiKey:e.apiKey,appName:n.name,v:Xe},i=rR.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${kt(r).slice(1)}`}function sR(n){return h(this,null,function*(){let e=yield QT(n),t=ne().gapi;return m(t,n,"internal-error"),e.open({where:document.body,url:iR(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:nR,dontclear:!0},r=>new Promise((i,s)=>h(null,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=re(n,"network-request-failed"),a=ne().setTimeout(()=>{s(o)},ZT.get());function c(){ne().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var oR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},aR=500,cR=600,lR="_blank",uR="http://localhost",Ss=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function dR(n,e,t,r=aR,i=cR){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},oR),{width:r.toString(),height:i.toString(),top:s,left:o}),l=Q().toLowerCase();t&&(a=Q_(l)?lR:t),J_(l)&&(e=e||uR,c.scrollbars="yes");let u=Object.entries(c).reduce((f,[p,_])=>`${f}${p}=${_},`,"");if(RS(l)&&a!=="_self")return hR(e||"",a),new Ss(null);let d=window.open(e||"",a,u);m(d,n,"popup-blocked");try{d.focus()}catch{}return new Ss(d)}function hR(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var fR="__/auth/handler",pR="emulator/auth/handler",mR=encodeURIComponent("fac");function qa(n,e,t,r,i,s){return h(this,null,function*(){m(n.config.authDomain,n,"auth-domain-config-required"),m(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Xe,eventId:i};if(e instanceof Ze){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",os(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[u,d]of Object.entries(s||{}))o[u]=d}if(e instanceof un){let u=e.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let u of Object.keys(a))a[u]===void 0&&delete a[u];let c=yield n._getAppCheckToken(),l=c?`#${mR}=${encodeURIComponent(c)}`:"";return`${gR(n)}?${kt(a).slice(1)}${l}`})}function gR({config:n}){return n.emulator?dh(n,pR):`https://${n.authDomain}/${fR}`}var kd="webStorageSupport",rh=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Te,this._completeRedirectFn=zn,this._overrideRedirectResult=Yr}_openPopup(e,t,r,i){return h(this,null,function*(){var s;He((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield qa(e,t,r,vs(),i);return dR(e,o,$n())})}_openRedirect(e,t,r,i){return h(this,null,function*(){yield this._originValidation(e);let s=yield qa(e,t,r,vs(),i);return ET(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(He(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return h(this,null,function*(){let t=yield sR(e),r=new bs(e);return t.register("authEvent",i=>(m(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(kd,{type:kd},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[kd];o!==void 0&&t(!!o),Z(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=KT(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return rv()||X_()||zr()}},xs=rh,ih=class{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return mt("unexpected MultiFactorSessionType")}}},sh=class n extends ih{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new n(e)}_finalizeEnroll(e,t,r){return hT(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return DT(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},kc=(()=>{class n{constructor(){}static assertion(t){return sh._fromCredential(t)}}return n.FACTOR_ID="phone",n})();var B_="@firebase/auth",W_="1.10.2";var oh=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return h(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){m(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function _R(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function vR(n){Je(new _e("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;m(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ph(n)},l=new Ua(r,i,s,c);return jS(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Je(new _e("auth-internal",e=>{let t=H(e.getProvider("auth").getImmediate());return(r=>new oh(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ue(B_,W_,_R(n)),ue(B_,W_,"esm2017")}var yR=5*60,ER=dd("authIdTokenMaxAge")||yR,$_=null,wR=n=>e=>h(null,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>ER)return;let i=t?.token;$_!==i&&($_=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function vt(n=us()){let e=xn(n,"auth");if(e.isInitialized())return e.getImmediate();let t=gh(n,{popupRedirectResolver:xs,persistence:[Wt,_t,Te]}),r=dd("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=wR(s.toString());Eh(t,o,()=>o(t.currentUser)),yh(t,a=>o(a))}}let i=ld("auth");return i&&Rs(t,`http://${i}`),t}function CR(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}OS({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=re("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",CR().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});vR("Browser");var Sh=class{constructor(e,t){this._delegate=e,this.firebase=t,Ur(e,new _e("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Da(this._delegate)))}_getService(e,t=pt){var r;this._delegate.checkDestroyed();let i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=pt){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Ur(this._delegate,e)}_addOrOverwriteComponent(e){Td(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var UR={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},Ev=new We("app-compat","Firebase",UR);function VR(n){let e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:ue,setLogLevel:Ad,onLog:Rd,apps:null,SDK_VERSION:Xe,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:Pd}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(l){delete e[l]}function i(l){if(l=l||pt,!ke(e,l))throw Ev.create("no-app",{appName:l});return e[l]}i.App=n;function s(l,u={}){let d=Pa(l,u);if(ke(e,d.name))return e[d.name];let f=new n(d,t);return e[d.name]=f,f}function o(){return Object.keys(e).map(l=>e[l])}function a(l){let u=l.name,d=u.replace("-compat","");if(Je(l)&&l.type==="PUBLIC"){let f=(p=i())=>{if(typeof p[d]!="function")throw Ev.create("invalid-app-argument",{appName:u});return p[d]()};l.serviceProps!==void 0&&Or(f,l.serviceProps),t[d]=f,n.prototype[d]=function(...p){return this._getService.bind(this,u).apply(this,l.multipleInstances?p:[])}}return l.type==="PUBLIC"?t[d]:null}function c(l,u){return u==="serverAuth"?null:u}return t}function Cv(){let n=VR(Sh);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:Cv,extendNamespace:e,createSubscribe:Ca,ErrorFactory:We,deepExtend:Or});function e(t){Or(n,t)}return n}var jR=Cv();var wv=new ht("@firebase/app-compat"),BR="@firebase/app-compat",WR="0.3.1";function $R(n){ue(BR,WR,n)}try{let n=cd();if(n.firebase!==void 0){wv.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);let e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&wv.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}var yt=jR;$R();var HR="firebase",zR="11.7.1";yt.registerVersion(HR,zR,"app-compat");var Iv="@firebase/database",bv="1.0.15";var Rf="";function GR(n){Rf=n}var Mh=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),te(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Dr(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var kh=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return ke(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var ry=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Mh(e)}}catch{}return new kh},qn=ry("localStorage"),xh=ry("sessionStorage");var Qr=new ht("@firebase/database"),qR=function(){let n=1;return function(){return n++}}(),iy=function(n){let e=a_(n),t=new _a;t.update(e);let r=t.digest();return va.encodeByteArray(r)},Zs=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Zs.apply(null,r):typeof r=="object"?e+=te(r):e+=r,e+=" "}return e},Yn=null,Sv=!0,KR=function(n,e){g(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Qr.logLevel=V.VERBOSE,Yn=Qr.log.bind(Qr),e&&xh.set("logging_enabled",!0)):typeof n=="function"?Yn=n:(Yn=null,xh.remove("logging_enabled"))},ye=function(...n){if(Sv===!0&&(Sv=!1,Yn===null&&xh.get("logging_enabled")===!0&&KR(!0)),Yn){let e=Zs.apply(null,n);Yn(e)}},eo=function(n){return function(...e){ye(n,...e)}},Lh=function(...n){let e="FIREBASE INTERNAL ERROR: "+Zs(...n);Qr.error(e)},$t=function(...n){let e=`FIREBASE FATAL ERROR: ${Zs(...n)}`;throw Qr.error(e),new Error(e)},Re=function(...n){let e="FIREBASE WARNING: "+Zs(...n);Qr.warn(e)},YR=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Re("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},sy=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},JR=function(n){if(ut()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},ei="[MIN_NAME]",Jn="[MAX_NAME]",ai=function(n,e){if(n===e)return 0;if(n===ei||e===Jn)return-1;if(e===ei||n===Jn)return 1;{let t=Tv(n),r=Tv(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},XR=function(n,e){return n===e?0:n<e?-1:1},Ls=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+te(e))},Af=function(n){if(typeof n!="object"||n===null)return te(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=te(e[r]),t+=":",t+=Af(n[e[r]]);return t+="}",t},oy=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function Ae(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var ay=function(n){g(!sy(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let l=[];for(c=t;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let u=l.join(""),d="";for(c=0;c<64;c+=8){let f=parseInt(u.substr(c,8),2).toString(16);f.length===1&&(f="0"+f),d=d+f}return d.toLowerCase()},QR=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},ZR=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function eA(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var tA=new RegExp("^-?(0*)\\d{1,10}$"),nA=-2147483648,rA=2147483647,Tv=function(n){if(tA.test(n)){let e=Number(n);if(e>=nA&&e<=rA)return e}return null},ci=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw Re("Exception was thrown by user callback.",t),e},Math.floor(0))}},iA=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Bs=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var Fh=class{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,$(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Re(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}};var Uh=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(ye("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Re(e)}},Ws=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),Lc="5",cy="v",ly="s",uy="r",dy="f",hy=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,fy="ls",py="p",Vh="ac",my="websocket",gy="long_polling";var Fc=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1,l=null){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this.emulatorOptions=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=qn.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&qn.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function sA(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function _y(n,e,t){g(typeof e=="string","typeof type must == string"),g(typeof t=="object","typeof params must == object");let r;if(e===my)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===gy)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);sA(n)&&(t.ns=n.namespace);let i=[];return Ae(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var jh=class{constructor(){this.counters_={}}incrementCounter(e,t=1){ke(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Qg(this.counters_)}};var Th={},Rh={};function Pf(n){let e=n.toString();return Th[e]||(Th[e]=new jh),Th[e]}function oA(n,e){let t=n.toString();return Rh[t]||(Rh[t]=e()),Rh[t]}var Bh=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&ci(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var Rv="start",aA="close",cA="pLPCommand",lA="pRTLPCB",vy="id",yy="pw",Ey="ser",uA="cb",dA="seg",hA="ts",fA="d",pA="dframe",wy=1870,Cy=30,mA=wy-Cy,gA=25e3,_A=3e4,Wh=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=eo(e),this.stats_=Pf(t),this.urlFn=c=>(this.appCheckToken&&(c[Vh]=this.appCheckToken),_y(t,gy,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Bh(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(_A)),JR(()=>{if(this.isClosed_)return;this.scriptTagHolder=new $h((...s)=>{let[o,a,c,l,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===Rv)this.id=a,this.password=c;else if(o===aA)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[Rv]="t",r[Ey]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[uA]=this.scriptTagHolder.uniqueCallbackIdentifier),r[cy]=Lc,this.transportSessionId&&(r[ly]=this.transportSessionId),this.lastSessionId&&(r[fy]=this.lastSessionId),this.applicationId&&(r[py]=this.applicationId),this.appCheckToken&&(r[Vh]=this.appCheckToken),typeof location<"u"&&location.hostname&&hy.test(location.hostname)&&(r[uy]=dy);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return ut()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!QR()&&!ZR()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=te(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=ad(t),i=oy(r,mA);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(ut())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[pA]="t",r[vy]=e,r[yy]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=te(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},$h=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ut())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=qR(),window[cA+this.uniqueCallbackIdentifier]=e,window[lA+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){ye("frame writing exception"),a.stack&&ye(a.stack),ye(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||ye("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[vy]=this.myID,e[yy]=this.myPW,e[Ey]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Cy+r.length<=wy;){let o=this.pendingSegs.shift();r=r+"&"+dA+i+"="+o.seg+"&"+hA+i+"="+o.ts+"&"+fA+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(gA)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){ut()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{ye("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var vA=16384,yA=45e3,Uc=null;typeof MozWebSocket<"u"?Uc=MozWebSocket:typeof WebSocket<"u"&&(Uc=WebSocket);var Fs=(()=>{class n{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=eo(this.connId),this.stats_=Pf(r),this.connURL=n.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[cy]=Lc,!ut()&&typeof location<"u"&&location.hostname&&hy.test(location.hostname)&&(a[uy]=dy),r&&(a[ly]=r),i&&(a[fy]=i),s&&(a[Vh]=s),o&&(a[py]=o),_y(t,my,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,qn.set("previous_websocket_failure",!0);try{let i;if(ut()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Lc}/${Rf}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Uc(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&Uc!==null&&!n.forceDisallow_}static previouslyFailed(){return qn.isInMemoryStorage||qn.get("previous_websocket_failure")===!0}markConnectionHealthy(){qn.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Dr(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(g(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=te(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=oy(r,vA);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(yA))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),EA=(()=>{class n{static get ALL_TRANSPORTS(){return[Wh,Fs]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){let r=Fs&&Fs.isAvailable(),i=r&&!Fs.previouslyFailed();if(t.webSocketOnly&&(r||Re("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Fs];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),wA=6e4,CA=5e3,IA=10*1024,bA=100*1024,Ah="t",Av="d",SA="s",Pv="r",TA="e",Dv="o",Ov="a",Nv="n",Mv="p",RA="h",Hh=class{constructor(e,t,r,i,s,o,a,c,l,u){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=eo("c:"+this.id+":"),this.transportManager_=new EA(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Bs(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>bA?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>IA?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Ah in e){let t=e[Ah];t===Ov?this.upgradeIfSecondaryHealthy_():t===Pv?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===Dv&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=Ls("t",e),r=Ls("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Mv,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Ov,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Nv,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=Ls("t",e),r=Ls("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=Ls(Ah,e);if(Av in e){let r=e[Av];if(t===RA){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===Nv){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===SA?this.onConnectionShutdown_(r):t===Pv?this.onReset_(r):t===TA?Lh("Server Error: "+r):t===Dv?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Lh("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Lc!==r&&Re("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Bs(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(wA))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Bs(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(CA))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Mv,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(qn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Vc=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var jc=class{constructor(e){this.allowedEvents_=e,this.listeners_={},g(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){g(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var Bc=class n extends jc{static getInstance(){return new n}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ss()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return g(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var kv=32,xv=768,j=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function F(){return new j("")}function A(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function mn(n){return n.pieces_.length-n.pieceNum_}function z(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new j(n.pieces_,e)}function Iy(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function AA(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function by(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function Sy(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new j(e,0)}function se(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof j)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new j(t,0)}function D(n){return n.pieceNum_>=n.pieces_.length}function Ce(n,e){let t=A(n),r=A(e);if(t===null)return e;if(t===r)return Ce(z(n),z(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Df(n,e){if(mn(n)!==mn(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function nt(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(mn(n)>mn(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var zh=class{constructor(e,t){this.errorPrefix_=t,this.parts_=by(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=cs(this.parts_[r]);Ty(this)}};function PA(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=cs(e),Ty(n)}function DA(n){let e=n.parts_.pop();n.byteLength_-=cs(e),n.parts_.length>0&&(n.byteLength_-=1)}function Ty(n){if(n.byteLength_>xv)throw new Error(n.errorPrefix_+"has a key path longer than "+xv+" bytes ("+n.byteLength_+").");if(n.parts_.length>kv)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+kv+") or object contains a cycle "+Gn(n))}function Gn(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var Gh=class n extends jc{static getInstance(){return new n}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return g(e==="visible","Unknown event type: "+e),[this.visible_]}};var Us=1e3,OA=60*5*1e3,Lv=30*1e3,NA=1.3,MA=3e4,kA="server_kill",Fv=3,Of=(()=>{class n extends Vc{constructor(t,r,i,s,o,a,c,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=eo("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Us,this.maxReconnectDelay_=OA,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!ut())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Gh.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Bc.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(te(o)),g(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new rn,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),g(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),g(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,u=c.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),u!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(u,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&ke(t,"w")){let i=Mn(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Re(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||o_(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Lv)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=s_(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),g(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+te(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):Lh("Unrecognized action received from server: "+te(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){g(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Us,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Us,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>MA&&(this.reconnectDelay_=Us),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_),r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*NA)}this.onConnectStatus_(!1)}establishConnection_(){return h(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},u=function(f){g(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(f)};this.realtime_={close:l,sendRequest:u};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[f,p]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?ye("getToken() completed but was canceled"):(ye("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=p&&p.token,c=new Hh(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,_=>{Re(_+" ("+this.repoInfo_.toString()+")"),this.interrupt(kA)},o))}catch(f){this.log_("Failed to get token: "+f),a||(this.repoInfo_.nodeAdmin&&Re(f),l())}}})}interrupt(t){ye("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){ye("Resuming connection for reason: "+t),delete this.interruptReasons_[t],os(this.interruptReasons_)&&(this.reconnectDelay_=Us,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>Af(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new j(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){ye("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Fv&&(this.reconnectDelay_=Lv,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){ye("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Fv&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";ut()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+Rf.replace(/\./g,"-")]=1,ss()?t["framework.cordova"]=1:Nn()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=Bc.getInstance().currentlyOnline();return os(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),P=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var ti=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new P(ei,e),i=new P(ei,t);return this.compare(r,i)!==0}minPost(){return P.MIN}};var xc,Wc=class extends ti{static get __EMPTY_NODE(){return xc}static set __EMPTY_NODE(e){xc=e}compare(e,t){return ai(e.name,t.name)}isDefinedOn(e){throw On("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return P.MIN}maxPost(){return new P(Jn,xc)}makePost(e,t){return g(typeof e=="string","KeyIndex indexValue must always be a string."),new P(e,xc)}toString(){return".key"}},Zr=new Wc;var Xr=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},tt=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??Ge.EMPTY_NODE,this.right=o??Ge.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ge.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return Ge.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),qh=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new tt(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Ge=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,tt.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,tt.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Xr(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Xr(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Xr(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Xr(this.root_,null,this.comparator_,!0,e)}};Ge.EMPTY_NODE=new qh;function xA(n,e){return ai(n.name,e.name)}function Nf(n,e){return ai(n,e)}var Kh;function LA(n){Kh=n}var Ry=function(n){return typeof n=="number"?"number:"+ay(n):"string:"+n},Ay=function(n){if(n.isLeafNode()){let e=n.val();g(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ke(e,".sv"),"Priority must be a string or number.")}else g(n===Kh||n.isEmpty(),"priority of unexpected type.");g(n===Kh||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var Uv,ni=(()=>{class n{static set __childrenNodeConstructor(t){Uv=t}static get __childrenNodeConstructor(){return Uv}constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,g(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Ay(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return D(t)?this:A(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=A(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(g(i!==".priority"||mn(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(z(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+Ry(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=ay(this.value_):t+=this.value_,this.lazyHash_=iy(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(g(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return g(s>=0,"Unknown leaf type: "+r),g(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),Py,Dy;function FA(n){Py=n}function UA(n){Dy=n}var Yh=class extends ti{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?ai(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return P.MIN}maxPost(){return new P(Jn,new ni("[PRIORITY-POST]",Dy))}makePost(e,t){let r=Py(e);return new P(t,new ni("[PRIORITY-POST]",r))}toString(){return".priority"}},Y=new Yh;var VA=Math.log(2),Jh=class{constructor(e){let t=s=>parseInt(Math.log(s)/VA,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},$c=function(n,e,t,r){n.sort(e);let i=function(c,l){let u=l-c,d,f;if(u===0)return null;if(u===1)return d=n[c],f=t?t(d):d,new tt(f,d.node,tt.BLACK,null,null);{let p=parseInt(u/2,10)+c,_=i(c,p),y=i(p+1,l);return d=n[p],f=t?t(d):d,new tt(f,d.node,tt.BLACK,_,y)}},s=function(c){let l=null,u=null,d=n.length,f=function(_,y){let w=d-_,G=d;d-=_;let oe=i(w+1,G),k=n[w],Le=t?t(k):k;p(new tt(Le,k.node,y,null,oe))},p=function(_){l?(l.left=_,l=_):(u=_,l=_)};for(let _=0;_<c.count;++_){let y=c.nextBitIsOne(),w=Math.pow(2,c.count-(_+1));y?f(w,tt.BLACK):(f(w,tt.BLACK),f(w,tt.RED))}return u},o=new Jh(n.length),a=s(o);return new Ge(r||e,a)};var Ph,Jr={},ri=class n{static get Default(){return g(Jr&&Y,"ChildrenNode.ts has not been loaded"),Ph=Ph||new n({".priority":Jr},{".priority":Y}),Ph}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){let t=Mn(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Ge?t:null}hasIndex(e){return ke(this.indexSet_,e.toString())}addIndex(e,t){g(e!==Zr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(P.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=$c(r,e.getCompare()):a=Jr;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let u=Object.assign({},this.indexes_);return u[c]=a,new n(u,l)}addToIndexes(e,t){let r=as(this.indexes_,(i,s)=>{let o=Mn(this.indexSet_,s);if(g(o,"Missing index implementation for "+s),i===Jr)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(P.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),$c(a,o.getCompare())}else return Jr;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new P(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=as(this.indexes_,i=>{if(i===Jr)return i;{let s=t.get(e.name);return s?i.remove(new P(e.name,s)):i}});return new n(r,this.indexSet_)}};var Vs,T=(()=>{class n{static get EMPTY_NODE(){return Vs||(Vs=new n(new Ge(Nf),null,ri.Default))}constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&Ay(this.priorityNode_),this.children_.isEmpty()&&g(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Vs}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?Vs:r}}getChild(t){let r=A(t);return r===null?this:this.getImmediateChild(r).getChild(z(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(g(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new P(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Vs:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=A(t);if(i===null)return r;{g(A(t)!==".priority"||mn(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(z(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Y,(a,c)=>{r[a]=c.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+Ry(this.getPriority().val())+":"),this.forEachChild(Y,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":iy(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new P(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new P(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new P(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,P.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,P.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===to?-1:0}withIndex(t){if(t===Zr||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Zr||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Y),s=r.getIterator(Y),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===Zr?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),Xh=class extends T{constructor(){super(new Ge(Nf),T.EMPTY_NODE,ri.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return T.EMPTY_NODE}isEmpty(){return!1}},to=new Xh;Object.defineProperties(P,{MIN:{value:new P(ei,T.EMPTY_NODE)},MAX:{value:new P(Jn,to)}});Wc.__EMPTY_NODE=T.EMPTY_NODE;ni.__childrenNodeConstructor=T;LA(to);UA(to);var jA=!0;function he(n,e=null){if(n===null)return T.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),g(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new ni(t,he(e))}if(!(n instanceof Array)&&jA){let t=[],r=!1;if(Ae(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=he(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new P(o,c)))}}),t.length===0)return T.EMPTY_NODE;let s=$c(t,xA,o=>o.name,Nf);if(r){let o=$c(t,Y.getCompare());return new T(s,he(e),new ri({".priority":o},{".priority":Y}))}else return new T(s,he(e),ri.Default)}else{let t=T.EMPTY_NODE;return Ae(n,(r,i)=>{if(ke(n,r)&&r.substring(0,1)!=="."){let s=he(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(he(e))}}FA(he);var Qh=class extends ti{constructor(e){super(),this.indexPath_=e,g(!D(e)&&A(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?ai(e.name,t.name):s}makePost(e,t){let r=he(e),i=T.EMPTY_NODE.updateChild(this.indexPath_,r);return new P(t,i)}maxPost(){let e=T.EMPTY_NODE.updateChild(this.indexPath_,to);return new P(Jn,e)}toString(){return by(this.indexPath_,0).join("/")}};var Zh=class extends ti{compare(e,t){let r=e.node.compareTo(t.node);return r===0?ai(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return P.MIN}maxPost(){return P.MAX}makePost(e,t){let r=he(e);return new P(t,r)}toString(){return".value"}},BA=new Zh;function Oy(n){return{type:"value",snapshotNode:n}}function ii(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Gs(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function qs(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function WA(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var Ks=class{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){g(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(Gs(t,a)):g(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(ii(t,r)):o.trackChildChange(qs(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Y,(i,s)=>{t.hasChild(i)||r.trackChildChange(Gs(i,s))}),t.isLeafNode()||t.forEachChild(Y,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(qs(i,s,o))}else r.trackChildChange(ii(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?T.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Hc=class n{constructor(e){this.indexedFilter_=new Ks(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new P(t,r))||(r=T.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=T.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(T.EMPTY_NODE);let s=this;return t.forEachChild(Y,(o,a)=>{s.matches(new P(o,a))||(i=i.updateImmediateChild(o,T.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var ef=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Hc(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new P(t,r))||(r=T.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=T.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=T.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(T.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,T.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(f,p)=>d(p,f)}else o=this.index_.getCompare();let a=e;g(a.numChildren()===this.limit_,"");let c=new P(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(t)){let d=a.getImmediateChild(t),f=i.getChildAfterChild(this.index_,l,this.reverse_);for(;f!=null&&(f.name===t||a.hasChild(f.name));)f=i.getChildAfterChild(this.index_,f,this.reverse_);let p=f==null?1:o(f,c);if(u&&!r.isEmpty()&&p>=0)return s?.trackChildChange(qs(t,r,d)),a.updateImmediateChild(t,r);{s?.trackChildChange(Gs(t,d));let y=a.updateImmediateChild(t,T.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(s?.trackChildChange(ii(f.name,f.node)),y.updateImmediateChild(f.name,f.node)):y}}else return r.isEmpty()?e:u&&o(l,c)>=0?(s!=null&&(s.trackChildChange(Gs(l.name,l.node)),s.trackChildChange(ii(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,T.EMPTY_NODE)):e}};var tf=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Y}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return g(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return g(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ei}hasEnd(){return this.endSet_}getIndexEndValue(){return g(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return g(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Jn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return g(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Y}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function $A(n){return n.loadsAllData()?new Ks(n.getIndex()):n.hasLimit()?new ef(n):new Hc(n)}function Vv(n){let e={};if(n.isDefault())return e;let t;if(n.index_===Y?t="$priority":n.index_===BA?t="$value":n.index_===Zr?t="$key":(g(n.index_ instanceof Qh,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=te(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=te(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+te(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=te(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+te(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function jv(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Y&&(e.i=n.index_.toString()),e}var nf=class n extends Vc{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(g(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=eo("p:rest:"),this.listens_={}}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let c=Vv(e._queryParams);this.restRequest_(s+".json",c,(l,u)=>{let d=u;if(l===404&&(d=null,l=null),l===null&&this.onDataUpdate_(s,d,!1,r),Mn(this.listens_,o)===a){let f;l?l===401?f="permission_denied":f="rest_error:"+l:f="ok",i(f,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=Vv(e._queryParams),r=e._path.toString(),i=new rn;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+kt(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Dr(a.responseText)}catch{Re("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Re("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var rf=class{constructor(){this.rootNode_=T.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function zc(){return{value:null,children:new Map}}function Ny(n,e,t){if(D(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=A(e);n.children.has(r)||n.children.set(r,zc());let i=n.children.get(r);e=z(e),Ny(i,e,t)}}function sf(n,e,t){n.value!==null?t(e,n.value):HA(n,(r,i)=>{let s=new j(e.toString()+"/"+r);sf(i,s,t)})}function HA(n,e){n.children.forEach((t,r)=>{e(r,t)})}var of=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Ae(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var Bv=10*1e3,zA=30*1e3,GA=5*60*1e3,af=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new of(e);let r=Bv+(zA-Bv)*Math.random();Bs(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;Ae(e,(i,s)=>{s>0&&ke(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),Bs(this.reportStats_.bind(this),Math.floor(Math.random()*2*GA))}};var Et=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Et||{});function My(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Mf(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function kf(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var cf=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Et.ACK_USER_WRITE,this.source=My()}operationForChild(e){if(D(this.path)){if(this.affectedTree.value!=null)return g(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new j(e));return new n(F(),t,this.revert)}}else return g(A(this.path)===e,"operationForChild called for unrelated child."),new n(z(this.path),this.affectedTree,this.revert)}};var Gc=class n{constructor(e,t){this.source=e,this.path=t,this.type=Et.LISTEN_COMPLETE}operationForChild(e){return D(this.path)?new n(this.source,F()):new n(this.source,z(this.path))}};var si=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Et.OVERWRITE}operationForChild(e){return D(this.path)?new n(this.source,F(),this.snap.getImmediateChild(e)):new n(this.source,z(this.path),this.snap)}};var qc=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Et.MERGE}operationForChild(e){if(D(this.path)){let t=this.children.subtree(new j(e));return t.isEmpty()?null:t.value?new si(this.source,F(),t.value):new n(this.source,F(),t)}else return g(A(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,z(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var wt=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(D(e))return this.isFullyInitialized()&&!this.filtered_;let t=A(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var lf=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function qA(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(WA(o.childName,o.snapshotNode))}),js(n,i,"child_removed",e,r,t),js(n,i,"child_added",e,r,t),js(n,i,"child_moved",s,r,t),js(n,i,"child_changed",e,r,t),js(n,i,"value",e,r,t),i}function js(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>YA(n,a,c)),o.forEach(a=>{let c=KA(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,n.query_))})})}function KA(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function YA(n,e,t){if(e.childName==null||t.childName==null)throw On("Should only compare child_ events.");let r=new P(e.childName,e.snapshotNode),i=new P(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function al(n,e){return{eventCache:n,serverCache:e}}function $s(n,e,t,r){return al(new wt(e,t,r),n.serverCache)}function ky(n,e,t,r){return al(n.eventCache,new wt(e,t,r))}function Kc(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Xn(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var Dh,JA=()=>(Dh||(Dh=new Ge(XR)),Dh),Pe=class n{static fromObject(e){let t=new n(null);return Ae(e,(r,i)=>{t=t.set(new j(r),i)}),t}constructor(e,t=JA()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:F(),value:this.value};if(D(e))return null;{let r=A(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(z(e),t);return s!=null?{path:se(new j(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(D(e))return this;{let t=A(e),r=this.children.get(t);return r!==null?r.subtree(z(e)):new n(null)}}set(e,t){if(D(e))return new n(t,this.children);{let r=A(e),s=(this.children.get(r)||new n(null)).set(z(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(D(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=A(e),r=this.children.get(t);if(r){let i=r.remove(z(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(D(e))return this.value;{let t=A(e),r=this.children.get(t);return r?r.get(z(e)):null}}setTree(e,t){if(D(e))return t;{let r=A(e),s=(this.children.get(r)||new n(null)).setTree(z(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(F(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(se(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,F(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(D(e))return null;{let s=A(e),o=this.children.get(s);return o?o.findOnPath_(z(e),se(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,F(),t)}foreachOnPath_(e,t,r){if(D(e))return this;{this.value&&r(t,this.value);let i=A(e),s=this.children.get(i);return s?s.foreachOnPath_(z(e),se(t,i),r):new n(null)}}foreach(e){this.foreach_(F(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(se(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var rt=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new Pe(null))}};function Hs(n,e,t){if(D(e))return new rt(new Pe(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Ce(i,e);return s=s.updateChild(o,t),new rt(n.writeTree_.set(i,s))}else{let i=new Pe(t),s=n.writeTree_.setTree(e,i);return new rt(s)}}}function Wv(n,e,t){let r=n;return Ae(t,(i,s)=>{r=Hs(r,se(e,i),s)}),r}function $v(n,e){if(D(e))return rt.empty();{let t=n.writeTree_.setTree(e,new Pe(null));return new rt(t)}}function uf(n,e){return Qn(n,e)!=null}function Qn(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Ce(t.path,e)):null}function Hv(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Y,(r,i)=>{e.push(new P(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new P(r,i.value))}),e}function fn(n,e){if(D(e))return n;{let t=Qn(n,e);return t!=null?new rt(new Pe(t)):new rt(n.writeTree_.subtree(e))}}function df(n){return n.writeTree_.isEmpty()}function oi(n,e){return xy(F(),n.writeTree_,e)}function xy(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(g(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=xy(se(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(se(n,".priority"),r)),t}}function cl(n,e){return Vy(e,n)}function XA(n,e,t,r,i){g(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Hs(n.visibleWrites,e,t)),n.lastWriteId=r}function QA(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function ZA(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);g(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&e0(a,r.path)?i=!1:nt(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return t0(n),!0;if(r.snap)n.visibleWrites=$v(n.visibleWrites,r.path);else{let a=r.children;Ae(a,c=>{n.visibleWrites=$v(n.visibleWrites,se(r.path,c))})}return!0}else return!1}function e0(n,e){if(n.snap)return nt(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&nt(se(n.path,t),e))return!0;return!1}function t0(n){n.visibleWrites=Ly(n.allWrites,n0,F()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function n0(n){return n.visible}function Ly(n,e,t){let r=rt.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)nt(t,o)?(a=Ce(t,o),r=Hs(r,a,s.snap)):nt(o,t)&&(a=Ce(o,t),r=Hs(r,F(),s.snap.getChild(a)));else if(s.children){if(nt(t,o))a=Ce(t,o),r=Wv(r,a,s.children);else if(nt(o,t))if(a=Ce(o,t),D(a))r=Wv(r,F(),s.children);else{let c=Mn(s.children,A(a));if(c){let l=c.getChild(z(a));r=Hs(r,F(),l)}}}else throw On("WriteRecord should have .snap or .children")}}return r}function Fy(n,e,t,r,i){if(!r&&!i){let s=Qn(n.visibleWrites,e);if(s!=null)return s;{let o=fn(n.visibleWrites,e);if(df(o))return t;if(t==null&&!uf(o,F()))return null;{let a=t||T.EMPTY_NODE;return oi(o,a)}}}else{let s=fn(n.visibleWrites,e);if(!i&&df(s))return t;if(!i&&t==null&&!uf(s,F()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(nt(l.path,e)||nt(e,l.path))},a=Ly(n.allWrites,o,e),c=t||T.EMPTY_NODE;return oi(a,c)}}}function r0(n,e,t){let r=T.EMPTY_NODE,i=Qn(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Y,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=fn(n.visibleWrites,e);return t.forEachChild(Y,(o,a)=>{let c=oi(fn(s,new j(o)),a);r=r.updateImmediateChild(o,c)}),Hv(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=fn(n.visibleWrites,e);return Hv(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function i0(n,e,t,r,i){g(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=se(e,t);if(uf(n.visibleWrites,s))return null;{let o=fn(n.visibleWrites,s);return df(o)?i.getChild(t):oi(o,i.getChild(t))}}function s0(n,e,t,r){let i=se(e,t),s=Qn(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=fn(n.visibleWrites,i);return oi(o,r.getNode().getImmediateChild(t))}else return null}function o0(n,e){return Qn(n.visibleWrites,e)}function a0(n,e,t,r,i,s,o){let a,c=fn(n.visibleWrites,e),l=Qn(c,F());if(l!=null)a=l;else if(t!=null)a=oi(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let u=[],d=o.getCompare(),f=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),p=f.getNext();for(;p&&u.length<i;)d(p,r)!==0&&u.push(p),p=f.getNext();return u}else return[]}function c0(){return{visibleWrites:rt.empty(),allWrites:[],lastWriteId:-1}}function Yc(n,e,t,r){return Fy(n.writeTree,n.treePath,e,t,r)}function xf(n,e){return r0(n.writeTree,n.treePath,e)}function zv(n,e,t,r){return i0(n.writeTree,n.treePath,e,t,r)}function Jc(n,e){return o0(n.writeTree,se(n.treePath,e))}function l0(n,e,t,r,i,s){return a0(n.writeTree,n.treePath,e,t,r,i,s)}function Lf(n,e,t){return s0(n.writeTree,n.treePath,e,t)}function Uy(n,e){return Vy(se(n.treePath,e),n.writeTree)}function Vy(n,e){return{treePath:n,writeTree:e}}var hf=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;g(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),g(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,qs(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,Gs(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,ii(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,qs(r,e.snapshotNode,i.oldSnap));else throw On("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var ff=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},jy=new ff,Ys=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new wt(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Lf(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Xn(this.viewCache_),s=l0(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function u0(n){return{filter:n}}function d0(n,e){g(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),g(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function h0(n,e,t,r,i){let s=new hf,o,a;if(t.type===Et.OVERWRITE){let l=t;l.source.fromUser?o=pf(n,e,l.path,l.snap,r,i,s):(g(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!D(l.path),o=Xc(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===Et.MERGE){let l=t;l.source.fromUser?o=p0(n,e,l.path,l.children,r,i,s):(g(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=mf(n,e,l.path,l.children,r,i,a,s))}else if(t.type===Et.ACK_USER_WRITE){let l=t;l.revert?o=_0(n,e,l.path,r,i,s):o=m0(n,e,l.path,l.affectedTree,r,i,s)}else if(t.type===Et.LISTEN_COMPLETE)o=g0(n,e,t.path,r,s);else throw On("Unknown operation type: "+t.type);let c=s.getChanges();return f0(e,o,c),{viewCache:o,changes:c}}function f0(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Kc(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(Oy(Kc(e)))}}function By(n,e,t,r,i,s){let o=e.eventCache;if(Jc(r,t)!=null)return e;{let a,c;if(D(t))if(g(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Xn(e),u=l instanceof T?l:T.EMPTY_NODE,d=xf(r,u);a=n.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let l=Yc(r,Xn(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=A(t);if(l===".priority"){g(mn(t)===1,"Can't have a priority with additional path components");let u=o.getNode();c=e.serverCache.getNode();let d=zv(r,t,u,c);d!=null?a=n.filter.updatePriority(u,d):a=o.getNode()}else{let u=z(t),d;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let f=zv(r,t,o.getNode(),c);f!=null?d=o.getNode().getImmediateChild(l).updateChild(u,f):d=o.getNode().getImmediateChild(l)}else d=Lf(r,l,e.serverCache);d!=null?a=n.filter.updateChild(o.getNode(),l,d,u,i,s):a=o.getNode()}}return $s(e,a,o.isFullyInitialized()||D(t),n.filter.filtersNodes())}}function Xc(n,e,t,r,i,s,o,a){let c=e.serverCache,l,u=o?n.filter:n.filter.getIndexedFilter();if(D(t))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){let p=c.getNode().updateChild(t,r);l=u.updateFullNode(c.getNode(),p,null)}else{let p=A(t);if(!c.isCompleteForPath(t)&&mn(t)>1)return e;let _=z(t),w=c.getNode().getImmediateChild(p).updateChild(_,r);p===".priority"?l=u.updatePriority(c.getNode(),w):l=u.updateChild(c.getNode(),p,w,_,jy,null)}let d=ky(e,l,c.isFullyInitialized()||D(t),u.filtersNodes()),f=new Ys(i,d,s);return By(n,d,t,i,f,a)}function pf(n,e,t,r,i,s,o){let a=e.eventCache,c,l,u=new Ys(i,e,s);if(D(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=$s(e,l,!0,n.filter.filtersNodes());else{let d=A(t);if(d===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),c=$s(e,l,a.isFullyInitialized(),a.isFiltered());else{let f=z(t),p=a.getNode().getImmediateChild(d),_;if(D(f))_=r;else{let y=u.getCompleteChild(d);y!=null?Iy(f)===".priority"&&y.getChild(Sy(f)).isEmpty()?_=y:_=y.updateChild(f,r):_=T.EMPTY_NODE}if(p.equals(_))c=e;else{let y=n.filter.updateChild(a.getNode(),d,_,f,u,o);c=$s(e,y,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function Gv(n,e){return n.eventCache.isCompleteForChild(e)}function p0(n,e,t,r,i,s,o){let a=e;return r.foreach((c,l)=>{let u=se(t,c);Gv(e,A(u))&&(a=pf(n,a,u,l,i,s,o))}),r.foreach((c,l)=>{let u=se(t,c);Gv(e,A(u))||(a=pf(n,a,u,l,i,s,o))}),a}function qv(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function mf(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;D(t)?l=r:l=new Pe(null).setTree(t,r);let u=e.serverCache.getNode();return l.children.inorderTraversal((d,f)=>{if(u.hasChild(d)){let p=e.serverCache.getNode().getImmediateChild(d),_=qv(n,p,f);c=Xc(n,c,new j(d),_,i,s,o,a)}}),l.children.inorderTraversal((d,f)=>{let p=!e.serverCache.isCompleteForChild(d)&&f.value===null;if(!u.hasChild(d)&&!p){let _=e.serverCache.getNode().getImmediateChild(d),y=qv(n,_,f);c=Xc(n,c,new j(d),y,i,s,o,a)}}),c}function m0(n,e,t,r,i,s,o){if(Jc(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(D(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return Xc(n,e,t,c.getNode().getChild(t),i,s,a,o);if(D(t)){let l=new Pe(null);return c.getNode().forEachChild(Zr,(u,d)=>{l=l.set(new j(u),d)}),mf(n,e,t,l,i,s,a,o)}else return e}else{let l=new Pe(null);return r.foreach((u,d)=>{let f=se(t,u);c.isCompleteForPath(f)&&(l=l.set(u,c.getNode().getChild(f)))}),mf(n,e,t,l,i,s,a,o)}}function g0(n,e,t,r,i){let s=e.serverCache,o=ky(e,s.getNode(),s.isFullyInitialized()||D(t),s.isFiltered());return By(n,o,t,r,jy,i)}function _0(n,e,t,r,i,s){let o;if(Jc(r,t)!=null)return e;{let a=new Ys(r,e,i),c=e.eventCache.getNode(),l;if(D(t)||A(t)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Yc(r,Xn(e));else{let d=e.serverCache.getNode();g(d instanceof T,"serverChildren would be complete if leaf node"),u=xf(r,d)}u=u,l=n.filter.updateFullNode(c,u,s)}else{let u=A(t),d=Lf(r,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=c.getImmediateChild(u)),d!=null?l=n.filter.updateChild(c,u,d,z(t),a,s):e.eventCache.getNode().hasChild(u)?l=n.filter.updateChild(c,u,T.EMPTY_NODE,z(t),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Yc(r,Xn(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||Jc(r,F())!=null,$s(e,l,o,n.filter.filtersNodes())}}var gf=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Ks(r.getIndex()),s=$A(r);this.processor_=u0(s);let o=t.serverCache,a=t.eventCache,c=i.updateFullNode(T.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(T.EMPTY_NODE,a.getNode(),null),u=new wt(c,o.isFullyInitialized(),i.filtersNodes()),d=new wt(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=al(d,u),this.eventGenerator_=new lf(this.query_)}get query(){return this.query_}};function v0(n){return n.viewCache_.serverCache.getNode()}function y0(n){return Kc(n.viewCache_)}function E0(n,e){let t=Xn(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!D(e)&&!t.getImmediateChild(A(e)).isEmpty())?t.getChild(e):null}function Kv(n){return n.eventRegistrations_.length===0}function w0(n,e){n.eventRegistrations_.push(e)}function Yv(n,e,t){let r=[];if(t){g(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function Jv(n,e,t,r){e.type===Et.MERGE&&e.source.queryId!==null&&(g(Xn(n.viewCache_),"We should always have a full cache before handling merges"),g(Kc(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=h0(n.processor_,i,e,t,r);return d0(n.processor_,s.viewCache),g(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,Wy(n,s.changes,s.viewCache.eventCache.getNode(),null)}function C0(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Y,(s,o)=>{r.push(ii(s,o))}),t.isFullyInitialized()&&r.push(Oy(t.getNode())),Wy(n,r,t.getNode(),e)}function Wy(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return qA(n.eventGenerator_,e,t,i)}var Qc,Zc=class{constructor(){this.views=new Map}};function I0(n){g(!Qc,"__referenceConstructor has already been defined"),Qc=n}function b0(){return g(Qc,"Reference.ts has not been loaded"),Qc}function S0(n){return n.views.size===0}function Ff(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return g(s!=null,"SyncTree gave us an op for an invalid query."),Jv(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(Jv(o,e,t,r));return s}}function $y(n,e,t,r,i){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=Yc(t,i?r:null),c=!1;a?c=!0:r instanceof T?(a=xf(t,r),c=!1):(a=T.EMPTY_NODE,c=!1);let l=al(new wt(a,c,!1),new wt(r,i,!1));return new gf(e,l)}return o}function T0(n,e,t,r,i,s){let o=$y(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),w0(o,t),C0(o,t)}function R0(n,e,t,r){let i=e._queryIdentifier,s=[],o=[],a=gn(n);if(i==="default")for(let[c,l]of n.views.entries())o=o.concat(Yv(l,t,r)),Kv(l)&&(n.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=n.views.get(i);c&&(o=o.concat(Yv(c,t,r)),Kv(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!gn(n)&&s.push(new(b0())(e._repo,e._path)),{removed:s,events:o}}function Hy(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function pn(n,e){let t=null;for(let r of n.views.values())t=t||E0(r,e);return t}function zy(n,e){if(e._queryParams.loadsAllData())return ll(n);{let r=e._queryIdentifier;return n.views.get(r)}}function Gy(n,e){return zy(n,e)!=null}function gn(n){return ll(n)!=null}function ll(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var el;function A0(n){g(!el,"__referenceConstructor has already been defined"),el=n}function P0(){return g(el,"Reference.ts has not been loaded"),el}var D0=1,tl=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Pe(null),this.pendingWriteTree_=c0(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function qy(n,e,t,r,i){return XA(n.pendingWriteTree_,e,t,r,i),i?ro(n,new si(My(),e,t)):[]}function Kn(n,e,t=!1){let r=QA(n.pendingWriteTree_,e);if(ZA(n.pendingWriteTree_,e)){let s=new Pe(null);return r.snap!=null?s=s.set(F(),!0):Ae(r.children,o=>{s=s.set(new j(o),!0)}),ro(n,new cf(r.path,s,t))}else return[]}function no(n,e,t){return ro(n,new si(Mf(),e,t))}function O0(n,e,t){let r=Pe.fromObject(t);return ro(n,new qc(Mf(),e,r))}function N0(n,e){return ro(n,new Gc(Mf(),e))}function M0(n,e,t){let r=Vf(n,t);if(r){let i=jf(r),s=i.path,o=i.queryId,a=Ce(s,e),c=new Gc(kf(o),a);return Bf(n,s,c)}else return[]}function nl(n,e,t,r,i=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||Gy(o,e))){let c=R0(o,e,t,r);S0(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!i){let u=l.findIndex(f=>f._queryParams.loadsAllData())!==-1,d=n.syncPointTree_.findOnPath(s,(f,p)=>gn(p));if(u&&!d){let f=n.syncPointTree_.subtree(s);if(!f.isEmpty()){let p=L0(f);for(let _=0;_<p.length;++_){let y=p[_],w=y.query,G=Xy(n,y);n.listenProvider_.startListening(zs(w),Js(n,w),G.hashFn,G.onComplete)}}}!d&&l.length>0&&!r&&(u?n.listenProvider_.stopListening(zs(e),null):l.forEach(f=>{let p=n.queryToTagMap.get(ul(f));n.listenProvider_.stopListening(zs(f),p)}))}F0(n,l)}return a}function Ky(n,e,t,r){let i=Vf(n,r);if(i!=null){let s=jf(i),o=s.path,a=s.queryId,c=Ce(o,e),l=new si(kf(a),c,t);return Bf(n,o,l)}else return[]}function k0(n,e,t,r){let i=Vf(n,r);if(i){let s=jf(i),o=s.path,a=s.queryId,c=Ce(o,e),l=Pe.fromObject(t),u=new qc(kf(a),c,l);return Bf(n,o,u)}else return[]}function _f(n,e,t,r=!1){let i=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(f,p)=>{let _=Ce(f,i);s=s||pn(p,_),o=o||gn(p)});let a=n.syncPointTree_.get(i);a?(o=o||gn(a),s=s||pn(a,F())):(a=new Zc,n.syncPointTree_=n.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=T.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((p,_)=>{let y=pn(_,F());y&&(s=s.updateImmediateChild(p,y))}));let l=Gy(a,e);if(!l&&!e._queryParams.loadsAllData()){let f=ul(e);g(!n.queryToTagMap.has(f),"View does not exist, but we have a tag");let p=U0();n.queryToTagMap.set(f,p),n.tagToQueryMap.set(p,f)}let u=cl(n.pendingWriteTree_,i),d=T0(a,e,t,u,s,c);if(!l&&!o&&!r){let f=zy(a,e);d=d.concat(V0(n,e,f))}return d}function Uf(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=Ce(o,e),l=pn(a,c);if(l)return l});return Fy(i,e,s,t,!0)}function x0(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(l,u)=>{let d=Ce(l,t);r=r||pn(u,d)});let i=n.syncPointTree_.get(t);i?r=r||pn(i,F()):(i=new Zc,n.syncPointTree_=n.syncPointTree_.set(t,i));let s=r!=null,o=s?new wt(r,!0,!1):null,a=cl(n.pendingWriteTree_,e._path),c=$y(i,e,a,s?o.getNode():T.EMPTY_NODE,s);return y0(c)}function ro(n,e){return Yy(e,n.syncPointTree_,null,cl(n.pendingWriteTree_,F()))}function Yy(n,e,t,r){if(D(n.path))return Jy(n,e,t,r);{let i=e.get(F());t==null&&i!=null&&(t=pn(i,F()));let s=[],o=A(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let l=t?t.getImmediateChild(o):null,u=Uy(r,o);s=s.concat(Yy(a,c,l,u))}return i&&(s=s.concat(Ff(i,n,r,t))),s}}function Jy(n,e,t,r){let i=e.get(F());t==null&&i!=null&&(t=pn(i,F()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,l=Uy(r,o),u=n.operationForChild(o);u&&(s=s.concat(Jy(u,a,c,l)))}),i&&(s=s.concat(Ff(i,n,r,t))),s}function Xy(n,e){let t=e.query,r=Js(n,t);return{hashFn:()=>(v0(e)||T.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?M0(n,t._path,r):N0(n,t._path);{let s=eA(i,t);return nl(n,t,null,s)}}}}function Js(n,e){let t=ul(e);return n.queryToTagMap.get(t)}function ul(n){return n._path.toString()+"$"+n._queryIdentifier}function Vf(n,e){return n.tagToQueryMap.get(e)}function jf(n){let e=n.indexOf("$");return g(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new j(n.substr(0,e))}}function Bf(n,e,t){let r=n.syncPointTree_.get(e);g(r,"Missing sync point for query tag that we're tracking");let i=cl(n.pendingWriteTree_,e);return Ff(r,t,i,null)}function L0(n){return n.fold((e,t,r)=>{if(t&&gn(t))return[ll(t)];{let i=[];return t&&(i=Hy(t)),Ae(r,(s,o)=>{i=i.concat(o)}),i}})}function zs(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(P0())(n._repo,n._path):n}function F0(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=ul(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function U0(){return D0++}function V0(n,e,t){let r=e._path,i=Js(n,e),s=Xy(n,t),o=n.listenProvider_.startListening(zs(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)g(!gn(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,u,d)=>{if(!D(l)&&u&&gn(u))return[ll(u).query];{let f=[];return u&&(f=f.concat(Hy(u).map(p=>p.query))),Ae(d,(p,_)=>{f=f.concat(_)}),f}});for(let l=0;l<c.length;++l){let u=c[l];n.listenProvider_.stopListening(zs(u),Js(n,u))}}return o}var vf=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},yf=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=se(this.path_,e);return new n(this.syncTree_,t)}node(){return Uf(this.syncTree_,this.path_)}},j0=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},Xv=function(n,e,t){if(!n||typeof n!="object")return n;if(g(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return B0(n[".sv"],e,t);if(typeof n[".sv"]=="object")return W0(n[".sv"],e);g(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},B0=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:g(!1,"Unexpected server value: "+n)}},W0=function(n,e,t){n.hasOwnProperty("increment")||g(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&g(!1,"Unexpected increment value: "+r);let i=e.node();if(g(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},$0=function(n,e,t,r){return Wf(e,new yf(t,n),r)},Qy=function(n,e,t){return Wf(n,new vf(e),t)};function Wf(n,e,t){let r=n.getPriority().val(),i=Xv(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=Xv(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new ni(a,he(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new ni(i))),o.forEachChild(Y,(a,c)=>{let l=Wf(c,e.getImmediateChild(a),t);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var Xs=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function $f(n,e){let t=e instanceof j?e:new j(e),r=n,i=A(t);for(;i!==null;){let s=Mn(r.node.children,i)||{children:{},childCount:0};r=new Xs(i,r,s),t=z(t),i=A(t)}return r}function li(n){return n.node.value}function Zy(n,e){n.node.value=e,Ef(n)}function eE(n){return n.node.childCount>0}function H0(n){return li(n)===void 0&&!eE(n)}function dl(n,e){Ae(n.node.children,(t,r)=>{e(new Xs(t,n,r))})}function tE(n,e,t,r){t&&!r&&e(n),dl(n,i=>{tE(i,e,!0,r)}),t&&r&&e(n)}function z0(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function io(n){return new j(n.parent===null?n.name:io(n.parent)+"/"+n.name)}function Ef(n){n.parent!==null&&G0(n.parent,n.name,n)}function G0(n,e,t){let r=H0(t),i=ke(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,Ef(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,Ef(n))}var q0=/[\[\].#$\/\u0000-\u001F\u007F]/,K0=/[\[\].#$\u0000-\u001F\u007F]/,Oh=10*1024*1024,nE=function(n){return typeof n=="string"&&n.length!==0&&!q0.test(n)},rE=function(n){return typeof n=="string"&&n.length!==0&&!K0.test(n)},Y0=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),rE(n)};var iE=function(n,e,t,r){r&&e===void 0||Hf(Ia(n,"value"),e,t)},Hf=function(n,e,t){let r=t instanceof j?new zh(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Gn(r));if(typeof e=="function")throw new Error(n+"contains a function "+Gn(r)+" with contents = "+e.toString());if(sy(e))throw new Error(n+"contains "+e.toString()+" "+Gn(r));if(typeof e=="string"&&e.length>Oh/3&&cs(e)>Oh)throw new Error(n+"contains a string greater than "+Oh+" utf8 bytes "+Gn(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Ae(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!nE(o)))throw new Error(n+" contains an invalid key ("+o+") "+Gn(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);PA(r,o),Hf(n,a,r),DA(r)}),i&&s)throw new Error(n+' contains ".value" child '+Gn(r)+" in addition to actual children.")}};var sE=function(n,e,t,r){if(!(r&&t===void 0)&&!rE(t))throw new Error(Ia(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},J0=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),sE(n,e,t,r)},oE=function(n,e){if(A(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},X0=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!nE(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!Y0(t))throw new Error(Ia(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var wf=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function zf(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!Df(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function aE(n,e,t){zf(n,t),cE(n,r=>Df(r,e))}function Ct(n,e,t){zf(n,t),cE(n,r=>nt(r,e)||nt(e,r))}function cE(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(Q0(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function Q0(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Yn&&ye("event: "+t.toString()),ci(r)}}}var Z0="repo_interrupt",eP=25,Cf=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new wf,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=zc(),this.transactionQueueTree_=new Xs,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function tP(n,e,t){if(n.stats_=Pf(n.repoInfo_),n.forceRestClient_||iA())n.server_=new nf(n.repoInfo_,(r,i,s,o)=>{Qv(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>Zv(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{te(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new Of(n.repoInfo_,e,(r,i,s,o)=>{Qv(n,r,i,s,o)},r=>{Zv(n,r)},r=>{nP(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=oA(n.repoInfo_,()=>new af(n.stats_,n.server_)),n.infoData_=new rf,n.infoSyncTree_=new tl({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=no(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),qf(n,"connected",!1),n.serverSyncTree_=new tl({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);Ct(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function lE(n){let t=n.infoData_.getNode(new j(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Gf(n){return j0({timestamp:lE(n)})}function Qv(n,e,t,r,i){n.dataUpdateCount++;let s=new j(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=as(t,l=>he(l));o=k0(n.serverSyncTree_,s,c,i)}else{let c=he(t);o=Ky(n.serverSyncTree_,s,c,i)}else if(r){let c=as(t,l=>he(l));o=O0(n.serverSyncTree_,s,c)}else{let c=he(t);o=no(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=fl(n,s)),Ct(n.eventQueue_,a,o)}function Zv(n,e){qf(n,"connected",e),e===!1&&sP(n)}function nP(n,e){Ae(e,(t,r)=>{qf(n,t,r)})}function qf(n,e,t){let r=new j("/.info/"+e),i=he(t);n.infoData_.updateSnapshot(r,i);let s=no(n.infoSyncTree_,r,i);Ct(n.eventQueue_,r,s)}function uE(n){return n.nextWriteId_++}function rP(n,e,t){let r=x0(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let s=he(i).withIndex(e._queryParams.getIndex());_f(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=no(n.serverSyncTree_,e._path,s);else{let a=Js(n.serverSyncTree_,e);o=Ky(n.serverSyncTree_,e._path,s,a)}return Ct(n.eventQueue_,e._path,o),nl(n.serverSyncTree_,e,t,null,!0),s},i=>(hl(n,"get for query "+te(e)+" failed: "+i),Promise.reject(new Error(i))))}function iP(n,e,t,r,i){hl(n,"set",{path:e.toString(),value:t,priority:r});let s=Gf(n),o=he(t,r),a=Uf(n.serverSyncTree_,e),c=Qy(o,a,s),l=uE(n),u=qy(n.serverSyncTree_,e,c,l,!0);zf(n.eventQueue_,u),n.server_.put(e.toString(),o.val(!0),(f,p)=>{let _=f==="ok";_||Re("set at "+e+" failed: "+f);let y=Kn(n.serverSyncTree_,l,!_);Ct(n.eventQueue_,e,y),cP(n,i,f,p)});let d=mE(n,e);fl(n,d),Ct(n.eventQueue_,d,[])}function sP(n){hl(n,"onDisconnectEvents");let e=Gf(n),t=zc();sf(n.onDisconnect_,F(),(i,s)=>{let o=$0(i,s,n.serverSyncTree_,e);Ny(t,i,o)});let r=[];sf(t,F(),(i,s)=>{r=r.concat(no(n.serverSyncTree_,i,s));let o=mE(n,i);fl(n,o)}),n.onDisconnect_=zc(),Ct(n.eventQueue_,F(),r)}function oP(n,e,t){let r;A(e._path)===".info"?r=_f(n.infoSyncTree_,e,t):r=_f(n.serverSyncTree_,e,t),aE(n.eventQueue_,e._path,r)}function ey(n,e,t){let r;A(e._path)===".info"?r=nl(n.infoSyncTree_,e,t):r=nl(n.serverSyncTree_,e,t),aE(n.eventQueue_,e._path,r)}function aP(n){n.persistentConnection_&&n.persistentConnection_.interrupt(Z0)}function hl(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),ye(t,...e)}function cP(n,e,t,r){e&&ci(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function dE(n,e,t){return Uf(n.serverSyncTree_,e,t)||T.EMPTY_NODE}function Kf(n,e=n.transactionQueueTree_){if(e||pl(n,e),li(e)){let t=fE(n,e);g(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&lP(n,io(e),t)}else eE(e)&&dl(e,t=>{Kf(n,t)})}function lP(n,e,t){let r=t.map(l=>l.currentWriteId),i=dE(n,e,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let u=t[l];g(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let d=Ce(e,u.path);s=s.updateChild(d,u.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,l=>{hl(n,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){let d=[];for(let f=0;f<t.length;f++)t[f].status=2,u=u.concat(Kn(n.serverSyncTree_,t[f].currentWriteId)),t[f].onComplete&&d.push(()=>t[f].onComplete(null,!0,t[f].currentOutputSnapshotResolved)),t[f].unwatcher();pl(n,$f(n.transactionQueueTree_,e)),Kf(n,n.transactionQueueTree_),Ct(n.eventQueue_,e,u);for(let f=0;f<d.length;f++)ci(d[f])}else{if(l==="datastale")for(let d=0;d<t.length;d++)t[d].status===3?t[d].status=4:t[d].status=0;else{Re("transaction at "+c.toString()+" failed: "+l);for(let d=0;d<t.length;d++)t[d].status=4,t[d].abortReason=l}fl(n,e)}},o)}function fl(n,e){let t=hE(n,e),r=io(t),i=fE(n,t);return uP(n,i,r),r}function uP(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=Ce(t,c.path),u=!1,d;if(g(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,d=c.abortReason,i=i.concat(Kn(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=eP)u=!0,d="maxretry",i=i.concat(Kn(n.serverSyncTree_,c.currentWriteId,!0));else{let f=dE(n,c.path,o);c.currentInputSnapshot=f;let p=e[a].update(f.val());if(p!==void 0){Hf("transaction failed: Data returned ",p,c.path);let _=he(p);typeof p=="object"&&p!=null&&ke(p,".priority")||(_=_.updatePriority(f.getPriority()));let w=c.currentWriteId,G=Gf(n),oe=Qy(_,f,G);c.currentOutputSnapshotRaw=_,c.currentOutputSnapshotResolved=oe,c.currentWriteId=uE(n),o.splice(o.indexOf(w),1),i=i.concat(qy(n.serverSyncTree_,c.path,oe,c.currentWriteId,c.applyLocally)),i=i.concat(Kn(n.serverSyncTree_,w,!0))}else u=!0,d="nodata",i=i.concat(Kn(n.serverSyncTree_,c.currentWriteId,!0))}Ct(n.eventQueue_,t,i),i=[],u&&(e[a].status=2,function(f){setTimeout(f,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}pl(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)ci(r[a]);Kf(n,n.transactionQueueTree_)}function hE(n,e){let t,r=n.transactionQueueTree_;for(t=A(e);t!==null&&li(r)===void 0;)r=$f(r,t),e=z(e),t=A(e);return r}function fE(n,e){let t=[];return pE(n,e,t),t.sort((r,i)=>r.order-i.order),t}function pE(n,e,t){let r=li(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);dl(e,i=>{pE(n,i,t)})}function pl(n,e){let t=li(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,Zy(e,t.length>0?t:void 0)}dl(e,r=>{pl(n,r)})}function mE(n,e){let t=io(hE(n,e)),r=$f(n.transactionQueueTree_,e);return z0(r,i=>{Nh(n,i)}),Nh(n,r),tE(r,i=>{Nh(n,i)}),t}function Nh(n,e){let t=li(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(g(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(g(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Kn(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?Zy(e,void 0):t.length=s+1,Ct(n.eventQueue_,io(e),i);for(let o=0;o<r.length;o++)ci(r[o])}}function dP(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function hP(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Re(`Invalid query segment '${t}' in query '${n}'`)}return e}var ty=function(n,e){let t=fP(n),r=t.namespace;t.domain==="firebase.com"&&$t(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&$t("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||YR();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Fc(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new j(t.pathString)}},fP=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let u=n.indexOf("/");u===-1&&(u=n.length);let d=n.indexOf("?");d===-1&&(d=n.length),e=n.substring(0,Math.min(u,d)),u<d&&(i=dP(n.substring(u,d)));let f=hP(n.substring(Math.min(n.length,d)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let p=e.slice(0,l);if(p.toLowerCase()==="localhost")t="localhost";else if(p.split(".").length<=2)t=p;else{let _=e.indexOf(".");r=e.substring(0,_).toLowerCase(),t=e.substring(_+1),s=r}"ns"in f&&(s=f.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var ny="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",pP=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=ny.charAt(t%64),t=Math.floor(t/64);g(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=ny.charAt(e[i]);return g(o.length===20,"nextPushId: Length should be 20."),o}}();var rl=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+te(this.snapshot.exportVal())}},il=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var sl=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return g(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var If=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return D(this._path)?null:Iy(this._path)}get ref(){return new It(this._repo,this._path)}get _queryIdentifier(){let e=jv(this._queryParams),t=Af(e);return t==="{}"?"default":t}get _queryObject(){return jv(this._queryParams)}isEqual(e){if(e=I(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=Df(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+AA(this._path)}};var It=class n extends If{constructor(e,t){super(e,t,new tf,!1)}get parent(){let e=Sy(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Qs=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new j(e),r=Ht(this.ref,e);return new n(this._node.getChild(t),r,Y)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,Ht(this.ref,r),Y)))}hasChild(e){let t=new j(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function ml(n,e){return n=I(n),n._checkNotDeleted("ref"),e!==void 0?Ht(n._root,e):n._root}function Ht(n,e){return n=I(n),A(n._path)===null?J0("child","path",e,!1):sE("child","path",e,!1),new It(n._repo,se(n._path,e))}function Yf(n,e){n=I(n),oE("push",n._path),iE("push",e,n._path,!0);let t=lE(n._repo),r=pP(t),i=Ht(n,r),s=Ht(n,r),o;return e!=null?o=gl(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function gl(n,e){n=I(n),oE("set",n._path),iE("set",e,n._path,!1);let t=new rn;return iP(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function Jf(n){n=I(n);let e=new sl(()=>{}),t=new ol(e);return rP(n._repo,n,t).then(r=>new Qs(r,new It(n._repo,n._path),n._queryParams.getIndex()))}var ol=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new rl("value",this,new Qs(e.snapshotNode,new It(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new il(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},bf=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new il(this,e,t):null}createEvent(e,t){g(e.childName!=null,"Child events should have a childName.");let r=Ht(new It(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new rl(e.type,this,new Qs(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function mP(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=t,l=(u,d)=>{ey(n._repo,n,a),c(u,d)};l.userCallback=t.userCallback,l.context=t.context,t=l}let o=new sl(t,s||void 0),a=e==="value"?new ol(o):new bf(e,o);return oP(n._repo,n,a),()=>ey(n._repo,n,a)}function Xf(n,e,t,r){return mP(n,"value",e,t,r)}I0(It);A0(It);var gP="FIREBASE_DATABASE_EMULATOR_HOST",Sf={},_P=!1;function vP(n,e,t,r){let i=e.lastIndexOf(":"),s=e.substring(0,i),o=kr(s);n.repoInfo_=new Fc(e,o,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),r&&(n.authTokenProvider_=r)}function yP(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||$t("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ye("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=ty(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[gP]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=ty(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let u=i&&c?new Ws(Ws.OWNER):new Uh(n.name,n.options,e);X0("Invalid Firebase Database URL",o),D(o.path)||$t("Database URL must point to the root of a Firebase Database (not including a child path).");let d=wP(a,n,u,new Fh(n,t));return new Tf(d,n)}function EP(n,e){let t=Sf[e];(!t||t[n.key]!==n)&&$t(`Database ${e}(${n.repoInfo_}) has already been deleted.`),aP(n),delete t[n.key]}function wP(n,e,t,r){let i=Sf[e.name];i||(i={},Sf[e.name]=i);let s=i[n.toURLString()];return s&&$t("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Cf(n,_P,t,r),i[n.toURLString()]=s,s}var Tf=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(tP(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new It(this._repo,F())),this._rootInternal}_delete(){return this._rootInternal!==null&&(EP(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&$t("Cannot call "+e+" on a deleted database.")}};function Qf(n=us(),e){let t=xn(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let r=Zg("database");r&&gE(t,...r)}return t}function gE(n,e,t,r={}){n=I(n),n._checkNotDeleted("useEmulator");let i=`${e}:${t}`,s=n._repoInternal;if(n._instanceStarted){if(i===n._repoInternal.repoInfo_.host&&dt(r,s.repoInfo_.emulatorOptions))return;$t("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&$t('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Ws(Ws.OWNER);else if(r.mockUserToken){let a=typeof r.mockUserToken=="string"?r.mockUserToken:e_(r.mockUserToken,n.app.options.projectId);o=new Ws(a)}kr(e)&&ba(e),vP(s,i,r,o)}function CP(n){GR(Xe),Je(new _e("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return yP(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),ue(Iv,bv,n),ue(Iv,bv,"esm2017")}Of.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Of.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};CP();function Zn(){return window}var IP=2e3;function bP(n,e,t){return h(this,null,function*(){var r;let{BuildInfo:i}=Zn();He(e.sessionId,"AuthEvent did not contain a session ID");let s=yield PP(e.sessionId),o={};return zr()?o.ibi=i.packageName:Hr()?o.apn=i.packageName:Z(n,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,qa(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)})}function SP(n){return h(this,null,function*(){let{BuildInfo:e}=Zn(),t={};zr()?t.iosBundleId=e.packageName:Hr()?t.androidPackageName=e.packageName:Z(n,"operation-not-supported-in-this-environment"),yield bh(n,t)})}function TP(n){let{cordova:e}=Zn();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,nv()?"_blank":"_system","location=yes"),t(i)})})}function RP(n,e,t){return h(this,null,function*(){let{cordova:r}=Zn(),i=()=>{};try{yield new Promise((s,o)=>{let a=null;function c(){var d;s();let f=(d=r.plugins.browsertab)===null||d===void 0?void 0:d.close;typeof f=="function"&&f(),typeof t?.close=="function"&&t.close()}function l(){a||(a=window.setTimeout(()=>{o(re(n,"redirect-cancelled-by-user"))},IP))}function u(){document?.visibilityState==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),Hr()&&document.addEventListener("visibilitychange",u,!1),i=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",u,!1),a&&window.clearTimeout(a)}})}finally{i()}})}function AP(n){var e,t,r,i,s,o,a,c,l,u;let d=Zn();m(typeof((e=d?.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),m(typeof((t=d?.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),m(typeof((s=(i=(r=d?.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),m(typeof((c=(a=(o=d?.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),m(typeof((u=(l=d?.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||u===void 0?void 0:u.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function PP(n){return h(this,null,function*(){let e=DP(n),t=yield crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")})}function DP(n){if(He(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);let e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}var OP=20,Zf=class extends bs{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}initialized(){return h(this,null,function*(){yield this.initPromise})}};function NP(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:xP(),postBody:null,tenantId:n.tenantId,error:re(n,"no-auth-event")}}function MP(n,e){return ep()._set(tp(n),e)}function _E(n){return h(this,null,function*(){let e=yield ep()._get(tp(n));return e&&(yield ep()._remove(tp(n))),e})}function kP(n,e){var t,r;let i=FP(e);if(i.includes("/__/auth/callback")){let s=_l(i),o=s.firebaseError?LP(decodeURIComponent(s.firebaseError)):null,a=(r=(t=o?.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],c=a?re(a):null;return c?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function xP(){let n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<OP;t++){let r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function ep(){return ve(_t)}function tp(n){return gt("authEvent",n.config.apiKey,n.name)}function LP(n){try{return JSON.parse(n)}catch{return null}}function FP(n){let e=_l(n),t=e.link?decodeURIComponent(e.link):void 0,r=_l(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return _l(i).link||i||r||t||n}function _l(n){if(!n?.includes("?"))return{};let[e,...t]=n.split("?");return sn(t.join("?"))}var UP=500,np=class{constructor(){this._redirectPersistence=Te,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=zn,this._overrideRedirectResult=Yr}_initialize(e){return h(this,null,function*(){let t=e._key(),r=this.eventManagers.get(t);return r||(r=new Zf(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r})}_openPopup(e){Z(e,"operation-not-supported-in-this-environment")}_openRedirect(e,t,r,i){return h(this,null,function*(){AP(e);let s=yield this._initialize(e);yield s.initialized(),s.resetRedirect(),mv(),yield this._originValidation(e);let o=NP(e,r,i);yield MP(e,o);let a=yield bP(e,o,t),c=yield TP(a);return RP(e,s,c)})}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=SP(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){let{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Zn(),o=setTimeout(()=>h(null,null,function*(){yield _E(e),t.onEvent(vE())}),UP),a=u=>h(null,null,function*(){clearTimeout(o);let d=yield _E(e),f=null;d&&u?.url&&(f=kP(d,u.url)),t.onEvent(f||vE())});typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);let c=i,l=`${s.packageName.toLowerCase()}://`;Zn().handleOpenURL=u=>h(null,null,function*(){if(u.toLowerCase().startsWith(l)&&a({url:u}),typeof c=="function")try{c(u)}catch(d){console.error(d)}})}},yE=np;function vE(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:re("no-auth-event")}}function EE(n,e){H(n)._logFramework(e)}var jP="@firebase/auth-compat",BP="0.5.22";var WP=1e3;function ao(){var n;return((n=self?.location)===null||n===void 0?void 0:n.protocol)||null}function $P(){return ao()==="http:"||ao()==="https:"}function IE(n=Q()){return!!((ao()==="file:"||ao()==="ionic:"||ao()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function HP(){return Nn()||hd()}function zP(){return wa()&&document?.documentMode===11}function GP(n=Q()){return/Edge\/\d+/.test(n)}function qP(n=Q()){return zP()||GP(n)}function bE(){try{let n=self.localStorage,e=$n();if(n)return n.setItem(e,"1"),n.removeItem(e),qP()?Nr():!0}catch{return cp()&&Nr()}return!1}function cp(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function rp(){return($P()||Ea()||IE())&&!HP()&&bE()&&!cp()}function SE(){return IE()&&typeof document<"u"}function KP(){return h(this,null,function*(){return SE()?new Promise(n=>{let e=setTimeout(()=>{n(!1)},WP);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1})}function YP(){return typeof window<"u"?window:null}var xe={LOCAL:"local",NONE:"none",SESSION:"session"},so=m,TE="persistence";function JP(n,e){if(so(Object.values(xe).includes(e),n,"invalid-persistence-type"),Nn()){so(e!==xe.SESSION,n,"unsupported-persistence-type");return}if(hd()){so(e===xe.NONE,n,"unsupported-persistence-type");return}if(cp()){so(e===xe.NONE||e===xe.LOCAL&&Nr(),n,"unsupported-persistence-type");return}so(e===xe.NONE||bE(),n,"unsupported-persistence-type")}function ip(n){return h(this,null,function*(){yield n._initializationPromise;let e=RE(),t=gt(TE,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistenceType())})}function XP(n,e){let t=RE();if(!t)return[];let r=gt(TE,n,e);switch(t.getItem(r)){case xe.NONE:return[Vt];case xe.LOCAL:return[Wt,Te];case xe.SESSION:return[Te];default:return[]}}function RE(){var n;try{return((n=YP())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}var QP=m,bt=class{constructor(){this.browserResolver=ve(xs),this.cordovaResolver=ve(yE),this.underlyingResolver=null,this._redirectPersistence=Te,this._completeRedirectFn=zn,this._overrideRedirectResult=Yr}_initialize(e){return h(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)})}_openPopup(e,t,r,i){return h(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)})}_openRedirect(e,t,r,i){return h(this,null,function*(){return yield this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)})}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return SE()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return QP(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){return h(this,null,function*(){if(this.underlyingResolver)return;let e=yield KP();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver})}};function AE(n){return n.unwrap()}function ZP(n){return n.wrapped()}function eD(n){return PE(n)}function tD(n,e){var t;let r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){let i=e;i.resolver=new op(n,yc(n,e))}else if(r){let i=PE(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function PE(n){let{_tokenResponse:e}=n instanceof le?n.customData:n;if(!e)return null;if(!(n instanceof le)&&"temporaryProof"in e&&"phoneNumber"in e)return hn.credentialFromResult(n);let t=e.providerId;if(!t||t===dn.PASSWORD)return null;let r;switch(t){case dn.GOOGLE:r=Ps;break;case dn.FACEBOOK:r=As;break;case dn.GITHUB:r=Ds;break;case dn.TWITTER:r=Os;break;default:let{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!s&&!o&&!i&&!a?null:a?t.startsWith("saml.")?Vn._create(t,a):ze._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:i,accessToken:s}):new Un(t).credential({idToken:i,accessToken:s,rawNonce:c})}return n instanceof le?r.credentialFromError(n):r.credentialFromResult(n)}function De(n,e){return e.catch(t=>{throw t instanceof le&&tD(n,t),t}).then(t=>{let r=t.operationType,i=t.user;return{operationType:r,credential:eD(t),additionalUserInfo:gc(t),user:ui.getOrCreate(i)}})}function sp(n,e){return h(this,null,function*(){let t=yield e;return{verificationId:t.verificationId,confirm:r=>De(n,t.confirm(r))}})}var op=class{constructor(e,t){this.resolver=t,this.auth=ZP(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return De(AE(this.auth),this.resolver.resolveSignIn(e))}};var ui=class n{constructor(e){this._delegate=e,this.multiFactor=Ec(e)}static getOrCreate(e){return n.USER_MAP.has(e)||n.USER_MAP.set(e,new n(e)),n.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}linkWithCredential(e){return h(this,null,function*(){return De(this.auth,Ns(this._delegate,e))})}linkWithPhoneNumber(e,t){return h(this,null,function*(){return sp(this.auth,Ic(this._delegate,e,t))})}linkWithPopup(e){return h(this,null,function*(){return De(this.auth,Pc(this._delegate,e,bt))})}linkWithRedirect(e){return h(this,null,function*(){return yield ip(H(this.auth)),Nc(this._delegate,e,bt)})}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}reauthenticateWithCredential(e){return h(this,null,function*(){return De(this.auth,Ms(this._delegate,e))})}reauthenticateWithPhoneNumber(e,t){return sp(this.auth,bc(this._delegate,e,t))}reauthenticateWithPopup(e){return De(this.auth,Ac(this._delegate,e,bt))}reauthenticateWithRedirect(e){return h(this,null,function*(){return yield ip(H(this.auth)),Oc(this._delegate,e,bt)})}sendEmailVerification(e){return dc(this._delegate,e)}unlink(e){return h(this,null,function*(){return yield Qa(this._delegate,e),this})}updateEmail(e){return pc(this._delegate,e)}updatePassword(e){return mc(this._delegate,e)}updatePhoneNumber(e){return Tc(this._delegate,e)}updateProfile(e){return fc(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return hc(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};ui.USER_MAP=new WeakMap;var oo=m,wE=(()=>{class n{constructor(t,r){if(this.app=t,r.isInitialized()){this._delegate=r.getImmediate(),this.linkUnderlyingAuth();return}let{apiKey:i}=t.options;oo(i,"invalid-api-key",{appName:t.name}),oo(i,"invalid-api-key",{appName:t.name});let s=typeof window<"u"?bt:void 0;this._delegate=r.initialize({options:{persistence:nD(i,t.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(Ka),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?ui.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(t){this._delegate.languageCode=t}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(t){this._delegate.tenantId=t}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(t,r){Rs(this._delegate,t,r)}applyActionCode(t){return ic(this._delegate,t)}checkActionCode(t){return ks(this._delegate,t)}confirmPasswordReset(t,r){return rc(this._delegate,t,r)}createUserWithEmailAndPassword(t,r){return h(this,null,function*(){return De(this._delegate,oc(this._delegate,t,r))})}fetchProvidersForEmail(t){return this.fetchSignInMethodsForEmail(t)}fetchSignInMethodsForEmail(t){return uc(this._delegate,t)}isSignInWithEmailLink(t){return cc(this._delegate,t)}getRedirectResult(){return h(this,null,function*(){oo(rp(),this._delegate,"operation-not-supported-in-this-environment");let t=yield Mc(this._delegate,bt);return t?De(this._delegate,Promise.resolve(t)):{credential:null,user:null}})}addFrameworkForLogging(t){EE(this._delegate,t)}onAuthStateChanged(t,r,i){let{next:s,error:o,complete:a}=CE(t,r,i);return this._delegate.onAuthStateChanged(s,o,a)}onIdTokenChanged(t,r,i){let{next:s,error:o,complete:a}=CE(t,r,i);return this._delegate.onIdTokenChanged(s,o,a)}sendSignInLinkToEmail(t,r){return ac(this._delegate,t,r)}sendPasswordResetEmail(t,r){return nc(this._delegate,t,r||void 0)}setPersistence(t){return h(this,null,function*(){JP(this._delegate,t);let r;switch(t){case xe.SESSION:r=Te;break;case xe.LOCAL:r=(yield ve(Wt)._isAvailable())?Wt:_t;break;case xe.NONE:r=Vt;break;default:return Z("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(r)})}signInAndRetrieveDataWithCredential(t){return this.signInWithCredential(t)}signInAnonymously(){return De(this._delegate,Xa(this._delegate))}signInWithCredential(t){return De(this._delegate,Wn(this._delegate,t))}signInWithCustomToken(t){return De(this._delegate,ec(this._delegate,t))}signInWithEmailAndPassword(t,r){return De(this._delegate,qr(this._delegate,t,r))}signInWithEmailLink(t,r){return De(this._delegate,lc(this._delegate,t,r))}signInWithPhoneNumber(t,r){return sp(this._delegate,Cc(this._delegate,t,r))}signInWithPopup(t){return h(this,null,function*(){return oo(rp(),this._delegate,"operation-not-supported-in-this-environment"),De(this._delegate,Rc(this._delegate,t,bt))})}signInWithRedirect(t){return h(this,null,function*(){return oo(rp(),this._delegate,"operation-not-supported-in-this-environment"),yield ip(this._delegate),Dc(this._delegate,t,bt)})}updateCurrentUser(t){return this._delegate.updateCurrentUser(t)}verifyPasswordResetCode(t){return sc(this._delegate,t)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return n.Persistence=xe,n})();function CE(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);let i=r;return{next:o=>i(o&&ui.getOrCreate(o)),error:e,complete:t}}function nD(n,e){let t=XP(n,e);if(typeof self<"u"&&!t.includes(Wt)&&t.push(Wt),typeof window<"u")for(let r of[_t,Te])t.includes(r)||t.push(r);return t.includes(Vt)||t.push(Vt),t}var co=class{static credential(e,t){return hn.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new hn(AE(yt.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}};co.PHONE_SIGN_IN_METHOD=hn.PHONE_SIGN_IN_METHOD;co.PROVIDER_ID=hn.PROVIDER_ID;var rD=m,ap=class{constructor(e,t,r=yt.app()){var i;rD((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new Wr(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}};var iD="auth-compat";function sD(n){n.INTERNAL.registerComponent(new _e(iD,e=>{let t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new wE(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:jt.EMAIL_SIGNIN,PASSWORD_RESET:jt.PASSWORD_RESET,RECOVER_EMAIL:jt.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:jt.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:jt.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:jt.VERIFY_EMAIL}},EmailAuthProvider:Gr,FacebookAuthProvider:As,GithubAuthProvider:Ds,GoogleAuthProvider:Ps,OAuthProvider:Un,SAMLAuthProvider:Br,PhoneAuthProvider:co,PhoneMultiFactorGenerator:kc,RecaptchaVerifier:ap,TwitterAuthProvider:Os,Auth:wE,AuthCredential:Qe,Error:le}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(jP,BP)}sD(yt);var oD={apiKey:"AIzaSyCDtOwsoKre5oqjIoJsmBYzoxV7LR60qSw",authDomain:"dnd-chat-a8837.firebaseapp.com",projectId:"dnd-chat-a8837",storageBucket:"dnd-chat-a8837.firebasestorage.app",messagingSenderId:"864563449838",appId:"1:864563449838:web:7209ce2fc10397c6bd08ff",measurementId:"G-Y1WEV8SC08",databaseURL:"https://dnd-chat-a8837-default-rtdb.europe-west1.firebasedatabase.app"},lp=yt.initializeApp(oD),zk=yt.auth(),vl=Qf(lp);var aD="firebase",cD="11.7.1";ue(aD,cD,"app");function up(n){n===void 0&&(Ul(up),n=E(Yt));let e=n.get(fo);return t=>new zt(r=>{let i=e.add(),s=!1;function o(){s||(i(),s=!0)}let a=t.subscribe({next:c=>{r.next(c),o()},complete:()=>{r.complete(),o()},error:c=>{r.error(c),o()}});return a.add(()=>{r.unsubscribe(),o()}),a})}var di=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(di||{}),DE=Xl()&&typeof Zone<"u"?di.WARN:di.SILENT;var yl=class{zone;delegate;constructor(e,t=_p){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i?i.runGuarded(()=>{e.apply(this,[o])}):e.apply(this,[o])};return this.delegate.schedule(s,t,r)}},NE=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=E(Oe);this.outsideAngular=t.runOutsideAngular(()=>new yl(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new yl(typeof Zone>"u"?void 0:Zone.current,gp))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),OE=!1;function lD(n,e){!OE&&(DE>di.SILENT||Xl())&&(OE=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),DE>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function uD(n){let e=E(Oe,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function er(n){let e=E(Oe,{optional:!0});return e?e.run(()=>n()):n()}var dD=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),Ee(t,()=>er(()=>n.apply(void 0,r)))),ME=(n,e,t)=>(t||=e?di.WARN:di.VERBOSE,function(){let r,i=arguments,s,o,a;try{s=E(NE),o=E(fo),a=E(Kt)}catch{return lD(n,t),n.apply(this,i)}for(let l=0;l<arguments.length;l++)typeof i[l]=="function"&&(e&&(r||=er(()=>o.add())),i[l]=dD(i[l],r,a));let c=uD(()=>n.apply(this,i));return e?c instanceof zt?c.pipe(Nl(s.outsideAngular),Ol(s.insideAngular),up(a)):c instanceof Promise?er(()=>new Promise((l,u)=>{o.run(()=>c).then(d=>Ee(a,()=>er(()=>l(d))),d=>Ee(a,()=>er(()=>u(d))))})):typeof c=="function"&&r?function(){return setTimeout(r,0),c.apply(this,arguments)}:er(()=>c):c instanceof zt?c.pipe(Nl(s.outsideAngular),Ol(s.insideAngular)):er(()=>c)});var kE=ME(ml,!0,2);var _n=class n{auth=vt(lp);usernameRef;constructor(){this.usernameRef=kE(vl,"users")}login(e,t,r=!1){let i=r?_t:Te;return _c(this.auth,i).then(()=>qr(this.auth,e,t)).then(s=>s.user).catch(s=>{let o=s.code,a=s.message;throw console.error("Error during login:",o,a),s})}getCurrentUser(){return new Promise(e=>{let t=Kr(this.auth,r=>{t(),e(r)})})}isSignedIn(){return this.getCurrentUser().then(e=>!!e)}getUserNameById(e){let t=Ht(this.usernameRef,e);return Jf(t).then(r=>{if(r.exists()){console.log("Data found for user",e,":",r.val());let i=r.val();if(i)return i;throw console.log("Username not found for user",e),alert("Username not found for user "+e),new Error("Username not found")}else throw console.log("No data available for user:",e),alert("No data available for user "+e),new Error("No data available")}).catch(r=>{throw console.error("Error fetching data for user",e,":",r),alert("Error fetching data for user "+e+": "+r),r})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})};function hD(n,e){if(n&1&&(R(0,"div",20),X(1),L()),n&2){let t=Be();J(),Jl(" ",t.error," ")}}function fD(n,e){n&1&&(R(0,"div",21),X(1," Please enter a valid email "),L())}function pD(n,e){n&1&&(R(0,"div",21),X(1," Password must be at least 6 characters long "),L())}var El=class n{constructor(e,t,r){this.fb=e;this.authService=t;this.router=r;this.loginForm=this.fb.group({email:["",[Mt.required,Mt.email]],password:["",[Mt.required,Mt.minLength(6)]],rememberMe:[!1]})}loginForm;error="";loading=!1;ngOnInit(){this.authService.isSignedIn().then(e=>{e&&this.router.navigate(["/chat"])})}onSubmit(){if(this.error="",this.loading=!0,this.loginForm.valid){let{email:e,password:t,rememberMe:r}=this.loginForm.value;this.authService.login(e,t,r).then(()=>{this.loading=!1,this.router.navigate(["/chat"])}).catch(i=>{this.loading=!1,this.error=i.message})}}static \u0275fac=function(t){return new(t||n)(W(ga),W(_n),W(lt))};static \u0275cmp=Ie({type:n,selectors:[["app-signin"]],decls:30,vars:6,consts:[[1,"flex","min-h-full","flex-col","justify-center","px-4","py-12","sm:px-6","lg:px-8"],[1,"sm:mx-auto","sm:w-full","sm:max-w-md"],[1,"rounded-lg","border","border-gray-200","bg-white","px-4","py-8","shadow-lg","transition-all","duration-300","hover:shadow-xl","sm:px-10"],[1,"flex","flex-col","items-center"],["src","https://tailwindcss.com/plus-assets/img/logos/mark.svg?color=indigo&shade=600","alt","D&D Chat",1,"h-12","w-auto"],[1,"text-md","mt-6","text-center","font-bold","tracking-tight","text-gray-900","md:text-lg"],[1,"mt-8"],["class","mb-4 text-center text-base text-red-600 md:text-lg",4,"ngIf"],[1,"space-y-6",3,"ngSubmit","formGroup"],["for","email",1,"block","text-sm","font-medium","text-gray-900","md:text-base","lg:text-lg"],[1,"mt-2"],["type","email","name","email","id","email","formControlName","email","autocomplete","email","placeholder","Enter your email",1,"block","w-full","rounded-md","border","border-gray-300","bg-white","px-3","py-2","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","placeholder:text-gray-400","focus:outline-2","focus:-outline-offset-2","focus:outline-indigo-600","sm:text-sm/6","md:py-3","md:text-lg","lg:py-4"],["class","mt-1 text-sm text-red-600 md:text-base",4,"ngIf"],[1,"flex","items-center","justify-between"],["for","password",1,"block","text-sm","font-medium","text-gray-900"],["type","password","name","password","id","password","formControlName","password","autocomplete","current-password","placeholder","Enter your password",1,"block","w-full","rounded-md","border","border-gray-300","bg-white","px-3","py-2","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","placeholder:text-gray-400","focus:outline-2","focus:-outline-offset-2","focus:outline-indigo-600","sm:text-sm/6","md:py-3","md:text-lg","lg:py-4"],[1,"flex","items-center"],["id","remember-me","name","remember-me","type","checkbox","formControlName","rememberMe",1,"h-4","w-4","rounded","border-gray-300","text-indigo-600","focus:ring-indigo-600"],["for","remember-me",1,"ml-2","block","text-sm","text-gray-900"],["type","submit",1,"flex","w-full","justify-center","rounded-md","bg-indigo-600","px-3","py-2","text-sm","font-semibold","text-white","shadow-sm","transition-colors","duration-200","hover:bg-indigo-500","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-indigo-600","disabled:bg-indigo-300","md:py-3","md:text-base","lg:py-4","lg:text-lg",3,"disabled"],[1,"mb-4","text-center","text-base","text-red-600","md:text-lg"],[1,"mt-1","text-sm","text-red-600","md:text-base"]],template:function(t,r){if(t&1&&(R(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),fe(4,"img",4),R(5,"h2",5),X(6," Sign in to your account "),L()(),R(7,"div",6),je(8,hD,2,1,"div",7),R(9,"form",8),we("ngSubmit",function(){return r.onSubmit()}),R(10,"div")(11,"label",9),X(12,"Email address"),L(),R(13,"div",10),fe(14,"input",11),L(),je(15,fD,2,0,"div",12),L(),R(16,"div")(17,"div",13)(18,"label",14),X(19,"Password"),L()(),R(20,"div",10),fe(21,"input",15),L(),je(22,pD,2,0,"div",12),L(),R(23,"div",16),fe(24,"input",17),R(25,"label",18),X(26,"Remember me"),L()(),R(27,"div")(28,"button",19),X(29),L()()()()()()()),t&2){let i,s;J(8),ee("ngIf",r.error),J(),ee("formGroup",r.loginForm),J(6),ee("ngIf",((i=r.loginForm.get("email"))==null?null:i.invalid)&&((i=r.loginForm.get("email"))==null?null:i.touched)),J(7),ee("ngIf",((s=r.loginForm.get("password"))==null?null:s.invalid)&&((s=r.loginForm.get("password"))==null?null:s.touched)),J(6),ee("disabled",r.loginForm.invalid||r.loading),J(),Jl(" ",r.loading?"Loading...":"Sign in"," ")}},dependencies:[qe,or,Pr,ma,Ar,Yu,da,ha,ns,rs,Kg],encapsulation:2})};var wl=class n{constructor(e){this.router=e}logoutEvent=new ie;logoPath="/assets/logo.png";logout(){let e=vt();vc(e).then(()=>{this.router.navigate(["/signin"])}).catch(t=>{console.error("Error signing out: ",t)})}static \u0275fac=function(t){return new(t||n)(W(lt))};static \u0275cmp=Ie({type:n,selectors:[["app-chat-header"]],outputs:{logoutEvent:"logoutEvent"},decls:7,vars:1,consts:[[1,"flex","items-center","justify-between","border-b","border-gray-200","bg-white","px-4","py-3","shadow-sm"],[1,"flex","items-center"],["alt","D&D Logo",1,"mr-2","h-8","w-8",3,"src"],[1,"text-xl","font-bold","text-blue-600"],[1,"rounded","bg-red-500","px-4","py-2","text-white","transition","duration-200","hover:bg-red-600","focus:outline-none",3,"click"]],template:function(t,r){t&1&&(R(0,"header",0)(1,"div",1),fe(2,"img",2),R(3,"h1",3),X(4,"D&D Chat"),L()(),R(5,"button",4),we("click",function(){return r.logout()}),X(6," Logout "),L()()),t&2&&(J(2),ee("src",r.logoPath,Lp))},dependencies:[qe],encapsulation:2})};var mD=(n,e)=>({"bg-primary/20 text-primary":n,"hover:bg-base-300":e});function gD(n,e){if(n&1){let t=Ci();R(0,"div",7),we("click",function(){let i=gi(t).$implicit,s=Be(2);return _i(s.selectCommand(i))}),R(1,"span",8),X(2),L(),R(3,"span",9),X(4),L()()}if(n&2){let t=e.$implicit,r=e.index,i=Be(2);ee("ngClass",zp(3,mD,i.selectedIndex===r,i.selectedIndex!==r)),J(2),Yl(t.name),J(2),Yl(t.description)}}function _D(n,e){n&1&&(R(0,"div",10),X(1," No commands match your search "),L())}function vD(n,e){if(n&1&&(R(0,"div",1)(1,"div",2)(2,"div",3),X(3," Available Commands "),L(),R(4,"div",4),je(5,gD,5,6,"div",5)(6,_D,2,0,"div",6),L()()()),n&2){let t=Be();J(5),ee("ngForOf",t.filteredCommands),J(),ee("ngIf",t.filteredCommands.length===0)}}var Cl=class n{isVisible=!1;commands=[];filterText="";commandSelected=new ie;filteredCommands=[];selectedIndex=0;ngOnInit(){this.updateFilteredCommands()}ngOnChanges(){this.updateFilteredCommands(),this.selectedIndex=0}updateFilteredCommands(){if(!this.filterText||this.filterText==="/")this.filteredCommands=this.commands;else{let e=this.filterText.toLowerCase().substring(1);this.filteredCommands=this.commands.filter(t=>t.name.toLowerCase().substring(1).includes(e)||t.description.toLowerCase().includes(e))}}selectCommand(e){this.commandSelected.emit(e)}selectNextCommand(){this.filteredCommands.length!==0&&(this.selectedIndex=(this.selectedIndex+1)%this.filteredCommands.length)}selectPreviousCommand(){this.filteredCommands.length!==0&&(this.selectedIndex=this.selectedIndex<=0?this.filteredCommands.length-1:this.selectedIndex-1)}getSelectedCommand(){return this.filteredCommands.length===0?null:this.filteredCommands[this.selectedIndex]}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ie({type:n,selectors:[["app-command-menu"]],inputs:{isVisible:"isVisible",commands:"commands",filterText:"filterText"},outputs:{commandSelected:"commandSelected"},features:[wn],decls:1,vars:1,consts:[["class","absolute bottom-full left-0 z-20 w-full pb-2",4,"ngIf"],[1,"absolute","bottom-full","left-0","z-20","w-full","pb-2"],[1,"border-base-300","flex","max-h-64","flex-col","overflow-hidden","rounded-xl","border","bg-white","shadow-xl"],[1,"text-base-content/70","bg-base-300","border-base-300","border-b","px-4","py-2","text-sm","font-semibold"],[1,"overflow-y-auto","py-1"],["class","flex cursor-pointer select-none flex-col gap-0.5 px-4 py-2 transition-colors",3,"ngClass","click",4,"ngFor","ngForOf"],["class","text-base-content/50 px-4 py-3 text-center text-sm italic",4,"ngIf"],[1,"flex","cursor-pointer","select-none","flex-col","gap-0.5","px-4","py-2","transition-colors",3,"click","ngClass"],[1,"text-base-content","font-medium"],[1,"text-base-content/60","text-xs"],[1,"text-base-content/50","px-4","py-3","text-center","text-sm","italic"]],template:function(t,r){t&1&&je(0,vD,7,2,"div",0),t&2&&ee("ngIf",r.isVisible)},dependencies:[qe,Zp,_o,or],encapsulation:2})};var hi=class n{messagesRef;unsubscribeMessages=null;messagesSubject=new pe([]);messages$=this.messagesSubject.asObservable();constructor(){this.messagesRef=ml(vl,"messages")}subscribeToMessages(){this.unsubscribeMessages||(this.unsubscribeMessages=Xf(this.messagesRef,e=>{let t=e.val(),r=[];t&&Object.keys(t).forEach(i=>{let s=t[i];r.push({id:parseInt(i),content:s.content,username:s.username,user_id:s.user_id,created_at:new Date(s.created_at)})}),this.messagesSubject.next(r)}))}unsubscribeFromMessages(){this.unsubscribeMessages&&(this.unsubscribeMessages(),this.unsubscribeMessages=null)}sendMessage(e,t,r){let i=Yf(this.messagesRef),s={content:e,user_id:t,username:r,created_at:new Date().toISOString()};return gl(i,s).then(()=>{console.log("Message sent successfully!")}).catch(o=>{throw console.error("Error sending message:",o),o})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})};var Il=class n{constructor(e,t){this.chatService=e;this.authService=t}commands=[{id:"roll",name:"/roll",description:"Roll a dice (e.g., /roll d20)",action:e=>this.rollDice(e)},{id:"character",name:"/character",description:"Show character sheet",action:()=>this.showCharacter()},{id:"help",name:"/help",description:"Show available commands",action:()=>this.showHelp()},{id:"whisper",name:"/whisper",description:"Send a private message (e.g., /whisper @username message)",action:e=>this.whisperMessage(e)},{id:"clear",name:"/clear",description:"Clear current chat",action:()=>this.clearChat()}];showCommandsSubject=new pe(!1);showCommands$=this.showCommandsSubject.asObservable();systemUserName="DND Bot";systemUserId="system-bot-id";getCommands(){return this.commands}showCommandMenu(e){this.showCommandsSubject.next(e)}filterCommands(e){if(!e||e==="/")return this.commands;let t=e.toLowerCase().substring(1);return this.commands.filter(r=>r.name.toLowerCase().substring(1).includes(t)||r.description.toLowerCase().includes(t))}executeCommand(e,t){let r=this.commands.find(i=>i.id===e);r&&r.action&&r.action(t),console.log(`Executing command: ${e} with params: ${t}`)}rollDice(e){if(!e){console.log("Rolling default d20 dice...");let r=Math.floor(Math.random()*20)+1;this.sendSystemMessage(`\u{1F3B2} Rolled d20: ${r}`);return}let t=e.match(/d(\d+)/i);if(t&&t[1]){let r=parseInt(t[1],10),i=Math.floor(Math.random()*r)+1;this.sendSystemMessage(`\u{1F3B2} Rolled ${e}: ${i}`)}else this.sendSystemMessage("Invalid dice format. Use /roll d20, d12, d10, d8, d6, or d4.")}showCharacter(){this.sendSystemMessage("Character sheet feature coming soon!")}showHelp(){let e=`Available Commands:
`;this.commands.forEach(t=>{e+=`
${t.name} - ${t.description}`}),this.sendSystemMessage(e)}whisperMessage(e){if(!e){this.sendSystemMessage("Usage: /whisper @username your message");return}let t=e.match(/@(\w+)\s+(.*)/);if(t&&t[1]&&t[2]){let r=t[1],i=t[2];this.sendSystemMessage(`Private message to ${r}: ${i}`)}else this.sendSystemMessage("Invalid format. Use: /whisper @username your message")}clearChat(){this.sendSystemMessage("Chat cleared feature coming soon!")}sendSystemMessage(e){this.chatService.sendMessage(e,this.systemUserId,this.systemUserName).catch(t=>{console.error("Error sending system message:",t)})}static \u0275fac=function(t){return new(t||n)(N(hi),N(_n))};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})};var ED=["messageInput"];function wD(n,e){if(n&1){let t=Ci();R(0,"app-command-menu",6),we("commandSelected",function(i){gi(t);let s=Be();return _i(s.onCommandSelected(i))}),L()}if(n&2){let t,r=Be();ee("isVisible",r.showCommandMenu)("commands",r.commands)("filterText",((t=r.messageForm.get("content"))==null?null:t.value)||"")}}var bl=class n{constructor(e){this.commandService=e;this.commands=this.commandService.getCommands()}messageSent=new ie;messageInput;messageForm=new Rr({content:new br("")});showCommandMenu=!1;commands=[];inputSubscription;ngOnInit(){this.messageForm.get("content")?.valueChanges.pipe(Ip(100),bp()).subscribe(e=>{e&&typeof e=="string"?this.showCommandMenu=e.startsWith("/"):this.showCommandMenu=!1})}ngAfterViewInit(){this.inputSubscription=Cp(this.messageInput.nativeElement,"keydown").subscribe(e=>{if(this.showCommandMenu)if(e.key==="ArrowUp"||e.key==="ArrowDown"){e.preventDefault();let t=document.querySelector("app-command-menu");t&&(e.key==="ArrowDown"?t.selectNextCommand():t.selectPreviousCommand())}else if(e.key==="Tab"||e.key==="Enter"){if(this.showCommandMenu){e.preventDefault();let t=document.querySelector("app-command-menu");if(t){let r=t.getSelectedCommand();r&&this.onCommandSelected(r)}}}else e.key==="Escape"&&(this.showCommandMenu=!1)})}ngOnDestroy(){this.inputSubscription&&this.inputSubscription.unsubscribe()}sendMessage(){let e=this.messageForm.value.content;if(e){if(e.startsWith("/")){let t=e.split(" "),r=t[0].substring(1),i=this.commands.find(s=>s.id===r);if(i){let s=t.slice(1).join(" ");this.commandService.executeCommand(i.id,s),this.messageForm.reset();return}}this.messageSent.emit(e),this.messageForm.reset()}}onCommandSelected(e){this.messageForm.patchValue({content:e.name+" "}),this.showCommandMenu=!1,setTimeout(()=>{this.messageInput.nativeElement.focus();let t=this.messageInput.nativeElement.value.length;this.messageInput.nativeElement.setSelectionRange(t,t)})}static \u0275fac=function(t){return new(t||n)(W(Il))};static \u0275cmp=Ie({type:n,selectors:[["app-message-form"]],viewQuery:function(t,r){if(t&1&&Wp(ED,5),t&2){let i;$p(i=Hp())&&(r.messageInput=i.first)}},outputs:{messageSent:"messageSent"},decls:7,vars:2,consts:[["messageInput",""],[1,"message-form-container","my-2","ml-2"],[3,"isVisible","commands","filterText","commandSelected",4,"ngIf"],[1,"message-form",3,"ngSubmit","formGroup"],["type","text","placeholder","Type a message... (type / for commands)","formControlName","content",1,"form-control"],["type","submit",1,"btn","btn-primary"],[3,"commandSelected","isVisible","commands","filterText"]],template:function(t,r){if(t&1){let i=Ci();R(0,"div",1),je(1,wD,1,3,"app-command-menu",2),R(2,"form",3),we("ngSubmit",function(){return gi(i),_i(r.sendMessage())}),fe(3,"input",4,0),R(5,"button",5),X(6,"Send"),L()()()}t&2&&(J(),ee("ngIf",r.showCommandMenu),J(),ee("formGroup",r.messageForm))},dependencies:[Pr,ma,Ar,da,ha,ns,rs,qe,or,Cl],styles:[".message-form-container[_ngcontent-%COMP%]{position:relative;padding:0;background:none;border:none}.message-form[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;gap:.5rem}.message-form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{flex:1;padding:.5rem 1rem;border:1px solid #ccc;border-radius:9999px;font-size:1rem;color:#222;background:#fff;transition:border-color .2s}.message-form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#6366f1}.message-form[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{padding:.5rem 1.25rem;background:#6366f1;border:none;border-radius:9999px;color:#fff;font-weight:600;cursor:pointer;transition:background .2s}.message-form[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{background:#4f46e5}.command-hint[_ngcontent-%COMP%]{margin-top:8px;font-size:.8rem;color:#64748b;text-align:center;opacity:.7;animation:_ngcontent-%COMP%_fadeOut 3s forwards;animation-delay:3s}@keyframes _ngcontent-%COMP%_fadeOut{0%{opacity:.7}to{opacity:0}}"]})};var CD=()=>[_o,import("./chunk-7ULHGB2N.js").then(n=>n.MessageComponent)];function ID(n,e){if(n&1&&(R(0,"section"),fe(1,"app-message",5),L()),n&2){let t=e.$implicit,r=Be(2);J(),ee("message",t)("currentUserId",r.currentUserId)}}function bD(n,e){if(n&1&&je(0,ID,2,2,"section",4),n&2){let t=Be();ee("ngForOf",t.messages)}}function SD(n,e){n&1&&(R(0,"div",6),fe(1,"div",7),L())}function TD(n,e){n&1&&(R(0,"div",8)(1,"p"),X(2,"Error loading messages. Please try again later."),L()())}var Sl=class n{constructor(e,t,r){this.fb=e;this.chatService=t;this.authService=r;this.messageForm=this.fb.group({content:["",Mt.required]})}logout=new ie;messages=[];messageForm;currentUserId="";messageSubscription=null;ngOnInit(){this.chatService.subscribeToMessages(),this.messageSubscription=this.chatService.messages$.subscribe(r=>{this.messages=r});let t=vt().currentUser;t&&(this.currentUserId=t.uid)}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.chatService.unsubscribeFromMessages()}hashStringToNumber(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return Math.abs(t)}sendMessage(){if(this.messageForm.valid){let e=this.messageForm.value.content;this.authService.getUserNameById(this.currentUserId).then(t=>{this.chatService.sendMessage(e,this.currentUserId,t).then(()=>{this.messageForm.reset()}).catch(r=>{console.error("Error sending message:",r)})}).catch(t=>{console.error("Error fetching user name:",t)})}}onMessageSent(e){e&&this.authService.getUserNameById(this.currentUserId).then(t=>{this.chatService.sendMessage(e,this.currentUserId,t).then(()=>{}).catch(r=>{console.error("Error sending message:",r)})}).catch(t=>{console.error("Error fetching user name:",t)})}static \u0275fac=function(t){return new(t||n)(W(ga),W(hi),W(_n))};static \u0275cmp=Ie({type:n,selectors:[["app-chat"]],outputs:{logout:"logout"},decls:10,vars:1,consts:[[1,"container","flex","h-screen","flex-col","bg-white","lg:w-[60vw]"],[1,"flex-1","overflow-auto","p-4"],[1,"message-form-wrapper"],[3,"messageSent"],[4,"ngFor","ngForOf"],[3,"message","currentUserId"],[1,"flex","h-full","items-center","justify-center"],[1,"h-12","w-12","animate-spin","rounded-full","border-4","border-blue-500","border-t-transparent"],[1,"text-red-500"]],template:function(t,r){t&1&&(R(0,"div",0),fe(1,"app-chat-header"),R(2,"div",1),je(3,bD,1,1)(4,SD,2,0)(5,TD,3,0),jp(6,3,CD,null,4,5),L(),R(8,"div",2)(9,"app-message-form",3),we("messageSent",function(s){return r.onMessageSent(s)}),L()()()),t&2&&(J(6),Bp(r.messages.length>0))},dependencies:[qe,Pr,wl,bl],styles:[".chat-container[_ngcontent-%COMP%]{display:flex;height:100vh;overflow:hidden}.sidebar[_ngcontent-%COMP%]{width:300px;background-color:#2c3e50;color:#fff;display:flex;flex-direction:column}.sidebar-header[_ngcontent-%COMP%]{padding:1rem;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid rgba(255,255,255,.1)}.sidebar-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.sidebar-header[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{background:none;border:none;color:#fff;font-size:1.25rem;cursor:pointer}.sidebar-header[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:hover{color:#3498db}.create-room-form[_ngcontent-%COMP%]{padding:1rem;background-color:#0003}.create-room-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.5rem;margin-bottom:.5rem;border:1px solid #34495e;border-radius:4px;background-color:#ffffffe6}.create-room-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.create-room-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:.5rem}.create-room-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-right:.5rem}.room-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.room-list[_ngcontent-%COMP%]   .room-item[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid rgba(255,255,255,.1);cursor:pointer}.room-list[_ngcontent-%COMP%]   .room-item[_ngcontent-%COMP%]:hover{background-color:#ffffff1a}.room-list[_ngcontent-%COMP%]   .room-item.active[_ngcontent-%COMP%]{background-color:#3498db}.room-list[_ngcontent-%COMP%]   .room-item[_ngcontent-%COMP%]   .room-name[_ngcontent-%COMP%]{font-weight:700;margin-bottom:.25rem}.room-list[_ngcontent-%COMP%]   .room-item[_ngcontent-%COMP%]   .room-description[_ngcontent-%COMP%]{font-size:.85rem;opacity:.8;margin-bottom:.25rem}.room-list[_ngcontent-%COMP%]   .room-item[_ngcontent-%COMP%]   .member-count[_ngcontent-%COMP%]{font-size:.75rem;opacity:.6}.user-actions[_ngcontent-%COMP%]{padding:1rem;background-color:#0003}.user-actions[_ngcontent-%COMP%]   .btn-logout[_ngcontent-%COMP%]{width:100%;padding:.5rem;background-color:transparent;color:#fff;border:1px solid rgba(255,255,255,.3);border-radius:4px;cursor:pointer}.user-actions[_ngcontent-%COMP%]   .btn-logout[_ngcontent-%COMP%]:hover{background-color:#ffffff1a}.chat-area[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;background-color:#ecf0f1}.no-room-selected[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:2rem;color:#7f8c8d}.no-room-selected[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1rem}.chat-room[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}.chat-header[_ngcontent-%COMP%]{padding:1rem;background-color:#fff;display:flex;justify-content:space-between;align-items:center;box-shadow:0 2px 4px #0000001a}.chat-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.chat-header[_ngcontent-%COMP%]   .btn-leave[_ngcontent-%COMP%]{padding:.5rem 1rem;background-color:#e74c3c;color:#fff;border:none;border-radius:4px;cursor:pointer}.chat-header[_ngcontent-%COMP%]   .btn-leave[_ngcontent-%COMP%]:hover{background-color:#c0392b}.message-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:1rem;background-color:#fff}.message-container[_ngcontent-%COMP%]   .no-messages[_ngcontent-%COMP%]{display:flex;height:100%;align-items:center;justify-content:center;color:#95a5a6}.message-list[_ngcontent-%COMP%]   .message-item[_ngcontent-%COMP%]{margin-bottom:1rem;padding:.75rem;background-color:#ecf0f1;border-radius:8px;max-width:70%}.message-list[_ngcontent-%COMP%]   .message-item.own-message[_ngcontent-%COMP%]{margin-left:auto;background-color:#3498db;color:#fff}.message-list[_ngcontent-%COMP%]   .message-item.own-message[_ngcontent-%COMP%]   .message-header[_ngcontent-%COMP%]   .timestamp[_ngcontent-%COMP%]{color:#ffffffb3}.message-list[_ngcontent-%COMP%]   .message-item[_ngcontent-%COMP%]   .message-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:.25rem;font-size:.8rem}.message-list[_ngcontent-%COMP%]   .message-item[_ngcontent-%COMP%]   .message-header[_ngcontent-%COMP%]   .sender[_ngcontent-%COMP%]{font-weight:700}.message-list[_ngcontent-%COMP%]   .message-item[_ngcontent-%COMP%]   .message-header[_ngcontent-%COMP%]   .timestamp[_ngcontent-%COMP%]{color:#95a5a6}.message-list[_ngcontent-%COMP%]   .message-item[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{word-break:break-word}.message-input[_ngcontent-%COMP%]{padding:1rem;background-color:#fff;border-top:1px solid #ecf0f1}.message-input[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex}.message-input[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:.75rem;border:1px solid #ddd;border-radius:4px 0 0 4px;font-size:1rem}.message-input[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3498db}.message-input[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background-color:#3498db;color:#fff;border:none;border-radius:0 4px 4px 0;cursor:pointer}.message-input[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#2980b9}.message-input[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:#95a5a6;cursor:not-allowed}.loading[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:1rem;color:#95a5a6}.btn-primary[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;border:none;border-radius:4px;cursor:pointer}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#2980b9}.btn-primary[_ngcontent-%COMP%]:disabled{background-color:#95a5a6;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background-color:transparent;border:1px solid rgba(255,255,255,.3);color:#fff;border-radius:4px;cursor:pointer}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#ffffff1a}"]})};var Tl=class n{constructor(e){this.router=e}canActivate=(e,t)=>{let r=vt();return new Promise(i=>{Kr(r,s=>{s?i(!0):(this.router.navigate(["/signin"]),i(!1))})})};static \u0275fac=function(t){return new(t||n)(N(lt))};static \u0275prov=b({token:n,factory:n.\u0275fac,providedIn:"root"})};var LE=[{path:"",redirectTo:"signin",pathMatch:"full"},{path:"signin",component:El},{path:"chat",component:Sl,canActivate:[Tl]}];var FE={providers:[qp({eventCoalescing:!0}),Bu(LE),Am(Rm()),mu(gu())]};var Rl=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ie({type:n,selectors:[["app-root"]],decls:2,vars:0,consts:[[1,"mx-auto","flex","h-screen","w-full","flex-col","items-center","justify-center","bg-gray-50","2xl:container"]],template:function(t,r){t&1&&(R(0,"div",0),fe(1,"router-outlet"),L())},dependencies:[qi],encapsulation:2})};au(Rl,FE).catch(n=>console.error(n));
