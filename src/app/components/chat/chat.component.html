<div class="chat-container">
  <div class="sidebar">
    <div class="sidebar-header">
      <h2>Chat Rooms</h2>
      <button class="btn-icon" (click)="toggleCreateRoomForm()">
        <i class="fa fa-plus"></i>
      </button>
    </div>
    
    <!-- Create Room Form -->
    <div class="create-room-form" *ngIf="showCreateRoomForm">
      <form [formGroup]="roomForm" (ngSubmit)="createRoom()">
        <input 
          type="text" 
          formControlName="name" 
          placeholder="Room name"
        >
        <input 
          type="text" 
          formControlName="description" 
          placeholder="Description (optional)"
        >
        <div class="form-actions">
          <button type="submit" class="btn-primary" [disabled]="roomForm.invalid">Create</button>
          <button type="button" class="btn-secondary" (click)="toggleCreateRoomForm()">Cancel</button>
        </div>
      </form>
    </div>
    
    <!-- Room List -->
    <div class="room-list" *ngIf="!loading.rooms">
      <div 
        *ngFor="let room of rooms"
        [class.active]="currentRoom?.id === room.id"
        class="room-item"
        (click)="joinRoom(room.id)"
      >
        <div class="room-name">{{ room.name }}</div>
        <div class="room-description" *ngIf="room.description">{{ room.description }}</div>
        <div class="member-count">{{ room.members.length }} members</div>
      </div>
    </div>
    
    <div class="loading" *ngIf="loading.rooms">Loading rooms...</div>
    
    <div class="user-actions">
      <button class="btn-logout" (click)="onLogout()">Logout</button>
    </div>
  </div>
  
  <div class="chat-area">
    <!-- No Room Selected View -->
    <div class="no-room-selected" *ngIf="!currentRoom">
      <h3>Welcome to Chat</h3>
      <p>Select a chat room from the sidebar to join the conversation.</p>
    </div>
    
    <!-- Chat Room View -->
    <div class="chat-room" *ngIf="currentRoom">
      <div class="chat-header">
        <h3>{{ currentRoom.name }}</h3>
        <div class="room-controls">
          <button class="btn-leave" (click)="leaveRoom()">Leave Room</button>
        </div>
      </div>
      
      <div class="message-container">
        <div class="loading" *ngIf="loading.messages">Loading messages...</div>
        
        <div *ngIf="messages.length === 0 && !loading.messages" class="no-messages">
          <p>No messages yet. Start the conversation!</p>
        </div>
        
        <div class="message-list">
          <div 
            *ngFor="let message of messages"
            class="message-item"
            [class.own-message]="message.sender.id === authService.currentUser?.id"
          >
            <div class="message-header">
              <span class="sender">{{ message.sender.username || message.sender.email }}</span>
              <span class="timestamp">{{ message.timestamp | date:'short' }}</span>
            </div>
            <div class="message-content">{{ message.content }}</div>
          </div>
        </div>
      </div>
      
      <div class="message-input">
        <form [formGroup]="messageForm" (ngSubmit)="sendMessage()">
          <input 
            type="text" 
            formControlName="content" 
            placeholder="Type a message..."
          >
          <button type="submit" [disabled]="messageForm.invalid">Send</button>
        </form>
      </div>
    </div>
  </div>
</div>
